# Roamio æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
4. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
5. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
6. [APIè®¾è®¡](#apiè®¾è®¡)
7. [å‰ç«¯æ¶æ„](#å‰ç«¯æ¶æ„)
8. [æ ¸å¿ƒåŠŸèƒ½å®ç°](#æ ¸å¿ƒåŠŸèƒ½å®ç°)
9. [éƒ¨ç½²æ–¹æ¡ˆ](#éƒ¨ç½²æ–¹æ¡ˆ)
10. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
11. [å®‰å…¨æœºåˆ¶](#å®‰å…¨æœºåˆ¶)
12. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

---

## é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®ç®€ä»‹

Roamio æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„æ—…è¡Œè§„åˆ’ä¸ç¤¾åŒºåˆ†äº«å¹³å°ï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œä¸ºç”¨æˆ·æä¾›å®Œæ•´çš„æ—…è¡Œè§„åˆ’ã€ç¼–è¾‘ã€åˆ†äº«å’Œç¤¾åŒºäº’åŠ¨åŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **å¯è§†åŒ–æ—…è¡Œç¼–è¾‘** - æ¨¡å—åŒ–çš„è¡Œç¨‹ç¼–è¾‘å™¨ï¼Œæ”¯æŒå®æ—¶é¢„è§ˆ
- **ç¤¾åŒºäº’åŠ¨** - è¯„è®ºã€å›å¤ã€ç‚¹èµã€æ‰“å¡ç­‰ç¤¾äº¤åŠŸèƒ½
- **ç”¨æˆ·ç­‰çº§ç³»ç»Ÿ** - åŸºäºå…¬å¼€æ—…è¡Œå’Œè¯„è®ºæ•°çš„ç­‰çº§è¿›é˜¶
- **æ™ºèƒ½åª’ä½“å¤„ç†** - è‡ªåŠ¨å‹ç¼©å›¾ç‰‡å’Œè§†é¢‘
- **æƒé™æ§åˆ¶** - ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶å’Œæ•°æ®éšç§ä¿æŠ¤
- **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…ç§»åŠ¨ç«¯å’ŒPCç«¯

---

## æŠ€æœ¯æ¶æ„

### æ¶æ„æ¨¡å¼

é‡‡ç”¨ **å‰åç«¯åˆ†ç¦»** æ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             å‰ç«¯ (Vue 3)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   SPA    â”‚  â”‚ Pinia    â”‚  â”‚ Router â”‚â”‚
â”‚  â”‚  Pages   â”‚  â”‚  Store   â”‚  â”‚  Route â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åç«¯ API (Django REST)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ViewSets â”‚  â”‚Models   â”‚  â”‚Serial â”‚â”‚
â”‚  â”‚  CRUD    â”‚  â”‚Database â”‚  â”‚   izerâ”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ ORM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ•°æ®åº“ (SQLite/PostgreSQL)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Users   â”‚  â”‚  Trips   â”‚  â”‚Commentsâ”‚â”‚
â”‚  â”‚ Profiles â”‚  â”‚  Stats   â”‚  â”‚  Media â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµå‘

```
User Action (å‰ç«¯)
    â†“
API Request (HTTP/HTTPS)
    â†“
ViewSet (æƒé™éªŒè¯ã€æ•°æ®å¤„ç†)
    â†“
Serializer (æ•°æ®éªŒè¯ã€åºåˆ—åŒ–)
    â†“
Model (ORMæ“ä½œ)
    â†“
Database (æŒä¹…åŒ–å­˜å‚¨)
    â†“
Response (JSONæ•°æ®)
    â†“
Frontend Display (æ¸²æŸ“å±•ç¤º)
```

---

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Django** | 5.0.6 | Webæ¡†æ¶ |
| **Django REST Framework** | 3.14.0 | REST API |
| **DRF SimpleJWT** | 5.3.0 | JWTè®¤è¯ |
| **django-cors-headers** | 4.3.0 | è·¨åŸŸè¯·æ±‚ |
| **django-filter** | 23.5 | æ•°æ®è¿‡æ»¤ |
| **Pillow** | 10.0.0 | å›¾ç‰‡å¤„ç† |
| **MoviePy** | 1.0.3 | è§†é¢‘å¤„ç† |
| **uWSGI** | 2.0.23 | WSGIæœåŠ¡å™¨ |

### å‰ç«¯æŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Vue.js** | 3.x | å‰ç«¯æ¡†æ¶ |
| **Vue Router** | 4.x | è·¯ç”±ç®¡ç† |
| **Pinia** | 2.x | çŠ¶æ€ç®¡ç† |
| **Axios** | - | HTTPè¯·æ±‚ |
| **Bootstrap 5** | 5.x | UIæ¡†æ¶ |
| **Babel** | - | JSè½¬è¯‘ |

### æ•°æ®åº“

- **å¼€å‘ç¯å¢ƒ**: SQLite 3
- **ç”Ÿäº§ç¯å¢ƒ**: PostgreSQL (æ¨è)

### éƒ¨ç½²å·¥å…·

- **Nginx**: åå‘ä»£ç†ã€é™æ€æ–‡ä»¶æœåŠ¡
- **uWSGI**: Pythonåº”ç”¨æœåŠ¡å™¨
- **Supervisor**: è¿›ç¨‹ç®¡ç†

---

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±‚ (Vue 3)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  View Layer â”‚  â”‚State(Pinia) â”‚  â”‚  Router     â”‚     â”‚
â”‚  â”‚   Page      â”‚  â”‚  Store      â”‚  â”‚  Route      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                 â”‚                 â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          ç»„ä»¶å±‚ (Components)                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚  Editor  â”‚  â”‚ Comments â”‚  â”‚  NavBar  â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          APIå°è£…å±‚ (Axios)                     â”‚  â”‚
â”‚  â”‚  HTTPè¯·æ±‚ â†’ request.js â†’ APIç«¯ç‚¹               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTPS/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 åç«¯å±‚ (Django)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  REST API   â”‚  â”‚ ViewSets    â”‚  â”‚  URL Router â”‚     â”‚
â”‚  â”‚  Framework  â”‚  â”‚  CRUDæ“ä½œ   â”‚  â”‚  è·¯ç”±åˆ†å‘   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                 â”‚                 â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          åºåˆ—åŒ–å™¨å±‚ (Serializers)                â”‚  â”‚
â”‚  â”‚  æ•°æ®éªŒè¯ â†’ åºåˆ—åŒ– â†’ ååºåˆ—åŒ– â†’ æƒé™æ§åˆ¶        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          æ¨¡å‹å±‚ (Models)                        â”‚  â”‚
â”‚  â”‚  ORMæ˜ å°„ â†’ æ•°æ®åº“æ“ä½œ â†’ ä¸šåŠ¡é€»è¾‘                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ ORM Query
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•°æ®å±‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Users     â”‚  â”‚    Trips    â”‚  â”‚  Comments   â”‚     â”‚
â”‚  â”‚  Profiles   â”‚  â”‚   SiteStat  â”‚  â”‚  Replies    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   Media     â”‚  â”‚  Static     â”‚                      â”‚
â”‚  â”‚  Files      â”‚  â”‚  Files      â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åç«¯æ¨¡å—åˆ’åˆ†

#### 1. æ•°æ®æ¨¡å‹å±‚ (models/)

```python
trips/models/
â”œâ”€â”€ user_profile.py      # ç”¨æˆ·æ‰©å±•ä¿¡æ¯
â”‚   â”œâ”€â”€ UserProfile     # ç”¨æˆ·é…ç½®æ–‡ä»¶æ¨¡å‹
â”‚   â”œâ”€â”€ avatar, bio     # å¤´åƒã€ä¸ªäººç®€ä»‹
â”‚   â””â”€â”€ levelè®¡ç®—        # ç”¨æˆ·ç­‰çº§ç³»ç»Ÿ
â”‚
â”œâ”€â”€ trip.py              # æ—…è¡Œè®¡åˆ’æ¨¡å‹
â”‚   â”œâ”€â”€ Trip             # æ ¸å¿ƒæ—…è¡Œæ¨¡å‹
â”‚   â”œâ”€â”€ slugç”Ÿæˆ         # å“ˆå¸Œç¼–ç å”¯ä¸€æ ‡è¯†
â”‚   â”œâ”€â”€ config (JSON)    # æ¨¡å—é…ç½®
â”‚   â””â”€â”€ overview (JSON)  # å†…å®¹æ•°æ®
â”‚
â”œâ”€â”€ comment.py           # è¯„è®ºæ¨¡å‹
â”‚   â”œâ”€â”€ Comment          # è¯„è®ºä¸å›å¤
â”‚   â”œâ”€â”€ parentå¤–é”®       # åµŒå¥—å›å¤æ”¯æŒ
â”‚   â””â”€â”€ mediaæ”¯æŒ        # å›¾ç‰‡/è§†é¢‘è¯„è®º
â”‚
â””â”€â”€ site_stat.py         # ç½‘ç«™ç»Ÿè®¡
    â”œâ”€â”€ SiteStat         # é¡µé¢ç»Ÿè®¡æ•°æ®
    â””â”€â”€ views/likes      # æµè§ˆé‡ã€ç‚¹èµæ•°
```

#### 2. APIå±‚ (api/)

```python
trips/api/viewsets/
â”œâ”€â”€ user_viewset.py       # ç”¨æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ GET /users/{id}/  # è·å–ç”¨æˆ·ä¿¡æ¯
â”‚   â”œâ”€â”€ PATCH /users/{id}/# æ›´æ–°ç”¨æˆ·ä¿¡æ¯
â”‚   â””â”€â”€ DELETE /users/{id}/# åˆ é™¤è´¦å·ï¼ˆé«˜çº§è®¾ç½®ï¼‰
â”‚
â”œâ”€â”€ trip_plan_viewset.py  # æ—…è¡Œç®¡ç†
â”‚   â”œâ”€â”€ GET /trip-plans/ # è·å–åˆ—è¡¨
â”‚   â”œâ”€â”€ POST /trip-plans/# åˆ›å»ºæ—…è¡Œ
â”‚   â”œâ”€â”€ PATCH /trip-plans/{slug}/# æ›´æ–°æ—…è¡Œ
â”‚   â”œâ”€â”€ DELETE /trip-plans/{slug}/# åˆ é™¤æ—…è¡Œ
â”‚   â”œâ”€â”€ POST /trip-plans/{slug}/clone/# å¤åˆ¶æ—…è¡Œ
â”‚   â”œâ”€â”€ POST /trip-plans/{slug}/add_to_tree/# æ·»åŠ åˆ°æ—…è¡Œæ ‘
â”‚   â””â”€â”€ retrieveè®¿é—®æ§åˆ¶ # å…¬å¼€/ç§æœ‰è®¿é—®æ§åˆ¶
â”‚
â””â”€â”€ comment_viewset.py    # è¯„è®ºç®¡ç†
    â”œâ”€â”€ GET /comments/?trip={slug}# è·å–è¯„è®ºåˆ—è¡¨
    â”œâ”€â”€ POST /comments/  # åˆ›å»ºè¯„è®ºï¼ˆæƒé™ï¼šä½œè€…å¯åˆ›å»ºé¡¶å±‚ï¼‰
    â”œâ”€â”€ GET /comments/{id}/replies/# è·å–å›å¤åˆ—è¡¨
    â””â”€â”€ DELETE /comments/{id}/# åˆ é™¤è¯„è®ºï¼ˆæƒé™æ§åˆ¶ï¼‰
```

#### 3. åºåˆ—åŒ–å™¨å±‚ (serializers/)

```python
trips/serializers/
â”œâ”€â”€ user_serializer.py
â”‚   â”œâ”€â”€ UserSerializer       # ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
â”‚   â”œâ”€â”€ UserProfileSerializer# ç”¨æˆ·é…ç½®
â”‚   â””â”€â”€ RegisterSerializer   # ç”¨æˆ·æ³¨å†Œ
â”‚
â”œâ”€â”€ trip_detail_serializer.py
â”‚   â”œâ”€â”€ TripCreateSerializer # åˆ›å»ºæ—…è¡Œ
â”‚   â”œâ”€â”€ TripDetailSerializer # æ—…è¡Œè¯¦æƒ…
â”‚   â”œâ”€â”€ TripListSerializer   # æ—…è¡Œåˆ—è¡¨
â”‚   â””â”€â”€ TripUpdateSerializer # æ›´æ–°æ—…è¡Œ
â”‚
â””â”€â”€ comment_serializer.py
    â”œâ”€â”€ CommentSerializer     # è¯„è®ºåºåˆ—åŒ–
    â”œâ”€â”€ CommentCreateSerializer# åˆ›å»ºè¯„è®º
    â””â”€â”€ æƒé™åˆ¤æ–­              # can_deleteç­‰
```

#### 4. è§†å›¾å±‚ (views/)

```python
trips/views/
â”œâ”€â”€ base_views.py      # åŸºç¡€è§†å›¾ï¼ˆé¦–é¡µï¼‰
â”œâ”€â”€ auth_views.py      # è®¤è¯è§†å›¾
â”œâ”€â”€ user_views.py      # ç”¨æˆ·è§†å›¾
â”œâ”€â”€ trip_views.py      # æ—…è¡Œè§†å›¾
â””â”€â”€ comment_views.py   # è¯„è®ºè§†å›¾
```

#### 5. å·¥å…·ä¸ç®¡ç† (management/)

```python
trips/management/commands/
â”œâ”€â”€ delete_trips_without_slug.py    # åˆ é™¤æ— slugæ—…è¡Œï¼ˆä¿æŠ¤æ—…è¡Œæ ‘ï¼‰
â””â”€â”€ fix_missing_slugs.py            # ä¿®å¤slug
```

### å‰ç«¯æ¨¡å—åˆ’åˆ†

#### 1. é¡µé¢ç»„ä»¶ (views/)

```
web/src/views/
â”œâ”€â”€ HomeView.vue              # é¦–é¡µ - æ—…è¡Œæ ‘å±•ç¤º
â”œâ”€â”€ TripDetailView.vue         # æ—…è¡Œè¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ å†…å®¹å±•ç¤º              # highlights, itinerary, budget
â”‚   â”œâ”€â”€ è¯„è®ºç³»ç»Ÿ              # CommentSection
â”‚   â”œâ”€â”€ èƒŒæ™¯éŸ³ä¹              # audio player
â”‚   â””â”€â”€ ç‚¹èµ/æ‰“å¡             # like/checkin
â”‚
â”œâ”€â”€ TripEditorView.vue         # æ—…è¡Œç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ åŸºæœ¬ä¿¡æ¯ç¼–è¾‘          # BasicInfoEditor
â”‚   â”œâ”€â”€ æ¨¡å—é€‰æ‹©              # ModuleSelector
â”‚   â”œâ”€â”€ å†…å®¹ç¼–è¾‘              # ContentEditor
â”‚   â””â”€â”€ è®¾ç½®é¢æ¿              # EditorSidebar
â”‚
â”œâ”€â”€ MyTripsView.vue           # æˆ‘çš„æ—…è¡Œ
â”‚   â”œâ”€â”€ æ—…è¡Œåˆ—è¡¨å±•ç¤º          # trip cards
â”‚   â”œâ”€â”€ ç¼–è¾‘/é¢„è§ˆ/åˆ é™¤        # actions
â”‚   â””â”€â”€ æ—…è¡Œæ ‘ç®¡ç†            # add/remove from tree
â”‚
â””â”€â”€ UserCenterView.vue        # ä¸ªäººä¸­å¿ƒ
    â”œâ”€â”€ ç”¨æˆ·èµ„æ–™              # UserProfileCard
    â”œâ”€â”€ ç»Ÿè®¡æ•°æ®              # UserStats
    â””â”€â”€ é«˜çº§è®¾ç½®              # AdvancedSettingsModal
```

#### 2. ç»„ä»¶å±‚ (components/)

```
web/src/components/
â”œâ”€â”€ NavBar.vue               # å¯¼èˆªæ ï¼ˆå…¨å±€ï¼‰
â”‚   â”œâ”€â”€ ç™»å½•/ç™»å‡º            # auth status
â”‚   â”œâ”€â”€ å¯¼èˆªé“¾æ¥             # menu items
â”‚   â””â”€â”€ ç”¨æˆ·å¤´åƒ             # user avatar
â”‚
â”œâ”€â”€ comments/                # è¯„è®ºç»„ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ CommentSection.vue  # è¯„è®ºå®¹å™¨
â”‚   â”œâ”€â”€ CommentItem.vue     # å•ä¸ªè¯„è®ºå¡ç‰‡
â”‚   â”œâ”€â”€ CommentForm.vue     # è¯„è®ºè¡¨å•
â”‚   â””â”€â”€ ReplySection.vue    # å›å¤åŒºåŸŸ
â”‚
â””â”€â”€ editor/                  # ç¼–è¾‘å™¨ç»„ä»¶
    â”œâ”€â”€ BasicInfoEditor.vue  # åŸºæœ¬ä¿¡æ¯ç¼–è¾‘
    â”œâ”€â”€ ModuleSelector.vue  # æ¨¡å—é€‰æ‹©å™¨
    â”œâ”€â”€ ContentEditor.vue   # å†…å®¹ç¼–è¾‘å™¨
    â””â”€â”€ EditorSidebar.vue   # ç¼–è¾‘ä¾§è¾¹æ 
```

#### 3. APIå°è£…å±‚ (api/)

```javascript
web/src/api/
â”œâ”€â”€ request.js              # HTTPè¯·æ±‚åŸºç¡€å°è£…
â”‚   â”œâ”€â”€ axioså®ä¾‹é…ç½®       # baseURL, timeout
â”‚   â”œâ”€â”€ è¯·æ±‚æ‹¦æˆªå™¨          # æ·»åŠ token
â”‚   â”œâ”€â”€ å“åº”æ‹¦æˆªå™¨          # é”™è¯¯å¤„ç†
â”‚   â””â”€â”€ JWTåˆ·æ–°æœºåˆ¶        # token refresh
â”‚
â”œâ”€â”€ trip.js                  # æ—…è¡ŒAPI
â”‚   â”œâ”€â”€ getTripDetail       # è·å–è¯¦æƒ…
â”‚   â”œâ”€â”€ createTripPlan      # åˆ›å»ºæ—…è¡Œ
â”‚   â”œâ”€â”€ updateTripPlan      # æ›´æ–°æ—…è¡Œ
â”‚   â””â”€â”€ deleteTripPlan      # åˆ é™¤æ—…è¡Œ
â”‚
â”œâ”€â”€ comment.js               # è¯„è®ºAPI
â”‚   â”œâ”€â”€ getComments         # è·å–è¯„è®ºåˆ—è¡¨
â”‚   â”œâ”€â”€ createComment       # åˆ›å»ºè¯„è®º
â”‚   â”œâ”€â”€ deleteComment       # åˆ é™¤è¯„è®º
â”‚   â””â”€â”€ getReplies          # è·å–å›å¤
â”‚
â””â”€â”€ user.js                  # ç”¨æˆ·API
    â”œâ”€â”€ getMe                # è·å–å½“å‰ç”¨æˆ·
    â”œâ”€â”€ updateUser           # æ›´æ–°ç”¨æˆ·
    â””â”€â”€ deleteUser           # åˆ é™¤è´¦å·
```

#### 4. çŠ¶æ€ç®¡ç† (stores/)

```javascript
web/src/stores/
â””â”€â”€ user.js                  # ç”¨æˆ·çŠ¶æ€ç®¡ç†
    â”œâ”€â”€ state                # ç”¨æˆ·ä¿¡æ¯ã€è®¤è¯çŠ¶æ€
    â”œâ”€â”€ getters              # è®¡ç®—å±æ€§
    â””â”€â”€ actions              # ç™»å½•ã€ç™»å‡ºã€è·å–ç”¨æˆ·ä¿¡æ¯
```

#### 5. è·¯ç”±é…ç½® (router/)

```javascript
web/src/router/index.js
routes: [
  { path: '/', component: HomeView },
  { path: '/trip/:slug', component: TripDetailView },
  { path: '/editor/:slug?', component: TripEditorView },
  { path: '/my-trips', component: MyTripsView, meta: { requiresAuth: true } },
  { path: '/user-center', component: UserCenterView, meta: { requiresAuth: true } }
]
```

---

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®æ¨¡å‹

#### 1. User (Djangoå†…ç½®)
```python
# æ‰©å±•ç”¨æˆ·ä¿¡æ¯
class UserProfile(models.Model):
    user = OneToOneField(User)
    avatar = ImageField()
    bio = TextField()
    tags = CharField()
    level = CharField()  # novice/explorer/wanderer/adventurer/master
    
    # ç­‰çº§è®¡ç®—åŸºäºå…¬å¼€æ—…è¡Œæ•°+è¯„è®ºæ•°
```

#### 2. Trip (æ—…è¡Œè®¡åˆ’)
```python
class Trip(models.Model):
    slug = SlugField(unique=True)  # å“ˆå¸Œç¼–ç ï¼Œä¿è¯å”¯ä¸€æ€§å’Œéšç§
    title = CharField()
    description = TextField()
    icon = CharField()
    author = ForeignKey(User)
    
    # æ—¥æœŸ
    start_date = DateField()
    end_date = DateField()
    
    # çŠ¶æ€ä¸å¯è§æ€§
    status = CharField()        # draft/published
    visibility = CharField()    # private/public
    
    # å†…å®¹å­˜å‚¨ï¼ˆJSONå­—æ®µï¼‰
    config = JSONField()        # æ¨¡å—é…ç½®
    overview = JSONField()      # å†…å®¹è¯¦æƒ…
    
    # ä¸»é¢˜
    theme_color = CharField()   # ä¸»é¢˜è‰²
    background_music = CharField()  # èƒŒæ™¯éŸ³ä¹
    
    # æ—¶é—´æˆ³
    created_at = DateTimeField()
    updated_at = DateTimeField()
```

#### 3. Comment (è¯„è®º)
```python
class Comment(models.Model):
    user = ForeignKey(User, related_name='comments')
    parent = ForeignKey('self', null=True)  # æ”¯æŒåµŒå¥—å›å¤
    
    content = TextField()
    image = ImageField()
    video = FileField()
    
    page = CharField()          # æ‰€å±é¡µé¢ï¼ˆæ—…è¡Œslugï¼‰
    is_pinned = BooleanField()   # æ˜¯å¦ç½®é¡¶
    
    timestamp = DateTimeField()
    
    class Meta:
        ordering = ['-is_pinned', '-timestamp']
```

#### 4. SiteStat (ç½‘ç«™ç»Ÿè®¡)
```python
class SiteStat(models.Model):
    page = CharField()      # å¯¹åº”æ—…è¡Œslug
    views = IntegerField()   # æµè§ˆé‡
    likes = IntegerField()   # ç‚¹èµæ•°
    checked_in = BooleanField()
```

### å…³ç³»å›¾

```
User
  â”œâ”€ UserProfile (ä¸€å¯¹ä¸€)
  â”œâ”€ Trip (ä¸€å¯¹å¤š, author)
  â”œâ”€ Comment (ä¸€å¯¹å¤š, user)
  â””â”€ SiteStat (æ— ç›´æ¥å…³è”)

Trip
  â”œâ”€ User (author)
  â”œâ”€ SiteStat (é€šè¿‡slugå…³è”)
  â””â”€ Comment (é€šè¿‡pageå­—æ®µå…³è”)

Comment
  â”œâ”€ User (è¯„è®ºè€…)
  â”œâ”€ Trip (é€šè¿‡pageå­—æ®µ)
  â””â”€ Comment (parent, åµŒå¥—å›å¤)
```

---

## APIè®¾è®¡

### RESTful API è§„èŒƒ

#### åŸºç¡€é…ç½®

```python
# settings.py
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    ],
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticatedOrReadOnly',
    ],
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 20
}
```

#### ä¸»è¦APIç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | æƒé™ |
|------|------|------|------|
| `/api/v1/auth/register/` | POST | ç”¨æˆ·æ³¨å†Œ | å…¬å¼€ |
| `/api/v1/auth/login/` | POST | ç”¨æˆ·ç™»å½• | å…¬å¼€ |
| `/api/v1/auth/me/` | GET | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ | è®¤è¯ç”¨æˆ· |
| `/api/v1/users/{id}/` | GET | è·å–ç”¨æˆ·ä¿¡æ¯ | åªè¯» |
| `/api/v1/users/{id}/` | PATCH | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | æœ¬äºº |
| `/api/v1/users/{id}/` | DELETE | åˆ é™¤è´¦å· | æœ¬äºº |
| `/api/v1/trip-plans/` | GET | è·å–æ—…è¡Œåˆ—è¡¨ | åªè¯» |
| `/api/v1/trip-plans/{slug}/` | GET | è·å–æ—…è¡Œè¯¦æƒ… | å…¬å¼€æˆ–æœ¬äºº |
| `/api/v1/trip-plans/` | POST | åˆ›å»ºæ—…è¡Œ | è®¤è¯ç”¨æˆ· |
| `/api/v1/trip-plans/{slug}/` | PATCH | æ›´æ–°æ—…è¡Œ | ä½œè€… |
| `/api/v1/trip-plans/{slug}/` | DELETE | åˆ é™¤æ—…è¡Œ | ä½œè€… |
| `/api/v1/comments/` | GET | è·å–è¯„è®ºåˆ—è¡¨ | åªè¯» |
| `/api/v1/comments/{id}/replies/` | GET | è·å–å›å¤ | åªè¯» |
| `/api/v1/comments/` | POST | åˆ›å»ºè¯„è®º | è®¤è¯ç”¨æˆ· |
| `/api/v1/comments/{id}/` | DELETE | åˆ é™¤è¯„è®º | æœ¬äººæˆ–ç®¡ç†å‘˜ |

### è®¿é—®æ§åˆ¶é€»è¾‘

#### æ—…è¡Œè®¿é—®æ§åˆ¶
```python
def retrieve(self, request, *args, **kwargs):
    """åªæœ‰å…¬å¼€çš„æ—…è¡Œæˆ–ä½œè€…æœ¬äººå¯ä»¥è®¿é—®"""
    instance = self.get_object()
    if instance.visibility != 'public' and instance.author != request.user:
        raise NotFound("è¯¥æ—…è¡Œè®¡åˆ’ä¸å¯è®¿é—®")
    return Response(serializer.data)
```

#### è¯„è®ºåˆ›å»ºæƒé™
```python
def perform_create(self, serializer):
    """åˆ›å»ºé¡¶å±‚è¯„è®ºéœ€è¦æ˜¯æ—…è¡Œä½œè€…"""
    parent = serializer.validated_data.get('parent')
    if not parent:  # é¡¶å±‚è¯„è®º
        # æ£€æŸ¥æ˜¯å¦ä¸ºæ—…è¡Œä½œè€…
        trip = Trip.objects.filter(slug=serializer.validated_data['page']).first()
        if trip.author != self.request.user:
            raise PermissionDenied("åªæœ‰ä½œè€…å¯ä»¥åˆ›å»ºé¡¶å±‚è¯„è®º")
    serializer.save(user=self.request.user)
```

#### ç”¨æˆ·ç»Ÿè®¡
```python
def get_stats(self, obj):
    return {
        'trips_count': obj.trips.count(),                    # æ€»æ—…è¡Œæ•°
        'public_trips_count': obj.trips.filter(visibility='public').count(),  # å…¬å¼€æ—…è¡Œæ•°
        'comments_count': obj.comments.count(),             # è¯„è®ºæ•°
    }
```

---

## å‰ç«¯æ¶æ„

### ç»„ä»¶å±‚æ¬¡

```
App.vue (æ ¹ç»„ä»¶)
  â”œâ”€ NavBar.vue (å¯¼èˆªæ )
  â”œâ”€ HomeView.vue (é¦–é¡µ)
  â”œâ”€ TripDetailView.vue (æ—…è¡Œè¯¦æƒ…)
  â”‚   â”œâ”€ ContentEditor.vue (å†…å®¹æ˜¾ç¤º)
  â”‚   â””â”€ CommentSection.vue (è¯„è®ºåŒºåŸŸ)
  â”‚       â”œâ”€ CommentItem.vue (å•ä¸ªè¯„è®º)
  â”‚       â””â”€ ReplySection.vue (å›å¤åŒºåŸŸ)
  â”œâ”€ TripEditorView.vue (æ—…è¡Œç¼–è¾‘å™¨)
  â”‚   â”œâ”€ BasicInfoEditor.vue
  â”‚   â”œâ”€ ModuleSelector.vue
  â”‚   â”œâ”€ ContentEditor.vue
  â”‚   â””â”€ EditorSidebar.vue
  â”œâ”€ MyTripsView.vue (æˆ‘çš„æ—…è¡Œ)
  â””â”€ UserCenterView.vue (ä¸ªäººä¸­å¿ƒ)
      â”œâ”€ UserProfileCard.vue
      â”œâ”€ UserStats.vue
      â””â”€ AdvancedSettingsModal.vue
```

### çŠ¶æ€ç®¡ç†

#### Pinia Store

```javascript
// stores/user.js
export const useUserStore = defineStore('user', {
  state: () => ({
    userInfo: null,
    isAuthenticated: false,
  }),
  
  actions: {
    async login(credentials) {
      // ç™»å½•é€»è¾‘
      const tokens = await login(credentials);
      // å­˜å‚¨token
      // æ›´æ–°userInfo
    },
    
    async fetchUserInfo() {
      // è·å–ç”¨æˆ·ä¿¡æ¯
      this.userInfo = await getMe();
    }
  }
})
```

### è·¯ç”±é…ç½®

```javascript
const routes = [
  { path: '/', component: HomeView },
  { path: '/trip/:slug', component: TripDetailView },
  { path: '/editor/:slug?', component: TripEditorView },
  { path: '/my-trips', component: MyTripsView, meta: { requiresAuth: true } },
  { path: '/user-center', component: UserCenterView, meta: { requiresAuth: true } },
]
```

---

## æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. æ—…è¡Œç¼–è¾‘å™¨

#### æ¨¡å—åŒ–è®¾è®¡
- **BasicInfoEditor**: åŸºæœ¬ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€æè¿°ã€æ—¥æœŸï¼‰
- **ModuleSelector**: æ¨¡å—é€‰æ‹©ï¼ˆäº®ç‚¹ã€è¡Œç¨‹ã€é¢„ç®—ã€æç¤ºï¼‰
- **ContentEditor**: å†…å®¹ç¼–è¾‘ï¼ˆæ ¹æ®é€‰æ‹©çš„æ¨¡å—åŠ¨æ€æ¸²æŸ“ï¼‰
- **EditorSidebar**: è®¾ç½®é¢æ¿ï¼ˆçŠ¶æ€ã€å¯è§æ€§ã€ä¸»é¢˜è‰²ã€èƒŒæ™¯éŸ³ä¹ï¼‰

#### æ•°æ®æŒä¹…åŒ–
```javascript
// ä¿å­˜è‰ç¨¿
const handleSave = async () => {
  const data = {
    title: tripData.title,
    description: tripData.description,
    config: tripData.config,        // æ¨¡å—é…ç½®
    overview: tripData.overview,    // è¯¦ç»†å†…å®¹
    status: 'draft'
  };
  await createTripPlan(data);
};
```

### 2. è¯„è®ºç³»ç»Ÿ

#### åµŒå¥—å›å¤
```python
class Comment(models.Model):
    parent = models.ForeignKey('self', related_name='replies')
    # é¡¶å±‚è¯„è®ºparentä¸ºNone
    # å›å¤æ—¶parentæŒ‡å‘è¢«å›å¤çš„è¯„è®º
```

#### æƒé™æ§åˆ¶
- **åˆ›å»ºé¡¶å±‚è¯„è®º**: åªæœ‰æ—…è¡Œä½œè€…å¯ä»¥
- **å›å¤**: æ‰€æœ‰ç™»å½•ç”¨æˆ·å¯ä»¥
- **åˆ é™¤è¯„è®º**: è¯„è®ºä½œè€…ã€æ—…è¡Œä½œè€…æˆ–ç®¡ç†å‘˜å¯ä»¥
- **åˆ é™¤å›å¤**: å›å¤ä½œè€…ã€æ—…è¡Œä½œè€…æˆ–ç®¡ç†å‘˜å¯ä»¥

### 3. ç”¨æˆ·ç­‰çº§ç³»ç»Ÿ

#### ç­‰çº§è®¡ç®—é€»è¾‘
```python
def calculate_level(self):
    trips_count = self.user.trips.filter(visibility='public').count()
    comments_count = self.user.comments.count()
    
    if trips_count >= 10 and comments_count >= 100:
        self.level = 'master'       # æ—…è¡Œå¤§å¸ˆ
    elif trips_count >= 6 and comments_count >= 50:
        self.level = 'adventurer'   # å†’é™©å®¶
    elif trips_count >= 3 and comments_count >= 20:
        self.level = 'wanderer'     # æ¼«æ¸¸è€…
    elif trips_count >= 1 and comments_count >= 5:
        self.level = 'explorer'     # æ¢ç´¢è€…
    else:
        self.level = 'novice'       # æ–°æ‰‹
```

**ç­‰çº§è¦æ±‚**:
- æ–°æ‰‹: æ— è¦æ±‚
- æ¢ç´¢è€…: â‰¥1ä¸ªå…¬å¼€æ—…è¡Œ + â‰¥5æ¡è¯„è®º
- æ¼«æ¸¸è€…: â‰¥3ä¸ªå…¬å¼€æ—…è¡Œ + â‰¥20æ¡è¯„è®º
- å†’é™©å®¶: â‰¥6ä¸ªå…¬å¼€æ—…è¡Œ + â‰¥50æ¡è¯„è®º
- æ—…è¡Œå¤§å¸ˆ: â‰¥10ä¸ªå…¬å¼€æ—…è¡Œ + â‰¥100æ¡è¯„è®º

### 4. Slugç”Ÿæˆ

#### å“ˆå¸Œç¼–ç 
```python
def save(self, *args, **kwargs):
    if not self.slug:
        unique_id = str(uuid.uuid4())
        timestamp = str(timezone.now().timestamp())
        hash_string = f"{self.title}_{unique_id}_{timestamp}"
        
        # MD5å“ˆå¸Œï¼Œæˆªå–12ä½
        hash_obj = hashlib.md5(hash_string.encode())
        hash_hex = hash_obj.hexdigest()[:12]
        
        self.slug = hash_hex
        # ç¡®ä¿å”¯ä¸€æ€§
```

**ä¼˜åŠ¿**:
- ä¿æŠ¤éšç§ï¼šæ— æ³•ä»slugæ¨æµ‹å†…å®¹
- å”¯ä¸€æ€§ï¼šç»“åˆUUIDå’Œæ—¶é—´æˆ³
- ç®€çŸ­ï¼š12ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²

### 5. åª’ä½“å¤„ç†

#### å›¾ç‰‡å‹ç¼©
```python
# models/user_profile.py
def save(self, *args, **kwargs):
    if self.avatar:
        img = Image.open(img_path)
        # è£å‰ªä¸ºæ­£æ–¹å½¢
        min_side = min(img.width, img.height)
        img = img.crop((left, top, right, bottom))
        
        # è°ƒæ•´ä¸º300x300
        img = img.resize((300, 300), Image.Resampling.LANCZOS)
        
        # ä¿å­˜ä¸ºJPEG
        img.convert('RGB').save(img_path, format='JPEG', quality=90)
```

#### è§†é¢‘å‹ç¼©
```python
# ä½¿ç”¨MoviePyå‹ç¼©è§†é¢‘
from moviepy.editor import VideoFileClip

video = VideoFileClip(video_path)
video.write_videofile(output_path, bitrate="1000k")
```

---

## éƒ¨ç½²æ–¹æ¡ˆ

### ç”Ÿäº§ç¯å¢ƒé…ç½®

#### uWSGIé…ç½®
```ini
[uwsgi]
http = :8000
module = roamio.wsgi:application
master = true
processes = 4
vacuum = true
daemonize = /var/log/uwsgi/uwsgi.log
pidfile = /var/run/uwsgi.pid
```

#### Nginxé…ç½®
```nginx
server {
    listen 80;
    server_name app7508.acapp.acwing.com.cn;
    
    # é™æ€æ–‡ä»¶
    location /static/ {
        alias /var/www/roamio/staticfiles/;
    }
    
    # Vueæ„å»ºæ–‡ä»¶
    location /vue/ {
        alias /var/www/roamio/static/vue/;
    }
    
    # APIä»£ç†
    location /api/ {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    
    # SPAè·¯ç”±
    location / {
        root /var/www/roamio/static/vue;
        try_files $uri $uri/ /index.html;
    }
}
```

### éƒ¨ç½²æ­¥éª¤

```bash
# 1. å…‹éš†ä»£ç 
git clone https://github.com/ppshuX/roamio.git
cd roamio

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. æ•°æ®åº“è¿ç§»
python manage.py migrate

# 4. åˆ›å»ºè¶…çº§ç”¨æˆ·
python manage.py createsuperuser

# 5. æ”¶é›†é™æ€æ–‡ä»¶
python manage.py collectstatic --noinput

# 6. æ„å»ºå‰ç«¯
cd web
npm install
npm run build
cd ..

# 7. å¯åŠ¨uWSGI
uwsgi --ini scripts/uwsgi.ini --daemonize uwsgi.log

# 8. é‡å¯Nginx
sudo systemctl restart nginx
```

---

## å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

#### åç«¯å¯åŠ¨
```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æ•°æ®åº“è¿ç§»
python manage.py migrate

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
python manage.py runserver
```

#### å‰ç«¯å¯åŠ¨
```bash
cd web

# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run serve

# ç”Ÿäº§æ„å»º
npm run build
```

### ä»£ç è§„èŒƒ

#### Python
- éµå¾ª PEP 8 ä»£ç é£æ ¼
- ä½¿ç”¨ç±»å‹æç¤ºï¼ˆType Hintsï¼‰
- å‡½æ•°å’Œç±»æ·»åŠ æ–‡æ¡£å­—ç¬¦ä¸²

#### JavaScript/Vue
- ä½¿ç”¨ ES6+ è¯­æ³•
- ç»„ä»¶é‡‡ç”¨ Composition API
- å‘½åä½¿ç”¨ camelCase
- æ–‡ä»¶åä½¿ç”¨ PascalCase

### è°ƒè¯•æŠ€å·§

#### Django Debug Toolbar
```python
# settings.py
INSTALLED_APPS = [
    'debug_toolbar',
]

MIDDLEWARE = [
    'debug_toolbar.middleware.DebugToolbarMiddleware',
]
```

#### Vue DevTools
- å®‰è£…æµè§ˆå™¨æ‰©å±•: Vue DevTools
- æŸ¥çœ‹ç»„ä»¶çŠ¶æ€ã€Propsã€Events
- è¿½è¸ªçŠ¶æ€å˜åŒ–

---

## å®‰å…¨æœºåˆ¶

### 1. è®¤è¯ä¸æˆæƒ

#### JWTè®¤è¯
```python
# settings.py
SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=60),
    'REFRESH_TOKEN_LIFETIME': timedelta(days=1),
    'ROTATE_REFRESH_TOKENS': True,
}
```

#### æƒé™æ§åˆ¶
```python
class TripPlanViewSet(viewsets.ModelViewSet):
    def get_permissions(self):
        if self.action in ['create', 'update', 'destroy']:
            return [IsAuthenticated()]
        return [IsAuthenticatedOrReadOnly()]
```

### 2. æ•°æ®ä¿æŠ¤

#### æ•æ„Ÿä¿¡æ¯è¿‡æ»¤
```python
class TripDetailSerializer(serializers.ModelSerializer):
    # ä¸åœ¨å…¬å¼€APIä¸­æš´éœ²é‚®ç®±ç­‰æ•æ„Ÿä¿¡æ¯
    author = UserSerializer(read_only=True)
```

#### CSRFä¿æŠ¤
```javascript
// request.js
axios.defaults.xsrfHeaderName = "X-CSRFToken";
```

### 3. æ–‡ä»¶ä¸Šä¼ å®‰å…¨

#### æ–‡ä»¶ç±»å‹éªŒè¯
```python
# models.py
def validate_image(uploaded_file):
    valid_extensions = ['.jpg', '.jpeg', '.png', '.gif']
    valid_mime_types = ['image/jpeg', 'image/png', 'image/gif']
    
    if not any(uploaded_file.name.lower().endswith(ext) for ext in valid_extensions):
        raise ValidationError("ä¸æ”¯æŒçš„å›¾ç‰‡æ ¼å¼")
```

#### æ–‡ä»¶å¤§å°é™åˆ¶
```python
# é™åˆ¶ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸º10MB
MAX_UPLOAD_SIZE = 10 * 1024 * 1024
```

---

## æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–

#### ä½¿ç”¨select_relatedå’Œprefetch_related
```python
# å‡å°‘æŸ¥è¯¢æ¬¡æ•°
queryset = Comment.objects.select_related('user', 'user__profile').prefetch_related('replies')
```

#### æ·»åŠ ç´¢å¼•
```python
class Trip(models.Model):
    class Meta:
        indexes = [
            models.Index(fields=['author', 'status']),
            models.Index(fields=['visibility']),
        ]
```

### 2. å‰ç«¯ä¼˜åŒ–

#### æ‡’åŠ è½½
```javascript
// è·¯ç”±æ‡’åŠ è½½
const TripDetailView = () => import('@/views/TripDetailView.vue');

// å›¾ç‰‡æ‡’åŠ è½½
<img v-lazy="imageSrc" />
```

#### è™šæ‹Ÿæ»šåŠ¨
```javascript
// å¤„ç†å¤§é‡åˆ—è¡¨æ—¶ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
import { RecycleScroller } from 'vue-virtual-scroller';
```

### 3. ç¼“å­˜ç­–ç•¥

#### Djangoç¼“å­˜
```python
# settings.py
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.redis.RedisCache',
        'LOCATION': 'redis://127.0.0.1:6379/1',
    }
}
```

#### CDNåŠ é€Ÿ
- é™æ€æ–‡ä»¶æ‰˜ç®¡åˆ°CDN
- å›¾ç‰‡ä½¿ç”¨WebPæ ¼å¼
- å¯ç”¨HTTP/2

---

## é™„å½•

### A. APIå“åº”æ ¼å¼

```json
{
  "id": 123,
  "title": "å¦é—¨ä¸‰å¤©ä¸¤æ™šæ¸¸",
  "author": {
    "id": 1,
    "username": "testuser",
    "profile": {
      "level": "explorer",
      "avatar": "/media/user_avatars/xxx.jpg"
    }
  },
  "stats": {
    "views": 100,
    "likes": 10
  }
}
```

### B. é”™è¯¯å¤„ç†

```json
{
  "detail": "é”™è¯¯æ¶ˆæ¯"
}
// æˆ–
{
  "field_name": ["é”™è¯¯æ¶ˆæ¯1", "é”™è¯¯æ¶ˆæ¯2"]
}
```

### C. åˆ†é¡µæ ¼å¼

```json
{
  "count": 100,
  "next": "http://api.example.com/api/v1/trips/?page=3",
  "previous": "http://api.example.com/api/v1/trips/?page=1",
  "results": [...]
}
```

### D. å¸¸ç”¨å‘½ä»¤

```bash
# åˆ›å»ºè¿ç§»æ–‡ä»¶
python manage.py makemigrations

# æ‰§è¡Œè¿ç§»
python manage.py migrate

# åˆ›å»ºè¶…çº§ç”¨æˆ·
python manage.py createsuperuser

# æ”¶é›†é™æ€æ–‡ä»¶
python manage.py collectstatic

# è¿è¡Œå¼€å‘æœåŠ¡å™¨
python manage.py runserver

# æ•°æ®åº“shell
python manage.py dbshell
```

---

## å‚è€ƒèµ„æ–™

- [Djangoå®˜æ–¹æ–‡æ¡£](https://docs.djangoproject.com/)
- [Django REST Frameworkæ–‡æ¡£](https://www.django-rest-framework.org/)
- [Vue.jså®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Vue Routeræ–‡æ¡£](https://router.vuejs.org/)
- [Piniaæ–‡æ¡£](https://pinia.vuejs.org/)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2024å¹´  
**ç»´æŠ¤è€…**: Roamioå¼€å‘å›¢é˜Ÿ
