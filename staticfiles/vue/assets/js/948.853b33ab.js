"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[948],{1712:function(e,a,t){t.d(a,{A:function(){return k}});var l=t(6768),s=t(5130),n=t(4232);const i={class:"modal-header"},r={class:"modal-title"},o={class:"modal-body"},c={class:"alert alert-warning"},d={class:"mb-0"},u={class:"mb-0 mt-2"},v={class:"modal-footer"};function m(e,a,t,m,b,p){return t.show?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"modal-overlay",onClick:a[4]||(a[4]=(...e)=>m.close&&m.close(...e))},[(0,l.Lk)("div",{class:"modal-content-advanced",onClick:a[3]||(a[3]=(0,s.D$)(()=>{},["stop"]))},[(0,l.Lk)("div",i,[(0,l.Lk)("h5",r,(0,n.v_)(t.title),1),(0,l.Lk)("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=(...e)=>m.close&&m.close(...e))},"âœ•")]),(0,l.Lk)("div",o,[(0,l.Lk)("div",c,[a[5]||(a[5]=(0,l.Lk)("h6",{class:"alert-heading"},"âš ï¸ å±é™©æ“ä½œ",-1)),(0,l.Lk)("p",d,(0,n.v_)(t.warningText),1),(0,l.Lk)("ul",u,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t.warningItems,e=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,n.v_)(e),1))),128))]),a[6]||(a[6]=(0,l.Lk)("p",{class:"mb-0 mt-2"},[(0,l.Lk)("strong",null,"æ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼")],-1))]),(0,l.Lk)("button",{class:"btn btn-danger w-100",onClick:a[1]||(a[1]=a=>e.$emit("confirm"))},(0,n.v_)(t.actionButtonText),1)]),(0,l.Lk)("div",v,[(0,l.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:a[2]||(a[2]=(...e)=>m.close&&m.close(...e))},"å–æ¶ˆ")])])])):(0,l.Q3)("",!0)}var b={name:"AdvancedSettingsModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:"âš™ï¸ é«˜çº§è®¾ç½®"},warningText:{type:String,required:!0},warningItems:{type:Array,required:!0},actionButtonText:{type:String,required:!0}},emits:["close","confirm"],setup(e,{emit:a}){const t=()=>{a("close")};return{close:t}}},p=t(1241);const g=(0,p.A)(b,[["render",m],["__scopeId","data-v-5977f88e"]]);var k=g},9814:function(e,a,t){t.d(a,{A:function(){return C}});var l=t(6768),s=t(4232),n=t(5130);const i={class:"navbar navbar-expand-lg navbar-dark bg-primary shadow-sm sticky-top"},r={class:"container-fluid"},o={class:"collapse navbar-collapse",id:"navbarNav",style:{overflow:"visible"}},c={class:"navbar-nav me-auto"},d={class:"nav-item"},u={key:0,class:"nav-item"},v={class:"d-flex align-items-center"},m={key:0,class:"dropdown dropdown-end"},b={href:"#",class:"d-flex align-items-center text-white text-decoration-none dropdown-toggle user-dropdown-btn",id:"dropdownUser","data-bs-toggle":"dropdown","aria-expanded":"false"},p=["src"],g={class:"dropdown-menu dropdown-menu-end text-small","aria-labelledby":"dropdownUser"};function k(e,a,t,k,f,L){const y=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("nav",i,[(0,l.Lk)("div",r,[(0,l.bF)(y,{to:"/",class:"navbar-brand"},{default:(0,l.k6)(()=>[...a[1]||(a[1]=[(0,l.Lk)("span",{class:"brand-text"},"Roamio",-1)])]),_:1}),a[9]||(a[9]=(0,l.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[(0,l.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,l.Lk)("div",o,[(0,l.Lk)("ul",c,[(0,l.Lk)("li",d,[(0,l.bF)(y,{to:"/",class:"nav-link"},{default:(0,l.k6)(()=>[...a[2]||(a[2]=[(0,l.Lk)("i",{class:"bi bi-house-door me-1"},null,-1),(0,l.eW)(" æ—…è¡Œåˆ—è¡¨ ",-1)])]),_:1})]),k.isLoggedIn?((0,l.uX)(),(0,l.CE)("li",u,[(0,l.bF)(y,{to:"/my-trips/",class:"nav-link"},{default:(0,l.k6)(()=>[...a[3]||(a[3]=[(0,l.Lk)("i",{class:"bi bi-folder me-1"},null,-1),(0,l.eW)(" æˆ‘çš„æ—…è¡Œ ",-1)])]),_:1})])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",v,[k.isLoggedIn?((0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("a",b,[(0,l.Lk)("img",{src:k.avatar,alt:"avatar",width:"32",height:"32",class:"rounded-circle me-2"},null,8,p),(0,l.Lk)("span",null,(0,s.v_)(k.username),1)]),(0,l.Lk)("ul",g,[(0,l.Lk)("li",null,[(0,l.bF)(y,{to:"/user/center",class:"dropdown-item"},{default:(0,l.k6)(()=>[...a[4]||(a[4]=[(0,l.Lk)("i",{class:"bi bi-person me-2"},null,-1),(0,l.eW)("ä¸ªäººä¸­å¿ƒ ",-1)])]),_:1})]),a[6]||(a[6]=(0,l.Lk)("li",null,[(0,l.Lk)("hr",{class:"dropdown-divider"})],-1)),(0,l.Lk)("li",null,[(0,l.Lk)("a",{href:"#",class:"dropdown-item",onClick:a[0]||(a[0]=(0,n.D$)((...e)=>k.handleLogout&&k.handleLogout(...e),["prevent"]))},[...a[5]||(a[5]=[(0,l.Lk)("i",{class:"bi bi-box-arrow-right me-2"},null,-1),(0,l.eW)("é€€å‡ºç™»å½• ",-1)])])])])])):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.bF)(y,{to:"/login",class:"btn btn-outline-light btn-sm me-2"},{default:(0,l.k6)(()=>[...a[7]||(a[7]=[(0,l.eW)(" ç™»å½• ",-1)])]),_:1}),(0,l.bF)(y,{to:"/register",class:"btn btn-light btn-sm"},{default:(0,l.k6)(()=>[...a[8]||(a[8]=[(0,l.eW)(" æ³¨å†Œ ",-1)])]),_:1})],64))])])])])}t(4114);var f=t(8512),L=t(1516),y={name:"NavBar",setup(){const e=(0,f.rd)(),a=(0,L.k)(),t=(0,l.EW)(()=>a.isLoggedIn),s=(0,l.EW)(()=>a.username),n=(0,l.EW)(()=>a.avatar),i=async()=>{if(confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ"))try{await a.logout(),e.push("/login")}catch(t){console.error("é€€å‡ºå¤±è´¥:",t)}};return{isLoggedIn:t,username:s,avatar:n,handleLogout:i}}},h=t(1241);const w=(0,h.A)(y,[["render",k],["__scopeId","data-v-7d3c81b6"]]);var C=w},9948:function(e,a,t){t.r(a),t.d(a,{default:function(){return Ne}});var l=t(6768),s=t(4232),n=t(5130);const i={class:"user-center-wrapper"},r={class:"user-center-container"},o={class:"container py-5"},c={key:0,class:"text-center py-5"},d={key:1,class:"row"},u={class:"col-md-4 mb-4"},v=["disabled"],m={key:0,class:"spinner-border spinner-border-sm me-2"},b=["disabled"],p={class:"col-md-8"},g={class:"card shadow-sm mb-4"},k={class:"card-header bg-white d-flex justify-content-between align-items-center"},f={class:"card-body"},L={key:0,class:"info-display"},y={class:"info-card mb-3"},h={class:"info-item"},w={class:"info-content"},C={class:"info-card"},_={class:"info-item"},E={class:"info-content"},x={class:"mb-3"},A=["disabled"],X={class:"mb-3"},I=["disabled"],D={class:"d-flex gap-2"},F=["disabled"],U={key:0,class:"spinner-border spinner-border-sm me-2"},S=["disabled"],B={class:"card shadow-sm mb-4"},P={class:"card-header bg-white d-flex justify-content-between align-items-center"},W={class:"card-body"},K={class:"mb-3"},R={key:0,class:"info-display"},q={class:"info-card mb-3"},T={class:"info-content"},$={class:"info-card mb-3"},Q={key:0},j={key:1,class:"info-content text-muted"},J={class:"info-card"},V={class:"info-content"},N={class:"mb-3"},M={class:"text-muted"},z={class:"mb-3"},O={class:"mb-3"},G={class:"d-flex gap-2"},H=["disabled"],Y={key:0,class:"spinner-border spinner-border-sm me-2"},Z=["disabled"];function ee(e,a,t,ee,ae,te){const le=(0,l.g2)("NavBar"),se=(0,l.g2)("UserProfileCard"),ne=(0,l.g2)("UserStats"),ie=(0,l.g2)("AdvancedSettingsModal");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(le),(0,l.Lk)("div",r,[(0,l.Lk)("button",{class:"back-btn",onClick:a[0]||(a[0]=(...e)=>ee.goBack&&ee.goBack(...e)),title:"è¿”å›é¦–é¡µ"}," ğŸ  "),(0,l.Lk)("div",o,[a[34]||(a[34]=(0,l.Lk)("h2",{class:"mb-4"},"ä¸ªäººä¸­å¿ƒ",-1)),ee.loading?((0,l.uX)(),(0,l.CE)("div",c,[...a[17]||(a[17]=[(0,l.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,l.Lk)("span",{class:"visually-hidden"},"åŠ è½½ä¸­...")],-1)])])):((0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("div",u,[(0,l.bF)(se,{username:ee.username,email:ee.email,avatar:ee.userAvatar,"is-admin":ee.isAdmin,level:ee.profileData.level,"date-joined":ee.userInfo?.date_joined,"get-level-text":ee.getLevelText,"get-level-class":ee.getLevelClass,"format-date":ee.formatDate,onAvatarChange:ee.handleAvatarChange},null,8,["username","email","avatar","is-admin","level","date-joined","get-level-text","get-level-class","format-date","onAvatarChange"]),(0,l.bF)(ne,{stats:ee.stats},null,8,["stats"]),ee.isEditingBasic||ee.isEditingProfile?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.Lk)("button",{class:"btn btn-success w-100 mt-3",onClick:a[2]||(a[2]=(...e)=>ee.saveAllChanges&&ee.saveAllChanges(...e)),disabled:ee.savingAll},[ee.savingAll?((0,l.uX)(),(0,l.CE)("span",m)):(0,l.Q3)("",!0),(0,l.eW)(" "+(0,s.v_)(ee.savingAll?"ä¿å­˜ä¸­...":"ğŸ’¾ ä¿å­˜æ‰€æœ‰æ›´æ”¹"),1)],8,v),(0,l.Lk)("button",{class:"btn btn-outline-secondary w-100 mt-2",onClick:a[3]||(a[3]=(...e)=>ee.cancelAllEdit&&ee.cancelAllEdit(...e)),disabled:ee.savingAll}," å–æ¶ˆç¼–è¾‘ ",8,b)],64)):((0,l.uX)(),(0,l.CE)("button",{key:0,class:"btn btn-primary w-100 mt-3",onClick:a[1]||(a[1]=(...e)=>ee.startEditing&&ee.startEditing(...e))}," âœï¸ ç¼–è¾‘ä¸ªäººä¸­å¿ƒ ")),ee.isEditingBasic||ee.isEditingProfile?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:2,class:"btn btn-outline-secondary w-100 mt-3",onClick:a[4]||(a[4]=e=>ee.showAdvancedSettings=!0)}," âš™ï¸ é«˜çº§è®¾ç½® ")),(0,l.bF)(ie,{show:ee.showAdvancedSettings,title:"âš™ï¸ é«˜çº§è®¾ç½®","warning-text":"åˆ é™¤è´¦å·å°†ä¼šæ°¸ä¹…åˆ é™¤æ‚¨çš„æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š","warning-items":["æ‰€æœ‰æ—…è¡Œè®¡åˆ’","æ‰€æœ‰è¯„è®ºå’Œå›å¤","æ‰€æœ‰ç»Ÿè®¡æ•°æ®","ä¸ªäººèµ„æ–™å’Œå¤´åƒ"],"action-button-text":"ğŸ—‘ï¸ åˆ é™¤è´¦å·",onClose:a[5]||(a[5]=e=>ee.showAdvancedSettings=!1),onConfirm:ee.confirmAndDeleteAccount},null,8,["show","onConfirm"])]),(0,l.Lk)("div",p,[(0,l.Lk)("div",g,[(0,l.Lk)("div",k,[a[18]||(a[18]=(0,l.Lk)("h5",{class:"mb-0"},"åŸºæœ¬ä¿¡æ¯",-1)),ee.isEditingBasic?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:0,class:"btn btn-sm btn-outline-primary",onClick:a[6]||(a[6]=e=>ee.isEditingBasic=!0)}," âœï¸ ç¼–è¾‘ "))]),(0,l.Lk)("div",f,[ee.isEditingBasic?((0,l.uX)(),(0,l.CE)("form",{key:1,onSubmit:a[10]||(a[10]=(0,n.D$)((...e)=>ee.handleUpdateInfo&&ee.handleUpdateInfo(...e),["prevent"]))},[(0,l.Lk)("div",x,[a[21]||(a[21]=(0,l.Lk)("label",{class:"form-label"},"ç”¨æˆ·å",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[7]||(a[7]=e=>ee.editForm.username=e),disabled:ee.updating},null,8,A),[[n.Jo,ee.editForm.username]])]),(0,l.Lk)("div",X,[a[22]||(a[22]=(0,l.Lk)("label",{class:"form-label"},"é‚®ç®±",-1)),(0,l.bo)((0,l.Lk)("input",{type:"email",class:"form-control","onUpdate:modelValue":a[8]||(a[8]=e=>ee.editForm.email=e),disabled:ee.updating},null,8,I),[[n.Jo,ee.editForm.email]])]),(0,l.Lk)("div",D,[(0,l.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:ee.updating},[ee.updating?((0,l.uX)(),(0,l.CE)("span",U)):(0,l.Q3)("",!0),(0,l.eW)(" "+(0,s.v_)(ee.updating?"ä¿å­˜ä¸­...":"ğŸ’¾ ä¿å­˜"),1)],8,F),(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:a[9]||(a[9]=(...e)=>ee.cancelBasicEdit&&ee.cancelBasicEdit(...e)),disabled:ee.updating}," å–æ¶ˆ ",8,S)])],32)):((0,l.uX)(),(0,l.CE)("div",L,[(0,l.Lk)("div",y,[(0,l.Lk)("div",h,[a[19]||(a[19]=(0,l.Lk)("label",{class:"info-label"},"ç”¨æˆ·å",-1)),(0,l.Lk)("p",w,(0,s.v_)(ee.editForm.username),1)])]),(0,l.Lk)("div",C,[(0,l.Lk)("div",_,[a[20]||(a[20]=(0,l.Lk)("label",{class:"info-label"},"é‚®ç®±",-1)),(0,l.Lk)("p",E,(0,s.v_)(ee.editForm.email||"æœªè®¾ç½®"),1)])])]))])]),(0,l.Lk)("div",B,[(0,l.Lk)("div",P,[a[23]||(a[23]=(0,l.Lk)("h5",{class:"mb-0"},"âœ¨ æ—…è¡Œè€…èµ„æ–™",-1)),ee.isEditingProfile?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:0,class:"btn btn-sm btn-outline-primary",onClick:a[11]||(a[11]=e=>ee.isEditingProfile=!0)}," âœï¸ ç¼–è¾‘ "))]),(0,l.Lk)("div",W,[(0,l.Lk)("div",K,[a[24]||(a[24]=(0,l.Lk)("label",{class:"form-label"},"ğŸ–ï¸ å½“å‰ç­‰çº§",-1)),(0,l.Lk)("div",null,[(0,l.Lk)("span",{class:(0,s.C4)("badge level-badge "+ee.getLevelClass(ee.profileData.level))},(0,s.v_)(ee.getLevelText(ee.profileData.level)),3)]),a[25]||(a[25]=(0,l.Lk)("small",{class:"text-muted"},"æ ¹æ®æ—…è¡Œå’Œè¯„è®ºæ•°é‡è‡ªåŠ¨è®¡ç®—",-1))]),ee.isEditingProfile?((0,l.uX)(),(0,l.CE)("form",{key:1,onSubmit:a[16]||(a[16]=(0,n.D$)((...e)=>ee.handleUpdateProfile&&ee.handleUpdateProfile(...e),["prevent"]))},[(0,l.Lk)("div",N,[a[29]||(a[29]=(0,l.Lk)("label",{class:"form-label"},"ğŸ“ ä¸ªäººç®€ä»‹",-1)),(0,l.bo)((0,l.Lk)("textarea",{class:"form-control","onUpdate:modelValue":a[12]||(a[12]=e=>ee.profileData.bio=e),rows:"4",maxlength:"500",placeholder:"ä»‹ç»ä¸€ä¸‹è‡ªå·±å§..."},null,512),[[n.Jo,ee.profileData.bio]]),(0,l.Lk)("small",M,(0,s.v_)(ee.profileData.bio?.length||0)+"/500",1)]),(0,l.Lk)("div",z,[a[30]||(a[30]=(0,l.Lk)("label",{class:"form-label"},"ğŸ·ï¸ ä¸ªäººæ ‡ç­¾",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[13]||(a[13]=e=>ee.profileData.tags=e),placeholder:"ä¾‹å¦‚ï¼šæ‘„å½±çˆ±å¥½è€…,ç¾é£Ÿè¾¾äºº,æˆ·å¤–è¿åŠ¨",maxlength:"200"},null,512),[[n.Jo,ee.profileData.tags]]),a[31]||(a[31]=(0,l.Lk)("small",{class:"text-muted"},"é€—å·åˆ†éš”ï¼Œæœ€å¤š10ä¸ªæ ‡ç­¾ï¼Œæ¯ä¸ªä¸è¶…è¿‡20å­—",-1))]),(0,l.Lk)("div",O,[a[32]||(a[32]=(0,l.Lk)("label",{class:"form-label"},"ğŸŒ è®¿é—®è¿‡çš„å›½å®¶",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[14]||(a[14]=e=>ee.profileData.visited_countries=e),placeholder:"ä¾‹å¦‚ï¼šä¸­å›½,æ—¥æœ¬,æ³°å›½",maxlength:"200"},null,512),[[n.Jo,ee.profileData.visited_countries]]),a[33]||(a[33]=(0,l.Lk)("small",{class:"text-muted"},"é€—å·åˆ†éš”çš„å›½å®¶åˆ—è¡¨",-1))]),(0,l.Lk)("div",G,[(0,l.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:ee.updatingProfile},[ee.updatingProfile?((0,l.uX)(),(0,l.CE)("span",Y)):(0,l.Q3)("",!0),(0,l.eW)(" "+(0,s.v_)(ee.updatingProfile?"ä¿å­˜ä¸­...":"ğŸ’¾ ä¿å­˜"),1)],8,H),(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:a[15]||(a[15]=(...e)=>ee.cancelProfileEdit&&ee.cancelProfileEdit(...e)),disabled:ee.updatingProfile}," å–æ¶ˆ ",8,Z)])],32)):((0,l.uX)(),(0,l.CE)("div",R,[(0,l.Lk)("div",q,[a[26]||(a[26]=(0,l.Lk)("label",{class:"info-label"},"ğŸ“ ä¸ªäººç®€ä»‹",-1)),(0,l.Lk)("p",T,(0,s.v_)(ee.profileData.bio||"è¿˜æ²¡æœ‰å†™ä¸ªäººç®€ä»‹"),1)]),(0,l.Lk)("div",$,[a[27]||(a[27]=(0,l.Lk)("label",{class:"info-label"},"ğŸ·ï¸ ä¸ªäººæ ‡ç­¾",-1)),ee.profileData.tags?((0,l.uX)(),(0,l.CE)("div",Q,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ee.profileData.tags.split(","),(e,a)=>((0,l.uX)(),(0,l.CE)("span",{key:a,class:"badge bg-light text-dark me-1"},(0,s.v_)(e.trim()),1))),128))])):((0,l.uX)(),(0,l.CE)("p",j,"è¿˜æ²¡æœ‰æ·»åŠ æ ‡ç­¾"))]),(0,l.Lk)("div",J,[a[28]||(a[28]=(0,l.Lk)("label",{class:"info-label"},"ğŸŒ è®¿é—®è¿‡çš„å›½å®¶",-1)),(0,l.Lk)("p",V,(0,s.v_)(ee.profileData.visited_countries||"è¿˜æ²¡æœ‰è®°å½•"),1)])]))])])])]))])])])}t(4114);var ae=t(144),te=t(8512),le=t(1516),se=t(7277);const ne=(e,a)=>se.A.patch(`/users/${e}/`,a),ie=(e,a)=>{const t=new FormData;return t.append("avatar",a),se.A.post(`/users/${e}/upload_avatar/`,t)},re=e=>se.A.patch("/users/update_profile/",e),oe=e=>se.A.get(`/users/${e}/stats/`),ce=e=>se.A.delete(`/users/${e}/`);var de=t(9814);const ue={class:"card shadow-sm"},ve={class:"card-body text-center p-4"},me={class:"avatar-container mb-3"},be=["src"],pe={class:"username-display mb-1"},ge={class:"email-display mb-3"},ke={class:"mb-3 d-flex gap-2 justify-content-center align-items-center flex-wrap"},fe={key:0,class:"badge bg-danger"},Le={key:1,class:"badge bg-primary"},ye={key:3,class:"badge level-badge-small level-novice"},he={class:"text-muted"};function we(e,a,t,n,i,r){return(0,l.uX)(),(0,l.CE)("div",ue,[(0,l.Lk)("div",ve,[(0,l.Lk)("div",me,[(0,l.Lk)("img",{src:t.avatar,alt:"å¤´åƒ",class:"rounded-circle",width:"120",height:"120"},null,8,be),(0,l.Lk)("button",{class:"btn btn-sm btn-light avatar-upload-btn",onClick:a[0]||(a[0]=(...e)=>n.triggerFileInput&&n.triggerFileInput(...e))}," ğŸ“· "),(0,l.Lk)("input",{ref:"avatarInput",type:"file",accept:"image/*",style:{display:"none"},onChange:a[1]||(a[1]=(...e)=>n.handleAvatarChange&&n.handleAvatarChange(...e))},null,544)]),(0,l.Lk)("h4",pe,(0,s.v_)(t.username),1),(0,l.Lk)("p",ge,(0,s.v_)(t.email||"æœªè®¾ç½®é‚®ç®±"),1),(0,l.Lk)("div",ke,[t.isAdmin?((0,l.uX)(),(0,l.CE)("span",fe,"ç®¡ç†å‘˜")):((0,l.uX)(),(0,l.CE)("span",Le,"æ™®é€šç”¨æˆ·")),t.level?((0,l.uX)(),(0,l.CE)("span",{key:2,class:(0,s.C4)("badge level-badge-small "+t.getLevelClass(t.level))},(0,s.v_)(t.getLevelText(t.level)),3)):((0,l.uX)(),(0,l.CE)("span",ye," æœªçŸ¥ç­‰çº§ "))]),(0,l.Lk)("small",he," æ³¨å†Œæ—¶é—´ï¼š"+(0,s.v_)(t.formatDate(t.dateJoined)),1)])])}var Ce={name:"UserProfileCard",props:{username:{type:String,required:!0},email:{type:String,default:""},avatar:{type:String,required:!0},isAdmin:{type:Boolean,default:!1},level:{type:String,required:!0},dateJoined:{type:String,required:!0},getLevelText:{type:Function,required:!0},getLevelClass:{type:Function,required:!0},formatDate:{type:Function,required:!0}},emits:["avatar-change"],setup(e,{emit:a}){const t=(0,ae.KR)(null),l=()=>{t.value.click()},s=e=>{const t=e.target.files[0];t&&a("avatar-change",t)};return{avatarInput:t,triggerFileInput:l,handleAvatarChange:s}}},_e=t(1241);const Ee=(0,_e.A)(Ce,[["render",we],["__scopeId","data-v-465cd4eb"]]);var xe=Ee;const Ae={class:"card shadow-sm mt-3"},Xe={class:"card-body"},Ie={class:"row text-center"},De={class:"col-12 mb-3"},Fe={class:"stat-box-small"},Ue={class:"text-primary mb-1"},Se={class:"col-6 mb-3"},Be={class:"stat-box-small"},Pe={class:"text-success mb-1"},We={class:"col-6 mb-3"},Ke={class:"stat-box-small"},Re={class:"text-warning mb-1"};function qe(e,a,t,n,i,r){return(0,l.uX)(),(0,l.CE)("div",Ae,[a[3]||(a[3]=(0,l.Lk)("div",{class:"card-header bg-white"},[(0,l.Lk)("h5",{class:"mb-0"},"ğŸ“Š æˆ‘çš„ç»Ÿè®¡")],-1)),(0,l.Lk)("div",Xe,[(0,l.Lk)("div",Ie,[(0,l.Lk)("div",De,[(0,l.Lk)("div",Fe,[(0,l.Lk)("h4",Ue,(0,s.v_)(t.stats.comments_count||0),1),a[0]||(a[0]=(0,l.Lk)("p",{class:"text-muted mb-0 small"},"è¯„è®ºæ•°",-1))])]),(0,l.Lk)("div",Se,[(0,l.Lk)("div",Be,[(0,l.Lk)("h4",Pe,(0,s.v_)(t.stats.trips_count||0),1),a[1]||(a[1]=(0,l.Lk)("p",{class:"text-muted mb-0 small"},"æ€»æ—…è¡Œæ•°",-1))])]),(0,l.Lk)("div",We,[(0,l.Lk)("div",Ke,[(0,l.Lk)("h4",Re,(0,s.v_)(t.stats.public_trips_count||0),1),a[2]||(a[2]=(0,l.Lk)("p",{class:"text-muted mb-0 small"},"å…¬å¼€æ—…è¡Œï¼ˆç®—ç­‰çº§ï¼‰",-1))])])])])])}var Te={name:"UserStats",props:{stats:{type:Object,required:!0,default:()=>({comments_count:0,trips_count:0,public_trips_count:0})}}};const $e=(0,_e.A)(Te,[["render",qe],["__scopeId","data-v-acdca028"]]);var Qe=$e,je=t(1712),Je={name:"UserCenterView",components:{NavBar:de.A,UserProfileCard:xe,UserStats:Qe,AdvancedSettingsModal:je.A},setup(){const e=(0,te.rd)(),a=(0,le.k)(),t=(0,ae.KR)(!1),s=(0,ae.KR)(!1),n=(0,ae.KR)(!1),i=(0,ae.KR)(!1),r=(0,ae.KR)(!1),o=(0,ae.KR)(!1),c=(0,ae.KR)(!1),d=(0,ae.KR)({comments_count:0,trips_count:0,public_trips_count:0}),u=(0,ae.KR)({username:"",email:""}),v=(0,ae.KR)({username:"",email:""}),m=(0,ae.KR)({bio:"",tags:"",visited_countries:"",level:"novice"}),b=(0,ae.KR)({bio:"",tags:"",visited_countries:"",level:"novice"}),p=(0,l.EW)(()=>a.userInfo),g=(0,l.EW)(()=>a.username),k=(0,l.EW)(()=>p.value?.email),f=(0,l.EW)(()=>a.isAdmin),L=(0,l.EW)(()=>a.avatar),y=e=>{if(!e)return"æœªçŸ¥";const a=new Date(e);return a.toLocaleDateString("zh-CN")},h=async()=>{if(p.value?.id)try{const e=await oe(p.value.id);d.value=e}catch(e){console.error("åŠ è½½ç»Ÿè®¡å¤±è´¥:",e)}},w=()=>{const e=p.value?.username||"",a=p.value?.email||"";u.value={username:e,email:a},v.value={username:e,email:a};const t=p.value?.profile?.bio||"",l=p.value?.profile?.tags||"",s=p.value?.profile?.visited_countries||"",n=p.value?.profile?.level||"novice";m.value={bio:t,tags:l,visited_countries:s,level:n},b.value={bio:t,tags:l,visited_countries:s,level:n}},C=()=>{u.value={...v.value},r.value=!1},_=()=>{m.value={...b.value},o.value=!1},E=()=>{r.value=!0,o.value=!0},x=()=>{C(),_()},A=async()=>{i.value=!0;try{u.value.username===v.value.username&&u.value.email===v.value.email||await ne(p.value.id,u.value),m.value.bio===b.value.bio&&m.value.tags===b.value.tags&&m.value.visited_countries===b.value.visited_countries||await re({bio:m.value.bio,tags:m.value.tags,visited_countries:m.value.visited_countries}),await a.fetchUserInfo(),w(),alert("æ‰€æœ‰æ›´æ”¹å·²ä¿å­˜ï¼")}catch(e){console.error("ä¿å­˜å¤±è´¥:",e),alert("ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{i.value=!1}},X=e=>{const a={novice:"æ–°æ‰‹",explorer:"æ¢ç´¢è€…",wanderer:"æ¼«æ¸¸è€…",adventurer:"å†’é™©å®¶",master:"æ—…è¡Œå¤§å¸ˆ"};return a[e]||"æ–°æ‰‹"},I=e=>{const a={novice:"level-novice",explorer:"level-explorer",wanderer:"level-wanderer",adventurer:"level-adventurer",master:"level-master"};return a[e]||"level-novice"},D=async()=>{n.value=!0;try{await re({bio:m.value.bio,tags:m.value.tags,visited_countries:m.value.visited_countries}),await a.fetchUserInfo(),w(),alert("èµ„æ–™æ›´æ–°æˆåŠŸï¼")}catch(e){console.error("æ›´æ–°å¤±è´¥:",e),alert("æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{n.value=!1}},F=async()=>{s.value=!0;try{await ne(p.value.id,u.value),await a.fetchUserInfo(),w(),r.value=!1,alert("æ›´æ–°æˆåŠŸï¼")}catch(e){console.error("æ›´æ–°å¤±è´¥:",e),alert("æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{s.value=!1}},U=async e=>{if(e)if(e.type.startsWith("image/"))if(e.size>5242880)alert("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MB");else try{await ie(p.value.id,e),await a.fetchUserInfo(),alert("å¤´åƒä¸Šä¼ æˆåŠŸï¼")}catch(t){console.error("å¤´åƒä¸Šä¼ å¤±è´¥:",t),alert("å¤´åƒä¸Šä¼ å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}else alert("è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶")},S=()=>{e.push("/")},B=()=>{confirm("âš ï¸ è¯·å†æ¬¡ç¡®è®¤ï¼šæ‚¨ç¡®å®šè¦åˆ é™¤è´¦å·å—ï¼Ÿ\n\næ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼")&&(c.value=!1,P())},P=async()=>{try{await ce(p.value.id),await a.logout(),alert("è´¦å·å·²åˆ é™¤ï¼Œæ„Ÿè°¢æ‚¨çš„ä½¿ç”¨ï¼"),e.push("/login")}catch(t){console.error("åˆ é™¤è´¦å·å¤±è´¥:",t),alert("åˆ é™¤è´¦å·å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}},W=async()=>{if(confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ"))try{await a.logout(),e.push("/login")}catch(t){console.error("é€€å‡ºå¤±è´¥:",t)}};return(0,l.sV)(async()=>{if(a.isLoggedIn){t.value=!0;try{await a.fetchUserInfo(),await h(),w()}catch(l){console.error("åŠ è½½å¤±è´¥:",l),401===l.response?.status&&(alert("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•"),await a.logout(),e.push("/login"))}finally{t.value=!1}}else e.push("/login")}),{loading:t,updating:s,updatingProfile:n,savingAll:i,isEditingBasic:r,isEditingProfile:o,showAdvancedSettings:c,stats:d,editForm:u,profileData:m,userInfo:p,username:g,email:k,isAdmin:f,userAvatar:L,formatDate:y,goBack:S,handleUpdateInfo:F,handleUpdateProfile:D,cancelBasicEdit:C,cancelProfileEdit:_,startEditing:E,cancelAllEdit:x,saveAllChanges:A,getLevelText:X,getLevelClass:I,handleAvatarChange:U,handleLogout:W,handleDeleteAccount:P,confirmAndDeleteAccount:B}}};const Ve=(0,_e.A)(Je,[["render",ee],["__scopeId","data-v-18890412"]]);var Ne=Ve}}]);
//# sourceMappingURL=948.853b33ab.js.map