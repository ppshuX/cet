"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[322,682],{432:function(e,l,a){a.d(l,{A:function(){return C}});var t=a(6768),o=a(4232),n=a(5130);const s={class:"navbar navbar-expand-lg navbar-dark bg-primary shadow-sm sticky-top"},i={class:"container-fluid"},d={class:"collapse navbar-collapse",id:"navbarNav",style:{overflow:"visible"}},r={class:"navbar-nav me-auto"},u={class:"nav-item"},c={key:0,class:"nav-item"},m={class:"d-flex align-items-center"},p={key:0,class:"dropdown dropdown-end"},v={href:"#",class:"d-flex align-items-center text-white text-decoration-none dropdown-toggle user-dropdown-btn",id:"dropdownUser","data-bs-toggle":"dropdown","aria-expanded":"false"},b=["src"],k={class:"dropdown-menu dropdown-menu-end text-small","aria-labelledby":"dropdownUser"};function g(e,l,a,g,L,f){const h=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("nav",s,[(0,t.Lk)("div",i,[(0,t.bF)(h,{to:"/",class:"navbar-brand"},{default:(0,t.k6)(()=>[...l[1]||(l[1]=[(0,t.Lk)("span",{class:"brand-text"},"Roamio",-1)])]),_:1}),l[9]||(l[9]=(0,t.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[(0,t.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,t.Lk)("div",d,[(0,t.Lk)("ul",r,[(0,t.Lk)("li",u,[(0,t.bF)(h,{to:"/",class:"nav-link"},{default:(0,t.k6)(()=>[...l[2]||(l[2]=[(0,t.Lk)("i",{class:"bi bi-house-door me-1"},null,-1),(0,t.eW)(" æ—…è¡Œå¤§åŽ… ",-1)])]),_:1})]),g.isLoggedIn?((0,t.uX)(),(0,t.CE)("li",c,[(0,t.bF)(h,{to:"/my-trips/",class:"nav-link"},{default:(0,t.k6)(()=>[...l[3]||(l[3]=[(0,t.Lk)("i",{class:"bi bi-folder me-1"},null,-1),(0,t.eW)(" æˆ‘çš„æ—…è¡Œ ",-1)])]),_:1})])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",m,[g.isLoggedIn?((0,t.uX)(),(0,t.CE)("div",p,[(0,t.Lk)("a",v,[(0,t.Lk)("img",{src:g.avatar,alt:"avatar",width:"32",height:"32",class:"rounded-circle me-2"},null,8,b),(0,t.Lk)("span",null,(0,o.v_)(g.username),1)]),(0,t.Lk)("ul",k,[(0,t.Lk)("li",null,[(0,t.bF)(h,{to:"/user/center",class:"dropdown-item"},{default:(0,t.k6)(()=>[...l[4]||(l[4]=[(0,t.Lk)("i",{class:"bi bi-person me-2"},null,-1),(0,t.eW)("ä¸ªäººä¸­å¿ƒ ",-1)])]),_:1})]),l[6]||(l[6]=(0,t.Lk)("li",null,[(0,t.Lk)("hr",{class:"dropdown-divider"})],-1)),(0,t.Lk)("li",null,[(0,t.Lk)("a",{href:"#",class:"dropdown-item",onClick:l[0]||(l[0]=(0,n.D$)((...e)=>g.handleLogout&&g.handleLogout(...e),["prevent"]))},[...l[5]||(l[5]=[(0,t.Lk)("i",{class:"bi bi-box-arrow-right me-2"},null,-1),(0,t.eW)("é€€å‡ºç™»å½• ",-1)])])])])])):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(h,{to:"/login",class:"btn btn-outline-light btn-sm me-2"},{default:(0,t.k6)(()=>[...l[7]||(l[7]=[(0,t.eW)(" ç™»å½• ",-1)])]),_:1}),(0,t.bF)(h,{to:"/register",class:"btn btn-light btn-sm"},{default:(0,t.k6)(()=>[...l[8]||(l[8]=[(0,t.eW)(" æ³¨å†Œ ",-1)])]),_:1})],64))])])])])}a(4114);var L=a(8512),f=a(3459),h={name:"NavBar",setup(){const e=(0,L.rd)(),l=(0,f.k)(),a=(0,t.EW)(()=>l.isLoggedIn),o=(0,t.EW)(()=>l.username),n=(0,t.EW)(()=>l.avatar),s=async()=>{if(confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ"))try{await l.logout(),e.push("/login")}catch(a){console.error("é€€å‡ºå¤±è´¥:",a)}};return{isLoggedIn:a,username:o,avatar:n,handleLogout:s}}},y=a(1241);const V=(0,y.A)(h,[["render",g],["__scopeId","data-v-a6dd4bee"]]);var C=V},1322:function(e,l,a){a.r(l),a.d(l,{default:function(){return Fl}});var t=a(6768),o=a(4232);const n={class:"editor-wrapper"},s={class:"editor-container"},i={class:"editor-toolbar"},d={class:"container-fluid"},r={class:"d-flex justify-content-between align-items-center py-3"},u={class:"d-inline-block mb-0 ms-3"},c=["disabled"],m={key:0,class:"spinner-border spinner-border-sm me-1"},p={key:1,class:"bi bi-save me-1"},v=["disabled"],b={key:0,class:"spinner-border spinner-border-sm me-1"},k={key:1,class:"bi bi-send me-1"},g={class:"container py-4"},L={class:"row"},f={class:"col-lg-8"},h={class:"col-lg-4"};function y(e,l,a,y,V,C){const w=(0,t.g2)("NavBar"),E=(0,t.g2)("BasicInfoEditor"),_=(0,t.g2)("ModuleSelector"),I=(0,t.g2)("ContentEditor"),x=(0,t.g2)("EditorSidebar");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.bF)(w),(0,t.Lk)("div",s,[(0,t.Lk)("div",i,[(0,t.Lk)("div",d,[(0,t.Lk)("div",r,[(0,t.Lk)("div",null,[(0,t.Lk)("button",{class:"btn btn-outline-secondary me-2",onClick:l[0]||(l[0]=(...e)=>y.goBack&&y.goBack(...e))},[...l[6]||(l[6]=[(0,t.Lk)("i",{class:"bi bi-arrow-left me-1"},null,-1),(0,t.eW)("è¿”å›ž ",-1)])]),(0,t.Lk)("h5",u,(0,o.v_)(y.isEditMode?"ç¼–è¾‘æ—…è¡Œè®¡åˆ’":"åˆ›å»ºæ—…è¡Œè®¡åˆ’"),1)]),(0,t.Lk)("div",null,[(0,t.Lk)("button",{class:"btn btn-outline-primary me-2",onClick:l[1]||(l[1]=(...e)=>y.handleSave&&y.handleSave(...e)),disabled:y.saving},[y.saving?((0,t.uX)(),(0,t.CE)("span",m)):((0,t.uX)(),(0,t.CE)("i",p)),l[7]||(l[7]=(0,t.eW)(" ä¿å­˜ ",-1))],8,c),(0,t.Lk)("button",{class:"btn btn-primary",onClick:l[2]||(l[2]=(...e)=>y.handlePublish&&y.handlePublish(...e)),disabled:y.publishing||!y.canPublish},[y.publishing?((0,t.uX)(),(0,t.CE)("span",b)):((0,t.uX)(),(0,t.CE)("i",k)),l[8]||(l[8]=(0,t.eW)(" å‘å¸ƒ ",-1))],8,v)])])])]),(0,t.Lk)("div",g,[(0,t.Lk)("div",L,[(0,t.Lk)("div",f,[(0,t.bF)(E,{modelValue:y.tripData,"onUpdate:modelValue":l[3]||(l[3]=e=>y.tripData=e)},null,8,["modelValue"]),(0,t.bF)(_,{modules:y.availableModules,"enabled-modules":y.tripData.config.enabledModules,onToggle:y.toggleModule},null,8,["modules","enabled-modules","onToggle"]),(0,t.bF)(I,{modelValue:y.tripData.overview,"onUpdate:modelValue":l[4]||(l[4]=e=>y.tripData.overview=e),"enabled-modules":y.tripData.config.enabledModules},null,8,["modelValue","enabled-modules"])]),(0,t.Lk)("div",h,[(0,t.bF)(x,{modelValue:y.tripData,"onUpdate:modelValue":l[5]||(l[5]=e=>y.tripData=e),"days-count":y.daysCount},null,8,["modelValue","days-count"])])])])])])}a(4114),a(8111),a(8237);var V=a(144),C=a(8512),w=a(3459),E=a(7682),_=a(432);const I={class:"card mb-4"},x={class:"card-body"},X={class:"mb-4 title-input-wrapper"},M=["value"],T={class:"mb-3"},U=["value"],P={class:"row mb-3"},A={class:"col-md-6"},$=["value"],F={class:"col-md-6"},W=["value"],B={class:"row mb-3"},D={class:"col-md-6"},Q={class:"icon-selector"},J=["onClick"],K={class:"col-md-6"},j=["value"];function S(e,l,a,n,s,i){return(0,t.uX)(),(0,t.CE)("div",I,[l[11]||(l[11]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"ðŸ“ åŸºæœ¬ä¿¡æ¯")],-1)),(0,t.Lk)("div",x,[(0,t.Lk)("div",X,[l[5]||(l[5]=(0,t.Lk)("label",{class:"form-label title-label"},"æ—…è¡Œæ ‡é¢˜ *",-1)),(0,t.Lk)("input",{value:a.modelValue.title,onInput:l[0]||(l[0]=l=>e.$emit("update:modelValue",{...a.modelValue,title:l.target.value})),type:"text",class:"form-control title-input",placeholder:"ä¾‹å¦‚ï¼šåŽ¦é—¨ä¸‰å¤©ä¸¤å¤œæ¸¸",required:""},null,40,M)]),(0,t.Lk)("div",T,[l[6]||(l[6]=(0,t.Lk)("label",{class:"form-label"},"ç®€ä»‹æè¿°",-1)),(0,t.Lk)("textarea",{value:a.modelValue.description,onInput:l[1]||(l[1]=l=>e.$emit("update:modelValue",{...a.modelValue,description:l.target.value})),class:"form-control",rows:"3",placeholder:"ç®€å•æè¿°ä½ çš„æ—…è¡Œè®¡åˆ’..."},null,40,U)]),(0,t.Lk)("div",P,[(0,t.Lk)("div",A,[l[7]||(l[7]=(0,t.Lk)("label",{class:"form-label"},"å¼€å§‹æ—¥æœŸ",-1)),(0,t.Lk)("input",{value:a.modelValue.start_date,onInput:l[2]||(l[2]=l=>e.$emit("update:modelValue",{...a.modelValue,start_date:l.target.value})),type:"date",class:"form-control"},null,40,$)]),(0,t.Lk)("div",F,[l[8]||(l[8]=(0,t.Lk)("label",{class:"form-label"},"ç»“æŸæ—¥æœŸ",-1)),(0,t.Lk)("input",{value:a.modelValue.end_date,onInput:l[3]||(l[3]=l=>e.$emit("update:modelValue",{...a.modelValue,end_date:l.target.value})),type:"date",class:"form-control"},null,40,W)])]),(0,t.Lk)("div",B,[(0,t.Lk)("div",D,[l[9]||(l[9]=(0,t.Lk)("label",{class:"form-label"},"æ—…è¡Œå›¾æ ‡",-1)),(0,t.Lk)("div",Q,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.iconOptions,l=>((0,t.uX)(),(0,t.CE)("button",{key:l,type:"button",class:(0,o.C4)(["icon-btn",{active:a.modelValue.icon===l}]),onClick:t=>e.$emit("update:modelValue",{...a.modelValue,icon:l})},(0,o.v_)(l),11,J))),128))])]),(0,t.Lk)("div",K,[l[10]||(l[10]=(0,t.Lk)("label",{class:"form-label"},"ä¸»é¢˜é¢œè‰²",-1)),(0,t.Lk)("input",{value:a.modelValue.theme_color,onInput:l[4]||(l[4]=l=>e.$emit("update:modelValue",{...a.modelValue,theme_color:l.target.value})),type:"color",class:"form-control form-control-color"},null,40,j)])])])])}var N={name:"BasicInfoEditor",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(){const e=["ðŸ–ï¸","ðŸŒŠ","ðŸ™ï¸","ðŸŒ„","ðŸŒ‡","ðŸ—ºï¸","âœˆï¸","ðŸš—","ðŸ”ï¸","ðŸŒ´"];return{iconOptions:e}}},q=a(1241);const O=(0,q.A)(N,[["render",S],["__scopeId","data-v-79181f42"]]);var R=O;const H={class:"card mb-4"},G={class:"card-body"},z={class:"modules-grid"},Y=["onClick"],Z={class:"module-icon"},ee={class:"module-name"},le={class:"module-desc"},ae={class:"module-check"},te={key:0,class:"bi bi-check-circle-fill text-success"},oe={key:1,class:"bi bi-circle text-muted"};function ne(e,l,a,n,s,i){return(0,t.uX)(),(0,t.CE)("div",H,[l[1]||(l[1]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"ðŸ§© é€‰æ‹©æ¨¡å—")],-1)),(0,t.Lk)("div",G,[l[0]||(l[0]=(0,t.Lk)("p",{class:"text-muted mb-3"},"é€‰æ‹©ä½ æƒ³åœ¨æ—…è¡Œè®¡åˆ’ä¸­å±•ç¤ºçš„å†…å®¹æ¨¡å—",-1)),(0,t.Lk)("div",z,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.modules,l=>((0,t.uX)(),(0,t.CE)("div",{key:l.id,class:(0,o.C4)(["module-card",{active:n.isEnabled(l.id)}]),onClick:a=>e.$emit("toggle",l.id)},[(0,t.Lk)("div",Z,(0,o.v_)(l.icon),1),(0,t.Lk)("div",ee,(0,o.v_)(l.name),1),(0,t.Lk)("div",le,(0,o.v_)(l.description),1),(0,t.Lk)("div",ae,[n.isEnabled(l.id)?((0,t.uX)(),(0,t.CE)("i",te)):((0,t.uX)(),(0,t.CE)("i",oe))])],10,Y))),128))])])])}var se={name:"ModuleSelector",props:{modules:{type:Array,required:!0},enabledModules:{type:Array,default:()=>[]}},emits:["toggle"],setup(e){const l=l=>e.enabledModules.includes(l);return{isEnabled:l}}};const ie=(0,q.A)(se,[["render",ne],["__scopeId","data-v-4fb81d10"]]);var de=ie,re=a(5130);const ue={key:0,class:"card mb-4"},ce={class:"card-body"},me={class:"row"},pe={class:"col-md-6 mb-3"},ve={class:"col-md-6 mb-3"},be={class:"col-md-6 mb-3"},ke={class:"col-md-6 mb-3"},ge={key:1,class:"card mb-4"},Le={class:"card-header d-flex justify-content-between align-items-center"},fe={class:"card-body"},he={class:"input-group"},ye=["onUpdate:modelValue"],Ve=["onClick"],Ce={key:0,class:"text-muted text-center py-3 mb-0"},we={key:2,class:"card mb-4"},Ee={class:"card-header d-flex justify-content-between align-items-center"},_e={class:"card-body"},Ie={class:"d-flex justify-content-between align-items-center mb-2"},xe=["onClick"],Xe={class:"mb-2"},Me=["onUpdate:modelValue"],Te={class:"mb-2"},Ue=["onUpdate:modelValue"],Pe={class:"mb-2"},Ae=["onUpdate:modelValue"],$e=["onUpdate:modelValue"],Fe={key:0,class:"text-muted text-center py-3 mb-0"},We={key:3,class:"card mb-4"},Be={class:"card-header d-flex justify-content-between align-items-center"},De={class:"card-body"},Qe={class:"col-md-4"},Je=["onUpdate:modelValue"],Ke={class:"col-md-3"},je=["onUpdate:modelValue"],Se={class:"col-md-4"},Ne=["onUpdate:modelValue"],qe={class:"col-md-1"},Oe=["onClick"],Re={key:0,class:"alert alert-info mt-3"},He={key:4,class:"card mb-4"},Ge={class:"card-header d-flex justify-content-between align-items-center"},ze={class:"card-body"},Ye={class:"input-group"},Ze=["onUpdate:modelValue"],el=["onClick"],ll={key:0,class:"text-muted text-center py-3 mb-0"};function al(e,l,a,n,s,i){return(0,t.uX)(),(0,t.CE)("div",null,[n.isModuleEnabled("basicInfo")?((0,t.uX)(),(0,t.CE)("div",ue,[l[12]||(l[12]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"â„¹ï¸ åŸºæœ¬ä¿¡æ¯")],-1)),(0,t.Lk)("div",ce,[(0,t.Lk)("div",me,[(0,t.Lk)("div",pe,[l[8]||(l[8]=(0,t.Lk)("label",{class:"form-label"},"å‡ºå‘åœ°",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>n.content.basicInfo.departure=e),type:"text",class:"form-control"},null,512),[[re.Jo,n.content.basicInfo.departure]])]),(0,t.Lk)("div",ve,[l[9]||(l[9]=(0,t.Lk)("label",{class:"form-label"},"ç›®çš„åœ°",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>n.content.basicInfo.destination=e),type:"text",class:"form-control"},null,512),[[re.Jo,n.content.basicInfo.destination]])]),(0,t.Lk)("div",be,[l[10]||(l[10]=(0,t.Lk)("label",{class:"form-label"},"äº¤é€šæ–¹å¼",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>n.content.basicInfo.transport=e),type:"text",class:"form-control",placeholder:"ä¾‹å¦‚ï¼šé«˜é“å¾€è¿”"},null,512),[[re.Jo,n.content.basicInfo.transport]])]),(0,t.Lk)("div",ke,[l[11]||(l[11]=(0,t.Lk)("label",{class:"form-label"},"ä½å®¿å®‰æŽ’",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>n.content.basicInfo.accommodation=e),type:"text",class:"form-control"},null,512),[[re.Jo,n.content.basicInfo.accommodation]])])])])])):(0,t.Q3)("",!0),n.isModuleEnabled("highlights")?((0,t.uX)(),(0,t.CE)("div",ge,[(0,t.Lk)("div",Le,[l[13]||(l[13]=(0,t.Lk)("h5",{class:"mb-0"},"âœ¨ è¡Œç¨‹äº®ç‚¹",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[4]||(l[4]=(...e)=>n.addHighlight&&n.addHighlight(...e))}," âž• æ·»åŠ  ")]),(0,t.Lk)("div",fe,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.content.highlights,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"mb-3"},[(0,t.Lk)("div",he,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":e=>n.content.highlights[l]=e,type:"text",class:"form-control",placeholder:"ä¾‹å¦‚ï¼šðŸ–ï¸ åŽ¦é—¨æ¤ç‰©å›­ - çƒ­å¸¦é›¨æž—å¥‡è§‚"},null,8,ye),[[re.Jo,n.content.highlights[l]]]),(0,t.Lk)("button",{class:"btn btn-outline-danger",onClick:e=>n.removeHighlight(l),title:"åˆ é™¤"}," ðŸ—‘ï¸ ",8,Ve)])]))),128)),0===n.content.highlights.length?((0,t.uX)(),(0,t.CE)("p",Ce,' æš‚æ— äº®ç‚¹ï¼Œç‚¹å‡»ä¸Šæ–¹"æ·»åŠ "æŒ‰é’® ')):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0),n.isModuleEnabled("itinerary")?((0,t.uX)(),(0,t.CE)("div",we,[(0,t.Lk)("div",Ee,[l[14]||(l[14]=(0,t.Lk)("h5",{class:"mb-0"},"ðŸ“… è¯¦ç»†è¡Œç¨‹",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[5]||(l[5]=(...e)=>n.addItinerary&&n.addItinerary(...e))}," âž• æ·»åŠ ä¸€å¤© ")]),(0,t.Lk)("div",_e,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.content.itinerary,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"itinerary-item mb-4"},[(0,t.Lk)("div",Ie,[(0,t.Lk)("h6",null,"ç¬¬"+(0,o.v_)(l+1)+"å¤©",1),(0,t.Lk)("button",{class:"btn btn-sm btn-outline-danger",onClick:e=>n.removeItinerary(l),title:"åˆ é™¤"}," ðŸ—‘ï¸ ",8,xe)]),(0,t.Lk)("div",Xe,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.day=l,type:"text",class:"form-control form-control-sm",placeholder:"ä¾‹å¦‚ï¼šç¬¬ä¸€å¤©ï¼ˆ6æœˆ22æ—¥ï¼‰"},null,8,Me),[[re.Jo,e.day]])]),(0,t.Lk)("div",Te,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.time=l,type:"text",class:"form-control form-control-sm",placeholder:"ä¾‹å¦‚ï¼š09:00-18:00"},null,8,Ue),[[re.Jo,e.time]])]),(0,t.Lk)("div",Pe,[(0,t.bo)((0,t.Lk)("textarea",{"onUpdate:modelValue":l=>e.content=l,class:"form-control form-control-sm",rows:"3",placeholder:"è¯¦ç»†çš„è¡Œç¨‹å®‰æŽ’..."},null,8,Ae),[[re.Jo,e.content]])]),(0,t.Lk)("div",null,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.highlight=l,type:"text",class:"form-control form-control-sm",placeholder:"ä¾‹å¦‚ï¼šðŸ–ï¸ æµ·æ»©ç¾Žæ™¯"},null,8,$e),[[re.Jo,e.highlight]])])]))),128)),0===n.content.itinerary.length?((0,t.uX)(),(0,t.CE)("p",Fe,' æš‚æ— è¡Œç¨‹ï¼Œç‚¹å‡»ä¸Šæ–¹"æ·»åŠ ä¸€å¤©"æŒ‰é’®å¼€å§‹è§„åˆ’ ')):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0),n.isModuleEnabled("budget")?((0,t.uX)(),(0,t.CE)("div",We,[(0,t.Lk)("div",Be,[l[15]||(l[15]=(0,t.Lk)("h5",{class:"mb-0"},"ðŸ’° é¢„ç®—å‚è€ƒ",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[6]||(l[6]=(...e)=>n.addBudgetItem&&n.addBudgetItem(...e))}," âž• æ·»åŠ  ")]),(0,t.Lk)("div",De,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.content.budget.items,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"row mb-3"},[(0,t.Lk)("div",Qe,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.name=l,type:"text",class:"form-control form-control-sm",placeholder:"é¡¹ç›®åç§°"},null,8,Je),[[re.Jo,e.name]])]),(0,t.Lk)("div",Ke,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.amount=l,type:"number",class:"form-control form-control-sm",placeholder:"é‡‘é¢"},null,8,je),[[re.Jo,e.amount,void 0,{number:!0}]])]),(0,t.Lk)("div",Se,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.note=l,type:"text",class:"form-control form-control-sm",placeholder:"å¤‡æ³¨"},null,8,Ne),[[re.Jo,e.note]])]),(0,t.Lk)("div",qe,[(0,t.Lk)("button",{class:"btn btn-sm btn-outline-danger w-100",onClick:e=>n.removeBudgetItem(l),title:"åˆ é™¤"}," ðŸ—‘ï¸ ",8,Oe)])]))),128)),n.content.budget.items.length>0?((0,t.uX)(),(0,t.CE)("div",Re,[l[16]||(l[16]=(0,t.Lk)("strong",null,"æ€»è®¡ï¼š",-1)),(0,t.eW)("Â¥"+(0,o.v_)(n.budgetTotal),1)])):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0),n.isModuleEnabled("tips")?((0,t.uX)(),(0,t.CE)("div",He,[(0,t.Lk)("div",Ge,[l[17]||(l[17]=(0,t.Lk)("h5",{class:"mb-0"},"ðŸ’¡ å®žç”¨æç¤º",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[7]||(l[7]=(...e)=>n.addTip&&n.addTip(...e))}," âž• æ·»åŠ  ")]),(0,t.Lk)("div",ze,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.content.tips,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"mb-3"},[(0,t.Lk)("div",Ye,[(0,t.bo)((0,t.Lk)("textarea",{"onUpdate:modelValue":e=>n.content.tips[l]=e,class:"form-control",rows:"2",placeholder:"è¾“å…¥ä¸€æ¡å®žç”¨æç¤º..."},null,8,Ze),[[re.Jo,n.content.tips[l]]]),(0,t.Lk)("button",{class:"btn btn-outline-danger",onClick:e=>n.removeTip(l),title:"åˆ é™¤"}," ðŸ—‘ï¸ ",8,el)])]))),128)),0===n.content.tips.length?((0,t.uX)(),(0,t.CE)("p",ll,' æš‚æ— æç¤ºï¼Œç‚¹å‡»ä¸Šæ–¹"æ·»åŠ "æŒ‰é’® ')):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0)])}var tl={name:"ContentEditor",props:{modelValue:{type:Object,required:!0},enabledModules:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:l}){const a=(0,t.EW)({get:()=>e.modelValue,set:e=>l("update:modelValue",e)}),o=l=>e.enabledModules.includes(l),n=(0,t.EW)(()=>a.value.budget.items.reduce((e,l)=>e+(l.amount||0),0)),s=()=>{a.value.highlights.push("")},i=e=>{a.value.highlights.splice(e,1)},d=()=>{a.value.itinerary.push({day:"",time:"",content:"",highlight:""})},r=e=>{a.value.itinerary.splice(e,1)},u=()=>{a.value.budget.items.push({name:"",amount:0,note:""})},c=e=>{a.value.budget.items.splice(e,1)},m=()=>{a.value.tips.push("")},p=e=>{a.value.tips.splice(e,1)};return{content:a,isModuleEnabled:o,budgetTotal:n,addHighlight:s,removeHighlight:i,addItinerary:d,removeItinerary:r,addBudgetItem:u,removeBudgetItem:c,addTip:m,removeTip:p}}};const ol=(0,q.A)(tl,[["render",al],["__scopeId","data-v-10fbffd8"]]);var nl=ol;const sl={class:"card mb-4 sticky-top",style:{top:"140px"}},il={class:"card-body"},dl={class:"mb-3"},rl=["value"],ul={class:"mb-3"},cl=["value"],ml={class:"mb-3"},pl={class:"color-picker"},vl=["value"],bl={class:"mb-3"},kl=["value"],gl={class:"mt-2 d-flex align-items-center gap-2"},Ll=["disabled"],fl={key:0,class:"text-muted"},hl=["src"],yl={class:"mb-3"},Vl=["value"],Cl={class:"info-stats mt-4"},wl={key:0,class:"stat-item"},El={class:"value"},_l={key:1,class:"stat-item"},Il={class:"value"},xl={key:2,class:"stat-item"},Xl={class:"value"};function Ml(e,l,a,n,s,i){return(0,t.uX)(),(0,t.CE)("div",sl,[l[21]||(l[21]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"âš™ï¸ è®¾ç½®")],-1)),(0,t.Lk)("div",il,[(0,t.Lk)("div",dl,[l[7]||(l[7]=(0,t.Lk)("label",{class:"form-label"},"çŠ¶æ€",-1)),(0,t.Lk)("select",{value:a.modelValue.status,onChange:l[0]||(l[0]=l=>e.$emit("update:modelValue",{...a.modelValue,status:l.target.value})),class:"form-select"},[...l[6]||(l[6]=[(0,t.Lk)("option",{value:"draft"},"è‰ç¨¿",-1),(0,t.Lk)("option",{value:"published"},"å·²å‘å¸ƒ",-1)])],40,rl)]),(0,t.Lk)("div",ul,[l[9]||(l[9]=(0,t.Lk)("label",{class:"form-label"},"å¯è§æ€§",-1)),(0,t.Lk)("select",{value:a.modelValue.visibility,onChange:l[1]||(l[1]=l=>e.$emit("update:modelValue",{...a.modelValue,visibility:l.target.value})),class:"form-select"},[...l[8]||(l[8]=[(0,t.Lk)("option",{value:"private"},"ç§æœ‰",-1),(0,t.Lk)("option",{value:"public"},"å…¬å¼€",-1)])],40,cl),l[10]||(l[10]=(0,t.Lk)("small",{class:"text-muted"},"å…¬å¼€åŽå…¶ä»–äººå¯ä»¥çœ‹åˆ°ä½ çš„æ—…è¡Œè®¡åˆ’",-1))]),(0,t.Lk)("div",ml,[l[11]||(l[11]=(0,t.Lk)("label",{class:"form-label"},"ðŸŽ¨ ä¸»é¢˜è‰²",-1)),(0,t.Lk)("div",pl,[(0,t.Lk)("input",{type:"color",value:a.modelValue.theme_color||"#f0e68c",onInput:l[2]||(l[2]=l=>e.$emit("update:modelValue",{...a.modelValue,theme_color:l.target.value})),class:"form-control form-control-color"},null,40,vl),(0,t.Lk)("div",{class:"color-preview",style:(0,o.Tr)({background:a.modelValue.theme_color||"#f0e68c"})},null,4)]),l[12]||(l[12]=(0,t.Lk)("small",{class:"text-muted"},"é€‰æ‹©å¡ç‰‡å¤´éƒ¨çš„èƒŒæ™¯è‰²",-1))]),(0,t.Lk)("div",bl,[l[14]||(l[14]=(0,t.Lk)("label",{class:"form-label"},"ðŸŽµ èƒŒæ™¯éŸ³ä¹",-1)),(0,t.Lk)("select",{value:a.modelValue.background_music,onChange:l[3]||(l[3]=l=>e.$emit("update:modelValue",{...a.modelValue,background_music:l.target.value})),class:"form-select"},[...l[13]||(l[13]=[(0,t.Lk)("option",{value:""},"æ— èƒŒæ™¯éŸ³ä¹",-1),(0,t.Lk)("option",{value:"/static/music/rain.mp3"},"BGM 1",-1),(0,t.Lk)("option",{value:"/static/music/road.mp3"},"BGM 2",-1),(0,t.Lk)("option",{value:"/static/music/windy.mp3"},"BGM 3",-1)])],40,kl),l[15]||(l[15]=(0,t.Lk)("small",{class:"text-muted"},"é€‰æ‹©é€‚åˆæ—…è¡Œåœºæ™¯çš„èƒŒæ™¯éŸ³ä¹",-1)),(0,t.Lk)("div",gl,[(0,t.Lk)("button",{type:"button",class:"btn btn-sm btn-outline-primary",disabled:!n.hasMusic,onClick:l[4]||(l[4]=(...e)=>n.togglePreview&&n.togglePreview(...e))},(0,o.v_)(n.isPreviewPlaying?"æš‚åœé¢„è§ˆ":"é¢„è§ˆæ’­æ”¾"),9,Ll),n.hasMusic?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("small",fl,"æœªé€‰æ‹©éŸ³ä¹"))]),(0,t.Lk)("audio",{ref:"previewAudio",src:a.modelValue.background_music||"",preload:"auto"},null,8,hl)]),(0,t.Lk)("div",yl,[l[16]||(l[16]=(0,t.Lk)("label",{class:"form-label"},"ðŸ“ å›¾æ ‡",-1)),(0,t.Lk)("input",{type:"text",value:a.modelValue.icon,onInput:l[5]||(l[5]=l=>e.$emit("update:modelValue",{...a.modelValue,icon:l.target.value})),class:"form-control",placeholder:"ä¾‹å¦‚ï¼šðŸ—ºï¸"},null,40,Vl),l[17]||(l[17]=(0,t.Lk)("small",{class:"text-muted"},"ä½¿ç”¨emojiè¡¨æƒ…",-1))]),(0,t.Lk)("div",Cl,[a.modelValue.created_at?((0,t.uX)(),(0,t.CE)("div",wl,[l[18]||(l[18]=(0,t.Lk)("span",{class:"label"},"åˆ›å»ºæ—¶é—´",-1)),(0,t.Lk)("span",El,(0,o.v_)(n.formatDate(a.modelValue.created_at)),1)])):(0,t.Q3)("",!0),a.modelValue.updated_at?((0,t.uX)(),(0,t.CE)("div",_l,[l[19]||(l[19]=(0,t.Lk)("span",{class:"label"},"æ›´æ–°æ—¶é—´",-1)),(0,t.Lk)("span",Il,(0,o.v_)(n.formatDate(a.modelValue.updated_at)),1)])):(0,t.Q3)("",!0),a.daysCount>0?((0,t.uX)(),(0,t.CE)("div",xl,[l[20]||(l[20]=(0,t.Lk)("span",{class:"label"},"æ—…è¡Œå¤©æ•°",-1)),(0,t.Lk)("span",Xl,(0,o.v_)(a.daysCount)+"å¤©",1)])):(0,t.Q3)("",!0)])])])}var Tl={name:"EditorSidebar",props:{modelValue:{type:Object,required:!0},daysCount:{type:Number,default:0}},emits:["update:modelValue"],setup(e){const l=e=>{if(!e)return"æš‚æ— ";const l=new Date(e);return l.toLocaleString("zh-CN")},a=(0,V.KR)(null),o=(0,V.KR)(!1),n=(0,t.EW)(()=>!!e.modelValue.background_music),s=()=>{if(a.value){try{a.value.pause()}catch(e){}o.value=!1}},i=()=>{n.value&&a.value&&(o.value?(a.value.pause(),o.value=!1):(a.value.currentTime=0,a.value.volume=.2,a.value.play().then(()=>{o.value=!0}).catch(()=>null)))};(0,t.wB)(()=>e.modelValue.background_music,()=>{if(s(),a.value)try{a.value.load()}catch(e){}});const d=()=>{a.value&&(a.value.addEventListener("ended",()=>{o.value=!1}),a.value.addEventListener("pause",()=>{o.value=!1}),a.value.addEventListener("play",()=>{a.value.volume=.2,o.value=!0}))};return setTimeout(d,0),{formatDate:l,previewAudio:a,isPreviewPlaying:o,hasMusic:n,togglePreview:i}}};const Ul=(0,q.A)(Tl,[["render",Ml],["__scopeId","data-v-0b0fb731"]]);var Pl=Ul,Al={name:"TripEditorView",components:{NavBar:_.A,BasicInfoEditor:R,ModuleSelector:de,ContentEditor:nl,EditorSidebar:Pl},setup(){const e=(0,C.lq)(),l=(0,C.rd)(),a=(0,w.k)(),o=(0,V.KR)(!1),n=(0,V.KR)(!1),s=[{id:"basicInfo",name:"åŸºæœ¬ä¿¡æ¯",icon:"â„¹ï¸",description:"å‡ºå‘åœ°ã€ç›®çš„åœ°ç­‰"},{id:"highlights",name:"è¡Œç¨‹äº®ç‚¹",icon:"âœ¨",description:"ä¸»è¦æ™¯ç‚¹å’Œæ´»åŠ¨"},{id:"itinerary",name:"è¯¦ç»†è¡Œç¨‹",icon:"ðŸ“…",description:"æ¯æ—¥å®‰æŽ’"},{id:"budget",name:"é¢„ç®—å‚è€ƒ",icon:"ðŸ’°",description:"è´¹ç”¨æ˜Žç»†"},{id:"tips",name:"å®žç”¨æç¤º",icon:"ðŸ’¡",description:"æ³¨æ„äº‹é¡¹"}],i=(0,V.KR)({title:"",description:"",icon:"ðŸ—ºï¸",start_date:null,end_date:null,status:"draft",visibility:"private",theme_color:"#f0e68c",background_music:"",config:{enabledModules:["basicInfo","highlights"]},overview:{basicInfo:{departure:"",destination:"",transport:"",accommodation:"",participants:""},highlights:[],itinerary:[],budget:{items:[],total:0},tips:[]},created_at:null,updated_at:null}),d=(0,t.EW)(()=>{const l=e.params.slug;return l&&"new"!==l}),r=(0,t.EW)(()=>i.value.title&&i.value.title.trim().length>0),u=(0,t.EW)(()=>{if(!i.value.start_date||!i.value.end_date)return 0;const e=new Date(i.value.start_date),l=new Date(i.value.end_date);return Math.ceil((l-e)/864e5)+1}),c=e=>{const l=i.value.config.enabledModules.indexOf(e);l>-1?i.value.config.enabledModules.splice(l,1):i.value.config.enabledModules.push(e)},m=async()=>{if(r.value){o.value=!0;try{if(i.value.overview.budget.total=i.value.overview.budget.items.reduce((e,l)=>e+(l.amount||0),0),d.value)await(0,E.updateTripPlan)(e.params.slug,i.value),alert("ä¿å­˜æˆåŠŸï¼");else{const e=await(0,E.createTripPlan)(i.value);alert("åˆ›å»ºæˆåŠŸï¼"),l.push(`/editor/${e.slug}`)}}catch(a){console.error("ä¿å­˜å¤±è´¥:",a),alert("ä¿å­˜å¤±è´¥ï¼š"+(a.response?.data?.detail||a.message))}finally{o.value=!1}}else alert("è¯·è‡³å°‘å¡«å†™æ ‡é¢˜")},p=async()=>{if(!r.value)return void alert("è¯·è‡³å°‘å¡«å†™æ ‡é¢˜");const a="public"===i.value.visibility,t=a?"ç¡®å®šè¦å‘å¸ƒè¿™ä¸ªæ—…è¡Œè®¡åˆ’å—ï¼Ÿå‘å¸ƒåŽå°†å¯è¢«è®¿é—®ã€‚":"ç¡®å®šè¦å‘å¸ƒè¿™ä¸ªæ—…è¡Œè®¡åˆ’å—ï¼Ÿå®ƒå°†ä¿æŒç§æœ‰ï¼Œä»…è‡ªå·±å¯è§ã€‚";if(confirm(t)){n.value=!0;try{if(i.value.status="published",i.value.overview.budget.total=i.value.overview.budget.items.reduce((e,l)=>e+(l.amount||0),0),d.value)await(0,E.updateTripPlan)(e.params.slug,i.value);else{const e=await(0,E.createTripPlan)(i.value);l.push(`/editor/${e.slug}`)}alert("å‘å¸ƒæˆåŠŸï¼")}catch(o){console.error("å‘å¸ƒå¤±è´¥:",o),alert("å‘å¸ƒå¤±è´¥ï¼š"+(o.response?.data?.detail||o.message))}finally{n.value=!1}}},v=()=>{confirm("ç¡®å®šè¦ç¦»å¼€å—ï¼Ÿæœªä¿å­˜çš„æ›´æ”¹å°†ä¸¢å¤±ã€‚")&&l.push("/my-trips")},b=async()=>{const t=e.params.slug;if(!t||"new"===t){const e=a.userInfo?.profile?.nickname||a.username||"";return void(e&&(i.value.overview.basicInfo.participants=e))}try{const e=await(0,E.getTripPlan)(t);i.value={...i.value,...e,overview:e.overview||i.value.overview,config:e.config||i.value.config};const l=a.userInfo?.profile?.nickname||a.username||"";l&&!i.value.overview.basicInfo?.participants&&(i.value.overview.basicInfo.participants=l)}catch(o){console.error("åŠ è½½å¤±è´¥:",o),alert("åŠ è½½æ—…è¡Œè®¡åˆ’å¤±è´¥"),l.push("/my-trips")}};return(0,t.sV)(()=>{if(!a.isLoggedIn)return alert("è¯·å…ˆç™»å½•"),void l.push("/login");b()}),{tripData:i,saving:o,publishing:n,isEditMode:d,canPublish:r,daysCount:u,availableModules:s,toggleModule:c,handleSave:m,handlePublish:p,goBack:v}}};const $l=(0,q.A)(Al,[["render",y],["__scopeId","data-v-0023f298"]]);var Fl=$l},7682:function(e,l,a){a.r(l),a.d(l,{addTripToTree:function(){return p},cloneTripPlan:function(){return r},createTripPlan:function(){return s},deleteTripPlan:function(){return d},getMyTrips:function(){return o},getTripPlan:function(){return n},makePrivate:function(){return m},makePublic:function(){return c},publishTripPlan:function(){return u},removeTripFromTree:function(){return v},updateTripPlan:function(){return i}});var t=a(7277);const o=e=>t.A.get("/trip-plans/my_trips/",{params:e}),n=e=>t.A.get(`/trip-plans/${e}/`),s=e=>t.A.post("/trip-plans/",e),i=(e,l)=>t.A.patch(`/trip-plans/${e}/`,l),d=e=>t.A.delete(`/trip-plans/${e}/`),r=e=>t.A.post(`/trip-plans/${e}/clone/`),u=e=>i(e,{status:"published"}),c=e=>i(e,{visibility:"public"}),m=e=>i(e,{visibility:"private"}),p=e=>t.A.post(`/trip-plans/${e}/add_to_tree/`),v=e=>t.A.post(`/trip-plans/${e}/remove_from_tree/`)}}]);
//# sourceMappingURL=322.bcecdc79.js.map