"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[100],{946:function(e,a,s){e.exports=s.p+"assets/img/qq_logo.666e5ea1.png"},6100:function(e,a,s){s.r(a),s.d(a,{default:function(){return R}});var r=s(6768),n=s(5130),o=s(4232),t=s(946);const l={class:"login-container"},i={class:"container"},d={class:"row justify-content-center"},c={class:"col-md-6 col-lg-4"},u={class:"card shadow-lg"},m={class:"card-body p-5"},p={class:"mb-3"},b={class:"mb-3"},v={class:"d-flex justify-content-between align-items-center mb-2"},g={key:0,class:"alert alert-danger",role:"alert"},k=["disabled"],L={key:0,class:"spinner-border spinner-border-sm me-2"},f={class:"text-center mb-3"},y=["disabled"],w={key:0},h={key:1},_={class:"text-center"};function q(e,a,s,q,Q,x){const C=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",i,[(0,r.Lk)("div",d,[(0,r.Lk)("div",c,[(0,r.Lk)("div",u,[(0,r.Lk)("div",m,[a[11]||(a[11]=(0,r.Lk)("h2",{class:"text-center mb-4"},"用户登录",-1)),(0,r.Lk)("form",{onSubmit:a[3]||(a[3]=(0,n.D$)((...e)=>q.handleLogin&&q.handleLogin(...e),["prevent"]))},[(0,r.Lk)("div",p,[a[4]||(a[4]=(0,r.Lk)("label",{for:"username",class:"form-label"},"用户名",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":a[0]||(a[0]=e=>q.form.username=e),required:"",placeholder:"请输入用户名"},null,512),[[n.Jo,q.form.username]])]),(0,r.Lk)("div",b,[(0,r.Lk)("div",v,[a[6]||(a[6]=(0,r.Lk)("label",{for:"password",class:"form-label mb-0"},"密码",-1)),(0,r.bF)(C,{to:"/forgot-password/",class:"text-decoration-none small text-primary"},{default:(0,r.k6)(()=>[...a[5]||(a[5]=[(0,r.eW)(" 忘记密码？ ",-1)])]),_:1})]),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":a[1]||(a[1]=e=>q.form.password=e),required:"",placeholder:"请输入密码"},null,512),[[n.Jo,q.form.password]])]),q.error?((0,r.uX)(),(0,r.CE)("div",g,(0,o.v_)(q.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary w-100 mb-3",disabled:q.loading},[q.loading?((0,r.uX)(),(0,r.CE)("span",L)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,o.v_)(q.loading?"登录中...":"登录"),1)],8,k),(0,r.Lk)("div",f,[a[8]||(a[8]=(0,r.Lk)("div",{class:"divider"},[(0,r.Lk)("span",{class:"divider-text"},"或")],-1)),(0,r.Lk)("button",{type:"button",class:"btn btn-outline-secondary w-100 qq-login-btn",disabled:q.qqLoginLoading,onClick:a[2]||(a[2]=(...e)=>q.handleQQLogin&&q.handleQQLogin(...e))},[a[7]||(a[7]=(0,r.Lk)("img",{src:t,alt:"QQ登录",class:"qq-login-icon",width:"20",height:"20"},null,-1)),q.qqLoginLoading?((0,r.uX)(),(0,r.CE)("span",w,"跳转中...")):((0,r.uX)(),(0,r.CE)("span",h,"使用QQ登录"))],8,y)]),(0,r.Lk)("div",_,[a[10]||(a[10]=(0,r.Lk)("span",{class:"text-muted"},"还没有账号？",-1)),(0,r.bF)(C,{to:"/register",class:"text-decoration-none"},{default:(0,r.k6)(()=>[...a[9]||(a[9]=[(0,r.eW)("立即注册",-1)])]),_:1})])],32)])])])])])])}s(4114);var Q=s(144),x=s(8512),C=s(3459),A=s(2636),E={name:"LoginView",setup(){const e=(0,x.rd)(),a=(0,C.k)(),s=(0,Q.KR)({username:"",password:""}),r=(0,Q.KR)(!1),n=(0,Q.KR)(""),o=(0,Q.KR)(!1),t=async()=>{r.value=!0,n.value="";try{await a.login(s.value),e.push("/")}catch(o){if(o.response?.data){const e=o.response.data;e.username&&Array.isArray(e.username)?n.value=e.username[0]:e.password&&Array.isArray(e.password)?n.value=e.password[0]:e.non_field_errors&&Array.isArray(e.non_field_errors)?n.value=e.non_field_errors[0]:"string"===typeof e?n.value=e:e.detail?n.value=e.detail:n.value="登录失败，请检查用户名和密码"}else n.value=o.message||"登录失败，请检查用户名和密码"}finally{r.value=!1}},l=async()=>{o.value=!0;try{const e=await(0,A.jg)();e.authorize_url&&e.state?(sessionStorage.setItem("qq_oauth_state",e.state),window.location.href=e.authorize_url):(n.value="获取QQ登录链接失败，请重试",o.value=!1)}catch(e){n.value=e.response?.data?.error||"QQ登录失败，请重试",o.value=!1}};return{form:s,loading:r,error:n,qqLoginLoading:o,handleLogin:t,handleQQLogin:l}}},X=s(1241);const K=(0,X.A)(E,[["render",q],["__scopeId","data-v-b7de2e5c"]]);var R=K}}]);
//# sourceMappingURL=100.65b18c78.js.map