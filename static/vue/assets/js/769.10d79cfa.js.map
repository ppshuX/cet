{"version":3,"file":"assets/js/769.10d79cfa.js","mappings":"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","sources":["webpack://roamio-web/./src/views/auth/LoginView.vue","webpack://roamio-web/./src/views/auth/LoginView.vue?4511"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <div class=\"container\">\n      <div class=\"row justify-content-center\">\n        <div class=\"col-md-6 col-lg-4\">\n          <div class=\"card shadow-lg\">\n            <div class=\"card-body p-5\">\n              <h2 class=\"text-center mb-2\">用户登录</h2>\n              <p class=\"login-slogan text-center mb-4\">Hello Roamioer!</p>\n              \n              <form @submit.prevent=\"handleLogin\">\n                <!-- 用户名 -->\n                <div class=\"mb-3\">\n                  <label for=\"username\" class=\"form-label\">用户名</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"username\"\n                    v-model=\"form.username\"\n                    required\n                    placeholder=\"请输入用户名\"\n                  />\n                </div>\n                \n                <!-- 密码 -->\n                <div class=\"mb-3\">\n                  <label for=\"password\" class=\"form-label\">密码</label>\n                  <input\n                    type=\"password\"\n                    class=\"form-control\"\n                    id=\"password\"\n                    v-model=\"form.password\"\n                    required\n                    placeholder=\"请输入密码\"\n                  />\n                </div>\n                \n                <!-- 错误提示 -->\n                <div v-if=\"error\" class=\"alert alert-danger\" role=\"alert\">\n                  {{ error }}\n                </div>\n                \n                <!-- 登录按钮 -->\n                <button\n                  type=\"submit\"\n                  class=\"btn btn-primary w-100 mb-2\"\n                  :disabled=\"loading\"\n                >\n                  <span v-if=\"loading\" class=\"spinner-border spinner-border-sm me-2\"></span>\n                  {{ loading ? '登录中...' : '登录' }}\n                </button>\n                \n                <!-- 忘记密码 -->\n                <div class=\"text-end mb-3\">\n                  <router-link to=\"/forgot-password/\" class=\"text-decoration-none small text-primary\">\n                    忘记密码？\n                  </router-link>\n                </div>\n                \n                <!-- QQ登录 -->\n                <div class=\"text-center mb-3\">\n                  <div class=\"divider\">\n                    <span class=\"divider-text\">或</span>\n                  </div>\n                  <button\n                    type=\"button\"\n                    class=\"btn btn-outline-secondary w-100 qq-login-btn\"\n                    :disabled=\"qqLoginLoading\"\n                    @click=\"handleQQLogin\"\n                  >\n                    <img src=\"@/assets/qq_logo.png\" alt=\"QQ登录\" class=\"qq-login-icon\" width=\"20\" height=\"20\">\n                    <span v-if=\"qqLoginLoading\">跳转中...</span>\n                    <span v-else>使用QQ登录</span>\n                  </button>\n                </div>\n                \n                <!-- 注册链接 -->\n                <div class=\"text-center\">\n                  <span class=\"text-muted\">还没有账号？</span>\n                  <router-link to=\"/register\" class=\"text-decoration-none\">立即注册</router-link>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useUserStore } from '@/stores'\nimport { getQQLoginUrl } from '@/api/auth'\n\nexport default {\n  name: 'LoginView',\n  \n  setup() {\n    const router = useRouter()\n    const userStore = useUserStore()\n    \n    const form = ref({\n      username: '',\n      password: ''\n    })\n    \n    const loading = ref(false)\n    const error = ref('')\n    const qqLoginLoading = ref(false)\n    \n    const handleLogin = async () => {\n      loading.value = true\n      error.value = ''\n      \n      try {\n        await userStore.login(form.value)\n        \n        // 登录成功，跳转到首页\n        router.push('/')\n      } catch (err) {\n        // 优先显示API返回的中文错误信息\n        if (err.response?.data) {\n          const data = err.response.data\n          \n          // 处理字段错误\n          if (data.username && Array.isArray(data.username)) {\n            error.value = data.username[0]\n          } else if (data.password && Array.isArray(data.password)) {\n            error.value = data.password[0]\n          } else if (data.non_field_errors && Array.isArray(data.non_field_errors)) {\n            error.value = data.non_field_errors[0]\n          } else if (typeof data === 'string') {\n            error.value = data\n          } else if (data.detail) {\n            error.value = data.detail\n          } else {\n            error.value = '登录失败，请检查用户名和密码'\n          }\n        } else {\n          error.value = err.message || '登录失败，请检查用户名和密码'\n        }\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    const handleQQLogin = async () => {\n      qqLoginLoading.value = true\n      try {\n        const response = await getQQLoginUrl()\n        if (response.authorize_url && response.state) {\n          // 保存state到sessionStorage用于验证\n          sessionStorage.setItem('qq_oauth_state', response.state)\n          // 跳转到QQ授权页面\n          window.location.href = response.authorize_url\n        } else {\n          error.value = '获取QQ登录链接失败，请重试'\n          qqLoginLoading.value = false\n        }\n      } catch (err) {\n        error.value = err.response?.data?.error || 'QQ登录失败，请重试'\n        qqLoginLoading.value = false\n      }\n    }\n    \n    return {\n      form,\n      loading,\n      error,\n      qqLoginLoading,\n      handleLogin,\n      handleQQLogin\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  min-height: 100vh;\n  display: flex;\n  align-items: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n}\n\n.card {\n  border: none;\n  border-radius: 15px;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border: none;\n}\n\n.btn-primary:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.login-slogan {\n  color: #6c63ff;\n  font-weight: 600;\n  letter-spacing: 0.5px;\n  text-shadow: 0 2px 8px rgba(108, 99, 255, 0.25);\n}\n\n.divider {\n  position: relative;\n  text-align: center;\n  margin: 20px 0;\n}\n\n.divider::before,\n.divider::after {\n  content: '';\n  position: absolute;\n  top: 50%;\n  width: 45%;\n  height: 1px;\n  background: #dee2e6;\n}\n\n.divider::before {\n  left: 0;\n}\n\n.divider::after {\n  right: 0;\n}\n\n.divider-text {\n  background: white;\n  padding: 0 10px;\n  color: #6c757d;\n  font-size: 14px;\n}\n\n.qq-login-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  padding: 10px;\n  border: 1px solid #dee2e6;\n  transition: all 0.3s ease;\n}\n\n.qq-login-btn:hover {\n  background-color: #f8f9fa;\n  border-color: #adb5bd;\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.qq-login-icon {\n  margin-right: 5px;\n}\n</style>\n\n","import { render } from \"./LoginView.vue?vue&type=template&id=4d263550&scoped=true\"\nimport script from \"./LoginView.vue?vue&type=script&lang=js\"\nexport * from \"./LoginView.vue?vue&type=script&lang=js\"\n\nimport \"./LoginView.vue?vue&type=style&index=0&id=4d263550&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4d263550\"]])\n\nexport default __exports__"],"names":["class","role","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","onSubmit","_cache","_withModifiers","args","$setup","handleLogin","_hoisted_7","for","type","id","form","username","$event","required","placeholder","_hoisted_8","password","error","_hoisted_9","_toDisplayString","disabled","loading","_hoisted_11","_hoisted_12","_createVNode","_component_router_link","to","_hoisted_13","qqLoginLoading","onClick","handleQQLogin","src","_imports_0","alt","width","height","_hoisted_15","_hoisted_16","_hoisted_17","name","setup","router","useRouter","userStore","useUserStore","ref","async","value","login","push","err","response","data","Array","isArray","non_field_errors","detail","message","getQQLoginUrl","authorize_url","state","sessionStorage","setItem","window","location","href","__exports__","render"],"sourceRoot":""}