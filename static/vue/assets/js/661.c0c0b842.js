"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[661],{5824:function(t,e,a){a.d(e,{A:function(){return _}});var s=a(6768),n=a(4232),l=a(5130);const i={class:"navbar navbar-expand-lg navbar-dark bg-primary shadow-sm sticky-top"},r={class:"container-fluid"},o={class:"collapse navbar-collapse",id:"navbarNav",style:{overflow:"visible"}},c={class:"navbar-nav me-auto"},d={class:"nav-item"},u={class:"nav-item"},b={class:"d-flex align-items-center"},p={key:0,class:"dropdown dropdown-end"},k={href:"#",class:"d-flex align-items-center text-white text-decoration-none dropdown-toggle user-dropdown-btn",id:"dropdownUser","data-bs-toggle":"dropdown","aria-expanded":"false"},v=["src"],m={class:"dropdown-menu dropdown-menu-end text-small","aria-labelledby":"dropdownUser"};function L(t,e,a,L,g,f){const y=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("nav",i,[(0,s.Lk)("div",r,[(0,s.bF)(y,{to:"/",class:"navbar-brand"},{default:(0,s.k6)(()=>[...e[1]||(e[1]=[(0,s.Lk)("span",{class:"brand-text"},"Roamio",-1)])]),_:1}),e[9]||(e[9]=(0,s.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[(0,s.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,s.Lk)("div",o,[(0,s.Lk)("ul",c,[(0,s.Lk)("li",d,[(0,s.bF)(y,{to:"/",class:"nav-link"},{default:(0,s.k6)(()=>[...e[2]||(e[2]=[(0,s.Lk)("i",{class:"bi bi-house-door me-1"},null,-1),(0,s.eW)(" æ—…è¡Œåˆ—è¡¨ ",-1)])]),_:1})]),(0,s.Lk)("li",u,[(0,s.bF)(y,{to:"/my-trips",class:"nav-link"},{default:(0,s.k6)(()=>[...e[3]||(e[3]=[(0,s.Lk)("i",{class:"bi bi-folder me-1"},null,-1),(0,s.eW)(" æˆ‘çš„æ—…è¡Œ ",-1)])]),_:1})])]),(0,s.Lk)("div",b,[L.isLoggedIn?((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("a",k,[(0,s.Lk)("img",{src:L.avatar,alt:"avatar",width:"32",height:"32",class:"rounded-circle me-2"},null,8,v),(0,s.Lk)("span",null,(0,n.v_)(L.username),1)]),(0,s.Lk)("ul",m,[(0,s.Lk)("li",null,[(0,s.bF)(y,{to:"/user/center",class:"dropdown-item"},{default:(0,s.k6)(()=>[...e[4]||(e[4]=[(0,s.Lk)("i",{class:"bi bi-person me-2"},null,-1),(0,s.eW)("ä¸ªäººä¸­å¿ƒ ",-1)])]),_:1})]),e[6]||(e[6]=(0,s.Lk)("li",null,[(0,s.Lk)("hr",{class:"dropdown-divider"})],-1)),(0,s.Lk)("li",null,[(0,s.Lk)("a",{href:"#",class:"dropdown-item",onClick:e[0]||(e[0]=(0,l.D$)((...t)=>L.handleLogout&&L.handleLogout(...t),["prevent"]))},[...e[5]||(e[5]=[(0,s.Lk)("i",{class:"bi bi-box-arrow-right me-2"},null,-1),(0,s.eW)("é€€å‡ºç™»å½• ",-1)])])])])])):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.bF)(y,{to:"/login",class:"btn btn-outline-light btn-sm me-2"},{default:(0,s.k6)(()=>[...e[7]||(e[7]=[(0,s.eW)(" ç™»å½• ",-1)])]),_:1}),(0,s.bF)(y,{to:"/register",class:"btn btn-light btn-sm"},{default:(0,s.k6)(()=>[...e[8]||(e[8]=[(0,s.eW)(" æ³¨å†Œ ",-1)])]),_:1})],64))])])])])}a(4114);var g=a(8512),f=a(1516),y={name:"NavBar",setup(){const t=(0,g.rd)(),e=(0,f.k)(),a=(0,s.EW)(()=>e.isLoggedIn),n=(0,s.EW)(()=>e.username),l=(0,s.EW)(()=>e.avatar),i=async()=>{if(confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ"))try{await e.logout(),t.push("/login")}catch(a){console.error("é€€å‡ºå¤±è´¥:",a)}};return{isLoggedIn:a,username:n,avatar:l,handleLogout:i}}},w=a(1241);const h=(0,w.A)(y,[["render",L],["__scopeId","data-v-8cff0656"]]);var _=h},7661:function(t,e,a){a.r(e),a.d(e,{default:function(){return $}});var s=a(6768),n=a(4232);const l={class:"my-trips-wrapper"},i={class:"container py-5"},r={class:"d-flex justify-content-between align-items-center mb-4"},o={key:0,class:"text-center py-5"},c={key:1,class:"row"},d={class:"trip-card"},u={class:"trip-icon"},b={class:"trip-meta"},p={class:"trip-body"},k={class:"trip-title"},v={class:"trip-desc text-muted"},m={class:"trip-info"},L={class:"text-muted"},g={class:"text-muted ms-3"},f={class:"trip-actions"},y=["onClick"],w=["onClick"],h=["onClick"],_=["onClick"],C={key:2,class:"empty-state text-center py-5"};function x(t,e,a,x,W,T){const A=(0,s.g2)("NavBar");return(0,s.uX)(),(0,s.CE)("div",l,[(0,s.bF)(A),(0,s.Lk)("div",i,[(0,s.Lk)("div",r,[e[3]||(e[3]=(0,s.Lk)("h2",null,"æˆ‘çš„æ—…è¡Œè®¡åˆ’",-1)),(0,s.Lk)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...t)=>x.createNew&&x.createNew(...t))},[...e[2]||(e[2]=[(0,s.Lk)("i",{class:"bi bi-plus-circle me-2"},null,-1),(0,s.eW)("åˆ›å»ºæ–°æ—…è¡Œ ",-1)])])]),x.loading?((0,s.uX)(),(0,s.CE)("div",o,[...e[4]||(e[4]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"åŠ è½½ä¸­...")],-1)])])):x.trips.length>0?((0,s.uX)(),(0,s.CE)("div",c,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.trips,t=>((0,s.uX)(),(0,s.CE)("div",{key:t.id,class:"col-md-6 col-lg-4 mb-4"},[(0,s.Lk)("div",d,[(0,s.Lk)("div",{class:"trip-header",style:(0,n.Tr)({background:t.theme_color||"#f0e68c"})},[(0,s.Lk)("div",u,(0,n.v_)(t.icon),1),(0,s.Lk)("div",b,[(0,s.Lk)("span",{class:(0,n.C4)(["badge","published"===t.status?"bg-success":"bg-secondary"])},(0,n.v_)("published"===t.status?"å·²å‘å¸ƒ":"è‰ç¨¿"),3),(0,s.Lk)("span",{class:(0,n.C4)(["badge ms-2","public"===t.visibility?"bg-info":"bg-warning"])},(0,n.v_)("public"===t.visibility?"å…¬å¼€":"ç§æœ‰"),3)])],4),(0,s.Lk)("div",p,[(0,s.Lk)("h5",k,(0,n.v_)(t.title),1),(0,s.Lk)("p",v,(0,n.v_)(t.description||"æš‚æ— æè¿°"),1),(0,s.Lk)("div",m,[(0,s.Lk)("small",L,[e[5]||(e[5]=(0,s.Lk)("i",{class:"bi bi-calendar me-1"},null,-1)),(0,s.eW)((0,n.v_)(t.days_count||0)+"å¤© ",1)]),(0,s.Lk)("small",g,[e[6]||(e[6]=(0,s.Lk)("i",{class:"bi bi-clock me-1"},null,-1)),(0,s.eW)((0,n.v_)(x.formatDate(t.updated_at)),1)])])]),(0,s.Lk)("div",f,[(0,s.Lk)("button",{class:"btn btn-sm btn-outline-primary",onClick:e=>x.editTrip(t.slug)},[...e[7]||(e[7]=[(0,s.Lk)("i",{class:"bi bi-pencil me-1"},null,-1),(0,s.eW)("ç¼–è¾‘ ",-1)])],8,y),(0,s.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e=>x.viewTrip(t.slug)},[...e[8]||(e[8]=[(0,s.Lk)("i",{class:"bi bi-eye me-1"},null,-1),(0,s.eW)("é¢„è§ˆ ",-1)])],8,w),(0,s.Lk)("button",{class:"btn btn-sm btn-success",onClick:e=>x.addToTree(t.slug)},[...e[9]||(e[9]=[(0,s.Lk)("i",{class:"bi bi-tree me-1"},null,-1),(0,s.eW)("è¿ç”¨åˆ°æ—…è¡Œæ ‘ ",-1)])],8,h),(0,s.Lk)("button",{class:"btn btn-sm btn-outline-danger",onClick:e=>x.deleteTrip(t.slug)},[...e[10]||(e[10]=[(0,s.Lk)("i",{class:"bi bi-trash"},null,-1)])],8,_)])])]))),128))])):((0,s.uX)(),(0,s.CE)("div",C,[e[12]||(e[12]=(0,s.Lk)("div",{class:"empty-icon mb-3"},"ðŸ“",-1)),e[13]||(e[13]=(0,s.Lk)("h4",null,"è¿˜æ²¡æœ‰æ—…è¡Œè®¡åˆ’",-1)),e[14]||(e[14]=(0,s.Lk)("p",{class:"text-muted mb-4"},"å¼€å§‹åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªæ—…è¡Œè®¡åˆ’å§ï¼",-1)),(0,s.Lk)("button",{class:"btn btn-primary btn-lg",onClick:e[1]||(e[1]=(...t)=>x.createNew&&x.createNew(...t))},[...e[11]||(e[11]=[(0,s.Lk)("i",{class:"bi bi-plus-circle me-2"},null,-1),(0,s.eW)("åˆ›å»ºæ–°æ—…è¡Œ ",-1)])])]))])])}a(4114);var W=a(144),T=a(8512),A=a(1516),E=a(7682),N=a(5824),F={name:"MyTripsView",components:{NavBar:N.A},setup(){const t=(0,T.rd)(),e=(0,A.k)(),a=(0,W.KR)([]),n=(0,W.KR)(!0),l=async()=>{n.value=!0;try{const t=await(0,E.To)();a.value=t.results||t||[]}catch(t){console.error("èŽ·å–æ—…è¡Œåˆ—è¡¨å¤±è´¥:",t),alert("åŠ è½½å¤±è´¥")}finally{n.value=!1}},i=()=>{t.push("/editor/new")},r=e=>{t.push(`/editor/${e}`)},o=e=>{t.push(`/trip/${e}`)},c=async t=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ—…è¡Œè®¡åˆ’å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚"))try{await(0,E.Au)(t),alert("åˆ é™¤æˆåŠŸ"),await l()}catch(e){console.error("åˆ é™¤å¤±è´¥:",e),alert("åˆ é™¤å¤±è´¥")}},d=async t=>{if(confirm("ç¡®å®šè¦å°†æ­¤æ—…è¡Œè®¡åˆ’æ·»åŠ åˆ°æ—…è¡Œæ ‘å—ï¼Ÿå®ƒå°†æ˜¾ç¤ºåœ¨é¦–é¡µçš„æ—…è¡Œæ ‘ä¸Šã€‚"))try{const e=await(0,E.Ol)(t);alert(e.detail||"æˆåŠŸæ·»åŠ åˆ°æ—…è¡Œæ ‘ï¼")}catch(e){console.error("æ·»åŠ åˆ°æ—…è¡Œæ ‘å¤±è´¥:",e),alert("æ·»åŠ åˆ°æ—…è¡Œæ ‘å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}},u=t=>{if(!t)return"æš‚æ— ";const e=new Date(t);return e.toLocaleDateString("zh-CN")};return(0,s.sV)(()=>{if(!e.isLoggedIn)return alert("è¯·å…ˆç™»å½•"),void t.push("/login");l()}),{trips:a,loading:n,createNew:i,editTrip:r,viewTrip:o,deleteTrip:c,addToTree:d,formatDate:u}}},X=a(1241);const I=(0,X.A)(F,[["render",x],["__scopeId","data-v-ffb7c8b2"]]);var $=I},7682:function(t,e,a){a.d(e,{Au:function(){return o},Ol:function(){return c},Tn:function(){return i},To:function(){return n},Vt:function(){return l},q:function(){return r}});var s=a(7277);const n=t=>s.A.get("/trip-plans/my_trips/",{params:t}),l=t=>s.A.get(`/trip-plans/${t}/`),i=t=>s.A.post("/trip-plans/",t),r=(t,e)=>s.A.patch(`/trip-plans/${t}/`,e),o=t=>s.A.delete(`/trip-plans/${t}/`),c=t=>s.A.post(`/trip-plans/${t}/add_to_tree/`)}}]);
//# sourceMappingURL=661.c0c0b842.js.map