"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[692],{432:function(e,l,a){a.d(l,{A:function(){return C}});var t=a(6768),o=a(4232),s=a(5130);const n={class:"navbar navbar-expand-lg navbar-dark bg-primary shadow-sm sticky-top"},i={class:"container-fluid"},d={class:"collapse navbar-collapse",id:"navbarNav",style:{overflow:"visible"}},r={class:"navbar-nav me-auto"},c={class:"nav-item"},u={key:0,class:"nav-item"},m={class:"d-flex align-items-center"},p={key:0,class:"dropdown dropdown-end"},b={href:"#",class:"d-flex align-items-center text-white text-decoration-none dropdown-toggle user-dropdown-btn",id:"dropdownUser","data-bs-toggle":"dropdown","aria-expanded":"false"},v=["src"],k={class:"dropdown-menu dropdown-menu-end text-small","aria-labelledby":"dropdownUser"};function g(e,l,a,g,L,f){const h=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("nav",n,[(0,t.Lk)("div",i,[(0,t.bF)(h,{to:"/",class:"navbar-brand"},{default:(0,t.k6)(()=>[...l[1]||(l[1]=[(0,t.Lk)("span",{class:"brand-text"},"Roamio",-1)])]),_:1}),l[9]||(l[9]=(0,t.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[(0,t.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,t.Lk)("div",d,[(0,t.Lk)("ul",r,[(0,t.Lk)("li",c,[(0,t.bF)(h,{to:"/",class:"nav-link"},{default:(0,t.k6)(()=>[...l[2]||(l[2]=[(0,t.Lk)("i",{class:"bi bi-house-door me-1"},null,-1),(0,t.eW)(" 旅行大厅 ",-1)])]),_:1})]),g.isLoggedIn?((0,t.uX)(),(0,t.CE)("li",u,[(0,t.bF)(h,{to:"/my-trips/",class:"nav-link"},{default:(0,t.k6)(()=>[...l[3]||(l[3]=[(0,t.Lk)("i",{class:"bi bi-folder me-1"},null,-1),(0,t.eW)(" 我的旅行 ",-1)])]),_:1})])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",m,[g.isLoggedIn?((0,t.uX)(),(0,t.CE)("div",p,[(0,t.Lk)("a",b,[(0,t.Lk)("img",{src:g.avatar,alt:"avatar",width:"32",height:"32",class:"rounded-circle me-2"},null,8,v),(0,t.Lk)("span",null,(0,o.v_)(g.username),1)]),(0,t.Lk)("ul",k,[(0,t.Lk)("li",null,[(0,t.bF)(h,{to:"/user/center",class:"dropdown-item"},{default:(0,t.k6)(()=>[...l[4]||(l[4]=[(0,t.Lk)("i",{class:"bi bi-person me-2"},null,-1),(0,t.eW)("个人中心 ",-1)])]),_:1})]),l[6]||(l[6]=(0,t.Lk)("li",null,[(0,t.Lk)("hr",{class:"dropdown-divider"})],-1)),(0,t.Lk)("li",null,[(0,t.Lk)("a",{href:"#",class:"dropdown-item",onClick:l[0]||(l[0]=(0,s.D$)((...e)=>g.handleLogout&&g.handleLogout(...e),["prevent"]))},[...l[5]||(l[5]=[(0,t.Lk)("i",{class:"bi bi-box-arrow-right me-2"},null,-1),(0,t.eW)("退出登录 ",-1)])])])])])):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(h,{to:"/login",class:"btn btn-outline-light btn-sm me-2"},{default:(0,t.k6)(()=>[...l[7]||(l[7]=[(0,t.eW)(" 登录 ",-1)])]),_:1}),(0,t.bF)(h,{to:"/register",class:"btn btn-light btn-sm"},{default:(0,t.k6)(()=>[...l[8]||(l[8]=[(0,t.eW)(" 注册 ",-1)])]),_:1})],64))])])])])}a(4114);var L=a(8512),f=a(3459),h={name:"NavBar",setup(){const e=(0,L.rd)(),l=(0,f.k)(),a=(0,t.EW)(()=>l.isLoggedIn),o=(0,t.EW)(()=>l.username),s=(0,t.EW)(()=>l.avatar),n=async()=>{if(confirm("确定要退出登录吗？"))try{await l.logout(),e.push("/login")}catch(a){console.error("退出失败:",a)}};return{isLoggedIn:a,username:o,avatar:s,handleLogout:n}}},y=a(1241);const V=(0,y.A)(h,[["render",g],["__scopeId","data-v-a6dd4bee"]]);var C=V},692:function(e,l,a){a.r(l),a.d(l,{default:function(){return $l}});var t=a(6768),o=a(4232);const s={class:"editor-wrapper"},n={class:"editor-container"},i={class:"editor-toolbar"},d={class:"container-fluid"},r={class:"d-flex justify-content-between align-items-center py-3"},c={class:"d-inline-block mb-0 ms-3"},u=["disabled"],m={key:0,class:"spinner-border spinner-border-sm me-1"},p={key:1,class:"bi bi-save me-1"},b=["disabled"],v={key:0,class:"spinner-border spinner-border-sm me-1"},k={key:1,class:"bi bi-send me-1"},g={class:"container py-4"},L={class:"row"},f={class:"col-lg-8"},h={class:"col-lg-4"};function y(e,l,a,y,V,C){const E=(0,t.g2)("NavBar"),w=(0,t.g2)("BasicInfoEditor"),_=(0,t.g2)("ModuleSelector"),I=(0,t.g2)("ContentEditor"),x=(0,t.g2)("EditorSidebar");return(0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(E),(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[(0,t.Lk)("div",d,[(0,t.Lk)("div",r,[(0,t.Lk)("div",null,[(0,t.Lk)("button",{class:"btn btn-outline-secondary me-2",onClick:l[0]||(l[0]=(...e)=>y.goBack&&y.goBack(...e))},[...l[6]||(l[6]=[(0,t.Lk)("i",{class:"bi bi-arrow-left me-1"},null,-1),(0,t.eW)("返回 ",-1)])]),(0,t.Lk)("h5",c,(0,o.v_)(y.isEditMode?"编辑旅行计划":"创建旅行计划"),1)]),(0,t.Lk)("div",null,[(0,t.Lk)("button",{class:"btn btn-outline-primary me-2",onClick:l[1]||(l[1]=(...e)=>y.handleSave&&y.handleSave(...e)),disabled:y.saving},[y.saving?((0,t.uX)(),(0,t.CE)("span",m)):((0,t.uX)(),(0,t.CE)("i",p)),l[7]||(l[7]=(0,t.eW)(" 保存草稿 ",-1))],8,u),(0,t.Lk)("button",{class:"btn btn-primary",onClick:l[2]||(l[2]=(...e)=>y.handlePublish&&y.handlePublish(...e)),disabled:y.publishing||!y.canPublish},[y.publishing?((0,t.uX)(),(0,t.CE)("span",v)):((0,t.uX)(),(0,t.CE)("i",k)),l[8]||(l[8]=(0,t.eW)(" 发布 ",-1))],8,b)])])])]),(0,t.Lk)("div",g,[(0,t.Lk)("div",L,[(0,t.Lk)("div",f,[(0,t.bF)(w,{modelValue:y.tripData,"onUpdate:modelValue":l[3]||(l[3]=e=>y.tripData=e)},null,8,["modelValue"]),(0,t.bF)(_,{modules:y.availableModules,"enabled-modules":y.tripData.config.enabledModules,onToggle:y.toggleModule},null,8,["modules","enabled-modules","onToggle"]),(0,t.bF)(I,{modelValue:y.tripData.overview,"onUpdate:modelValue":l[4]||(l[4]=e=>y.tripData.overview=e),"enabled-modules":y.tripData.config.enabledModules},null,8,["modelValue","enabled-modules"])]),(0,t.Lk)("div",h,[(0,t.bF)(x,{modelValue:y.tripData,"onUpdate:modelValue":l[5]||(l[5]=e=>y.tripData=e),"days-count":y.daysCount},null,8,["modelValue","days-count"])])])])])])}a(4114),a(8111),a(8237);var V=a(144),C=a(8512),E=a(3459),w=a(7682),_=a(432);const I={class:"card mb-4"},x={class:"card-body"},X={class:"mb-4 title-input-wrapper"},U=["value"],M={class:"mb-3"},$=["value"],A={class:"row mb-3"},F={class:"col-md-6"},W=["value"],D={class:"col-md-6"},T=["value"],B={class:"row mb-3"},J={class:"col-md-6"},Q={class:"icon-selector"},j=["onClick"],K={class:"col-md-6"},S=["value"];function q(e,l,a,s,n,i){return(0,t.uX)(),(0,t.CE)("div",I,[l[11]||(l[11]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"📝 基本信息")],-1)),(0,t.Lk)("div",x,[(0,t.Lk)("div",X,[l[5]||(l[5]=(0,t.Lk)("label",{class:"form-label title-label"},"旅行标题 *",-1)),(0,t.Lk)("input",{value:a.modelValue.title,onInput:l[0]||(l[0]=l=>e.$emit("update:modelValue",{...a.modelValue,title:l.target.value})),type:"text",class:"form-control title-input",placeholder:"例如：厦门三天两夜游",required:""},null,40,U)]),(0,t.Lk)("div",M,[l[6]||(l[6]=(0,t.Lk)("label",{class:"form-label"},"简介描述",-1)),(0,t.Lk)("textarea",{value:a.modelValue.description,onInput:l[1]||(l[1]=l=>e.$emit("update:modelValue",{...a.modelValue,description:l.target.value})),class:"form-control",rows:"3",placeholder:"简单描述你的旅行计划..."},null,40,$)]),(0,t.Lk)("div",A,[(0,t.Lk)("div",F,[l[7]||(l[7]=(0,t.Lk)("label",{class:"form-label"},"开始日期",-1)),(0,t.Lk)("input",{value:a.modelValue.start_date,onInput:l[2]||(l[2]=l=>e.$emit("update:modelValue",{...a.modelValue,start_date:l.target.value})),type:"date",class:"form-control"},null,40,W)]),(0,t.Lk)("div",D,[l[8]||(l[8]=(0,t.Lk)("label",{class:"form-label"},"结束日期",-1)),(0,t.Lk)("input",{value:a.modelValue.end_date,onInput:l[3]||(l[3]=l=>e.$emit("update:modelValue",{...a.modelValue,end_date:l.target.value})),type:"date",class:"form-control"},null,40,T)])]),(0,t.Lk)("div",B,[(0,t.Lk)("div",J,[l[9]||(l[9]=(0,t.Lk)("label",{class:"form-label"},"旅行图标",-1)),(0,t.Lk)("div",Q,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.iconOptions,l=>((0,t.uX)(),(0,t.CE)("button",{key:l,type:"button",class:(0,o.C4)(["icon-btn",{active:a.modelValue.icon===l}]),onClick:t=>e.$emit("update:modelValue",{...a.modelValue,icon:l})},(0,o.v_)(l),11,j))),128))])]),(0,t.Lk)("div",K,[l[10]||(l[10]=(0,t.Lk)("label",{class:"form-label"},"主题颜色",-1)),(0,t.Lk)("input",{value:a.modelValue.theme_color,onInput:l[4]||(l[4]=l=>e.$emit("update:modelValue",{...a.modelValue,theme_color:l.target.value})),type:"color",class:"form-control form-control-color"},null,40,S)])])])])}var N={name:"BasicInfoEditor",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(){const e=["🏖️","🌊","🏙️","🌄","🌇","🗺️","✈️","🚗","🏔️","🌴"];return{iconOptions:e}}},O=a(1241);const H=(0,O.A)(N,[["render",q],["__scopeId","data-v-79181f42"]]);var P=H;const R={class:"card mb-4"},z={class:"card-body"},G={class:"modules-grid"},Y=["onClick"],Z={class:"module-icon"},ee={class:"module-name"},le={class:"module-desc"},ae={class:"module-check"},te={key:0,class:"bi bi-check-circle-fill text-success"},oe={key:1,class:"bi bi-circle text-muted"};function se(e,l,a,s,n,i){return(0,t.uX)(),(0,t.CE)("div",R,[l[1]||(l[1]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"🧩 选择模块")],-1)),(0,t.Lk)("div",z,[l[0]||(l[0]=(0,t.Lk)("p",{class:"text-muted mb-3"},"选择你想在旅行计划中展示的内容模块",-1)),(0,t.Lk)("div",G,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.modules,l=>((0,t.uX)(),(0,t.CE)("div",{key:l.id,class:(0,o.C4)(["module-card",{active:s.isEnabled(l.id)}]),onClick:a=>e.$emit("toggle",l.id)},[(0,t.Lk)("div",Z,(0,o.v_)(l.icon),1),(0,t.Lk)("div",ee,(0,o.v_)(l.name),1),(0,t.Lk)("div",le,(0,o.v_)(l.description),1),(0,t.Lk)("div",ae,[s.isEnabled(l.id)?((0,t.uX)(),(0,t.CE)("i",te)):((0,t.uX)(),(0,t.CE)("i",oe))])],10,Y))),128))])])])}var ne={name:"ModuleSelector",props:{modules:{type:Array,required:!0},enabledModules:{type:Array,default:()=>[]}},emits:["toggle"],setup(e){const l=l=>e.enabledModules.includes(l);return{isEnabled:l}}};const ie=(0,O.A)(ne,[["render",se],["__scopeId","data-v-4fb81d10"]]);var de=ie,re=a(5130);const ce={key:0,class:"card mb-4"},ue={class:"card-body"},me={class:"row"},pe={class:"col-md-6 mb-3"},be={class:"col-md-6 mb-3"},ve={class:"col-md-6 mb-3"},ke={class:"col-md-6 mb-3"},ge={key:1,class:"card mb-4"},Le={class:"card-header d-flex justify-content-between align-items-center"},fe={class:"card-body"},he={class:"input-group"},ye=["onUpdate:modelValue"],Ve=["onClick"],Ce={key:0,class:"text-muted text-center py-3 mb-0"},Ee={key:2,class:"card mb-4"},we={class:"card-header d-flex justify-content-between align-items-center"},_e={class:"card-body"},Ie={class:"d-flex justify-content-between align-items-center mb-2"},xe=["onClick"],Xe={class:"mb-2"},Ue=["onUpdate:modelValue"],Me={class:"mb-2"},$e=["onUpdate:modelValue"],Ae={class:"mb-2"},Fe=["onUpdate:modelValue"],We=["onUpdate:modelValue"],De={key:0,class:"text-muted text-center py-3 mb-0"},Te={key:3,class:"card mb-4"},Be={class:"card-header d-flex justify-content-between align-items-center"},Je={class:"card-body"},Qe={class:"col-md-4"},je=["onUpdate:modelValue"],Ke={class:"col-md-3"},Se=["onUpdate:modelValue"],qe={class:"col-md-4"},Ne=["onUpdate:modelValue"],Oe={class:"col-md-1"},He=["onClick"],Pe={key:0,class:"alert alert-info mt-3"},Re={key:4,class:"card mb-4"},ze={class:"card-header d-flex justify-content-between align-items-center"},Ge={class:"card-body"},Ye={class:"input-group"},Ze=["onUpdate:modelValue"],el=["onClick"],ll={key:0,class:"text-muted text-center py-3 mb-0"};function al(e,l,a,s,n,i){return(0,t.uX)(),(0,t.CE)("div",null,[s.isModuleEnabled("basicInfo")?((0,t.uX)(),(0,t.CE)("div",ce,[l[12]||(l[12]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"ℹ️ 基本信息")],-1)),(0,t.Lk)("div",ue,[(0,t.Lk)("div",me,[(0,t.Lk)("div",pe,[l[8]||(l[8]=(0,t.Lk)("label",{class:"form-label"},"出发地",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>s.content.basicInfo.departure=e),type:"text",class:"form-control"},null,512),[[re.Jo,s.content.basicInfo.departure]])]),(0,t.Lk)("div",be,[l[9]||(l[9]=(0,t.Lk)("label",{class:"form-label"},"目的地",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>s.content.basicInfo.destination=e),type:"text",class:"form-control"},null,512),[[re.Jo,s.content.basicInfo.destination]])]),(0,t.Lk)("div",ve,[l[10]||(l[10]=(0,t.Lk)("label",{class:"form-label"},"交通方式",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>s.content.basicInfo.transport=e),type:"text",class:"form-control",placeholder:"例如：高铁往返"},null,512),[[re.Jo,s.content.basicInfo.transport]])]),(0,t.Lk)("div",ke,[l[11]||(l[11]=(0,t.Lk)("label",{class:"form-label"},"住宿安排",-1)),(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>s.content.basicInfo.accommodation=e),type:"text",class:"form-control"},null,512),[[re.Jo,s.content.basicInfo.accommodation]])])])])])):(0,t.Q3)("",!0),s.isModuleEnabled("highlights")?((0,t.uX)(),(0,t.CE)("div",ge,[(0,t.Lk)("div",Le,[l[13]||(l[13]=(0,t.Lk)("h5",{class:"mb-0"},"✨ 行程亮点",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[4]||(l[4]=(...e)=>s.addHighlight&&s.addHighlight(...e))}," ➕ 添加 ")]),(0,t.Lk)("div",fe,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.content.highlights,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"mb-3"},[(0,t.Lk)("div",he,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":e=>s.content.highlights[l]=e,type:"text",class:"form-control",placeholder:"例如：🏖️ 厦门植物园 - 热带雨林奇观"},null,8,ye),[[re.Jo,s.content.highlights[l]]]),(0,t.Lk)("button",{class:"btn btn-outline-danger",onClick:e=>s.removeHighlight(l),title:"删除"}," 🗑️ ",8,Ve)])]))),128)),0===s.content.highlights.length?((0,t.uX)(),(0,t.CE)("p",Ce,' 暂无亮点，点击上方"添加"按钮 ')):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0),s.isModuleEnabled("itinerary")?((0,t.uX)(),(0,t.CE)("div",Ee,[(0,t.Lk)("div",we,[l[14]||(l[14]=(0,t.Lk)("h5",{class:"mb-0"},"📅 详细行程",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[5]||(l[5]=(...e)=>s.addItinerary&&s.addItinerary(...e))}," ➕ 添加一天 ")]),(0,t.Lk)("div",_e,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.content.itinerary,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"itinerary-item mb-4"},[(0,t.Lk)("div",Ie,[(0,t.Lk)("h6",null,"第"+(0,o.v_)(l+1)+"天",1),(0,t.Lk)("button",{class:"btn btn-sm btn-outline-danger",onClick:e=>s.removeItinerary(l),title:"删除"}," 🗑️ ",8,xe)]),(0,t.Lk)("div",Xe,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.day=l,type:"text",class:"form-control form-control-sm",placeholder:"例如：第一天（6月22日）"},null,8,Ue),[[re.Jo,e.day]])]),(0,t.Lk)("div",Me,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.time=l,type:"text",class:"form-control form-control-sm",placeholder:"例如：09:00-18:00"},null,8,$e),[[re.Jo,e.time]])]),(0,t.Lk)("div",Ae,[(0,t.bo)((0,t.Lk)("textarea",{"onUpdate:modelValue":l=>e.content=l,class:"form-control form-control-sm",rows:"3",placeholder:"详细的行程安排..."},null,8,Fe),[[re.Jo,e.content]])]),(0,t.Lk)("div",null,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.highlight=l,type:"text",class:"form-control form-control-sm",placeholder:"例如：🏖️ 海滩美景"},null,8,We),[[re.Jo,e.highlight]])])]))),128)),0===s.content.itinerary.length?((0,t.uX)(),(0,t.CE)("p",De,' 暂无行程，点击上方"添加一天"按钮开始规划 ')):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0),s.isModuleEnabled("budget")?((0,t.uX)(),(0,t.CE)("div",Te,[(0,t.Lk)("div",Be,[l[15]||(l[15]=(0,t.Lk)("h5",{class:"mb-0"},"💰 预算参考",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[6]||(l[6]=(...e)=>s.addBudgetItem&&s.addBudgetItem(...e))}," ➕ 添加 ")]),(0,t.Lk)("div",Je,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.content.budget.items,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"row mb-3"},[(0,t.Lk)("div",Qe,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.name=l,type:"text",class:"form-control form-control-sm",placeholder:"项目名称"},null,8,je),[[re.Jo,e.name]])]),(0,t.Lk)("div",Ke,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.amount=l,type:"number",class:"form-control form-control-sm",placeholder:"金额"},null,8,Se),[[re.Jo,e.amount,void 0,{number:!0}]])]),(0,t.Lk)("div",qe,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l=>e.note=l,type:"text",class:"form-control form-control-sm",placeholder:"备注"},null,8,Ne),[[re.Jo,e.note]])]),(0,t.Lk)("div",Oe,[(0,t.Lk)("button",{class:"btn btn-sm btn-outline-danger w-100",onClick:e=>s.removeBudgetItem(l),title:"删除"}," 🗑️ ",8,He)])]))),128)),s.content.budget.items.length>0?((0,t.uX)(),(0,t.CE)("div",Pe,[l[16]||(l[16]=(0,t.Lk)("strong",null,"总计：",-1)),(0,t.eW)("¥"+(0,o.v_)(s.budgetTotal),1)])):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0),s.isModuleEnabled("tips")?((0,t.uX)(),(0,t.CE)("div",Re,[(0,t.Lk)("div",ze,[l[17]||(l[17]=(0,t.Lk)("h5",{class:"mb-0"},"💡 实用提示",-1)),(0,t.Lk)("button",{class:"btn btn-sm btn-light",onClick:l[7]||(l[7]=(...e)=>s.addTip&&s.addTip(...e))}," ➕ 添加 ")]),(0,t.Lk)("div",Ge,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.content.tips,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"mb-3"},[(0,t.Lk)("div",Ye,[(0,t.bo)((0,t.Lk)("textarea",{"onUpdate:modelValue":e=>s.content.tips[l]=e,class:"form-control",rows:"2",placeholder:"输入一条实用提示..."},null,8,Ze),[[re.Jo,s.content.tips[l]]]),(0,t.Lk)("button",{class:"btn btn-outline-danger",onClick:e=>s.removeTip(l),title:"删除"}," 🗑️ ",8,el)])]))),128)),0===s.content.tips.length?((0,t.uX)(),(0,t.CE)("p",ll,' 暂无提示，点击上方"添加"按钮 ')):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0)])}var tl={name:"ContentEditor",props:{modelValue:{type:Object,required:!0},enabledModules:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:l}){const a=(0,t.EW)({get:()=>e.modelValue,set:e=>l("update:modelValue",e)}),o=l=>e.enabledModules.includes(l),s=(0,t.EW)(()=>a.value.budget.items.reduce((e,l)=>e+(l.amount||0),0)),n=()=>{a.value.highlights.push("")},i=e=>{a.value.highlights.splice(e,1)},d=()=>{a.value.itinerary.push({day:"",time:"",content:"",highlight:""})},r=e=>{a.value.itinerary.splice(e,1)},c=()=>{a.value.budget.items.push({name:"",amount:0,note:""})},u=e=>{a.value.budget.items.splice(e,1)},m=()=>{a.value.tips.push("")},p=e=>{a.value.tips.splice(e,1)};return{content:a,isModuleEnabled:o,budgetTotal:s,addHighlight:n,removeHighlight:i,addItinerary:d,removeItinerary:r,addBudgetItem:c,removeBudgetItem:u,addTip:m,removeTip:p}}};const ol=(0,O.A)(tl,[["render",al],["__scopeId","data-v-10fbffd8"]]);var sl=ol;const nl={class:"card mb-4 sticky-top",style:{top:"140px"}},il={class:"card-body"},dl={class:"mb-3"},rl=["value"],cl={class:"mb-3"},ul=["value"],ml={class:"mb-3"},pl={class:"color-picker"},bl=["value"],vl={class:"mb-3"},kl=["value"],gl={class:"mb-3"},Ll=["value"],fl={class:"info-stats mt-4"},hl={key:0,class:"stat-item"},yl={class:"value"},Vl={key:1,class:"stat-item"},Cl={class:"value"},El={key:2,class:"stat-item"},wl={class:"value"};function _l(e,l,a,s,n,i){return(0,t.uX)(),(0,t.CE)("div",nl,[l[20]||(l[20]=(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h5",{class:"mb-0"},"⚙️ 设置")],-1)),(0,t.Lk)("div",il,[(0,t.Lk)("div",dl,[l[6]||(l[6]=(0,t.Lk)("label",{class:"form-label"},"状态",-1)),(0,t.Lk)("select",{value:a.modelValue.status,onChange:l[0]||(l[0]=l=>e.$emit("update:modelValue",{...a.modelValue,status:l.target.value})),class:"form-select"},[...l[5]||(l[5]=[(0,t.Lk)("option",{value:"draft"},"草稿",-1),(0,t.Lk)("option",{value:"published"},"已发布",-1)])],40,rl)]),(0,t.Lk)("div",cl,[l[8]||(l[8]=(0,t.Lk)("label",{class:"form-label"},"可见性",-1)),(0,t.Lk)("select",{value:a.modelValue.visibility,onChange:l[1]||(l[1]=l=>e.$emit("update:modelValue",{...a.modelValue,visibility:l.target.value})),class:"form-select"},[...l[7]||(l[7]=[(0,t.Lk)("option",{value:"private"},"私有",-1),(0,t.Lk)("option",{value:"public"},"公开",-1)])],40,ul),l[9]||(l[9]=(0,t.Lk)("small",{class:"text-muted"},"公开后其他人可以看到你的旅行计划",-1))]),(0,t.Lk)("div",ml,[l[10]||(l[10]=(0,t.Lk)("label",{class:"form-label"},"🎨 主题色",-1)),(0,t.Lk)("div",pl,[(0,t.Lk)("input",{type:"color",value:a.modelValue.theme_color||"#f0e68c",onInput:l[2]||(l[2]=l=>e.$emit("update:modelValue",{...a.modelValue,theme_color:l.target.value})),class:"form-control form-control-color"},null,40,bl),(0,t.Lk)("div",{class:"color-preview",style:(0,o.Tr)({background:a.modelValue.theme_color||"#f0e68c"})},null,4)]),l[11]||(l[11]=(0,t.Lk)("small",{class:"text-muted"},"选择卡片头部的背景色",-1))]),(0,t.Lk)("div",vl,[l[13]||(l[13]=(0,t.Lk)("label",{class:"form-label"},"🎵 背景音乐",-1)),(0,t.Lk)("select",{value:a.modelValue.background_music,onChange:l[3]||(l[3]=l=>e.$emit("update:modelValue",{...a.modelValue,background_music:l.target.value})),class:"form-select"},[...l[12]||(l[12]=[(0,t.Lk)("option",{value:""},"无背景音乐",-1),(0,t.Lk)("option",{value:"/static/music/rain.mp3"},"🌧️ 雨声",-1),(0,t.Lk)("option",{value:"/static/music/road.mp3"},"🛤️ 旅途",-1),(0,t.Lk)("option",{value:"/static/music/windy.mp3"},"💨 风声",-1)])],40,kl),l[14]||(l[14]=(0,t.Lk)("small",{class:"text-muted"},"选择适合旅行场景的背景音乐",-1))]),(0,t.Lk)("div",gl,[l[15]||(l[15]=(0,t.Lk)("label",{class:"form-label"},"📍 图标",-1)),(0,t.Lk)("input",{type:"text",value:a.modelValue.icon,onInput:l[4]||(l[4]=l=>e.$emit("update:modelValue",{...a.modelValue,icon:l.target.value})),class:"form-control",placeholder:"例如：🗺️"},null,40,Ll),l[16]||(l[16]=(0,t.Lk)("small",{class:"text-muted"},"使用emoji表情",-1))]),(0,t.Lk)("div",fl,[a.modelValue.created_at?((0,t.uX)(),(0,t.CE)("div",hl,[l[17]||(l[17]=(0,t.Lk)("span",{class:"label"},"创建时间",-1)),(0,t.Lk)("span",yl,(0,o.v_)(s.formatDate(a.modelValue.created_at)),1)])):(0,t.Q3)("",!0),a.modelValue.updated_at?((0,t.uX)(),(0,t.CE)("div",Vl,[l[18]||(l[18]=(0,t.Lk)("span",{class:"label"},"更新时间",-1)),(0,t.Lk)("span",Cl,(0,o.v_)(s.formatDate(a.modelValue.updated_at)),1)])):(0,t.Q3)("",!0),a.daysCount>0?((0,t.uX)(),(0,t.CE)("div",El,[l[19]||(l[19]=(0,t.Lk)("span",{class:"label"},"旅行天数",-1)),(0,t.Lk)("span",wl,(0,o.v_)(a.daysCount)+"天",1)])):(0,t.Q3)("",!0)])])])}var Il={name:"EditorSidebar",props:{modelValue:{type:Object,required:!0},daysCount:{type:Number,default:0}},emits:["update:modelValue"],setup(){const e=e=>{if(!e)return"暂无";const l=new Date(e);return l.toLocaleString("zh-CN")};return{formatDate:e}}};const xl=(0,O.A)(Il,[["render",_l],["__scopeId","data-v-5d3b9caa"]]);var Xl=xl,Ul={name:"TripEditorView",components:{NavBar:_.A,BasicInfoEditor:P,ModuleSelector:de,ContentEditor:sl,EditorSidebar:Xl},setup(){const e=(0,C.lq)(),l=(0,C.rd)(),a=(0,E.k)(),o=(0,V.KR)(!1),s=(0,V.KR)(!1),n=[{id:"basicInfo",name:"基本信息",icon:"ℹ️",description:"出发地、目的地等"},{id:"highlights",name:"行程亮点",icon:"✨",description:"主要景点和活动"},{id:"itinerary",name:"详细行程",icon:"📅",description:"每日安排"},{id:"budget",name:"预算参考",icon:"💰",description:"费用明细"},{id:"tips",name:"实用提示",icon:"💡",description:"注意事项"}],i=(0,V.KR)({title:"",description:"",icon:"🗺️",start_date:null,end_date:null,status:"draft",visibility:"private",theme_color:"#f0e68c",background_music:"",config:{enabledModules:["basicInfo","highlights"]},overview:{basicInfo:{departure:"",destination:"",transport:"",accommodation:""},highlights:[],itinerary:[],budget:{items:[],total:0},tips:[]},created_at:null,updated_at:null}),d=(0,t.EW)(()=>{const l=e.params.slug;return l&&"new"!==l}),r=(0,t.EW)(()=>i.value.title&&i.value.title.trim().length>0),c=(0,t.EW)(()=>{if(!i.value.start_date||!i.value.end_date)return 0;const e=new Date(i.value.start_date),l=new Date(i.value.end_date);return Math.ceil((l-e)/864e5)+1}),u=e=>{const l=i.value.config.enabledModules.indexOf(e);l>-1?i.value.config.enabledModules.splice(l,1):i.value.config.enabledModules.push(e)},m=async()=>{if(r.value){o.value=!0;try{if(i.value.overview.budget.total=i.value.overview.budget.items.reduce((e,l)=>e+(l.amount||0),0),d.value)await(0,w.q)(e.params.slug,i.value),alert("保存成功！");else{const e=await(0,w.Tn)(i.value);alert("创建成功！"),l.push(`/editor/${e.slug}`)}}catch(a){console.error("保存失败:",a),alert("保存失败："+(a.response?.data?.detail||a.message))}finally{o.value=!1}}else alert("请至少填写标题")},p=async()=>{if(r.value){if(confirm("确定要发布这个旅行计划吗？发布后将可以被其他用户看到。")){s.value=!0;try{if(i.value.status="published",i.value.overview.budget.total=i.value.overview.budget.items.reduce((e,l)=>e+(l.amount||0),0),d.value)await(0,w.q)(e.params.slug,i.value);else{const e=await(0,w.Tn)(i.value);l.push(`/editor/${e.slug}`)}alert("发布成功！")}catch(a){console.error("发布失败:",a),alert("发布失败："+(a.response?.data?.detail||a.message))}finally{s.value=!1}}}else alert("请至少填写标题")},b=()=>{confirm("确定要离开吗？未保存的更改将丢失。")&&l.push("/my-trips")},v=async()=>{const a=e.params.slug;if(a&&"new"!==a)try{const e=await(0,w.Vt)(a);i.value={...i.value,...e,overview:e.overview||i.value.overview,config:e.config||i.value.config}}catch(t){console.error("加载失败:",t),alert("加载旅行计划失败"),l.push("/my-trips")}};return(0,t.sV)(()=>{if(!a.isLoggedIn)return alert("请先登录"),void l.push("/login");v()}),{tripData:i,saving:o,publishing:s,isEditMode:d,canPublish:r,daysCount:c,availableModules:n,toggleModule:u,handleSave:m,handlePublish:p,goBack:b}}};const Ml=(0,O.A)(Ul,[["render",y],["__scopeId","data-v-9e714c96"]]);var $l=Ml},7682:function(e,l,a){a.d(l,{Au:function(){return d},Ol:function(){return r},Tn:function(){return n},To:function(){return o},Vt:function(){return s},ml:function(){return c},q:function(){return i}});var t=a(7277);const o=e=>t.A.get("/trip-plans/my_trips/",{params:e}),s=e=>t.A.get(`/trip-plans/${e}/`),n=e=>t.A.post("/trip-plans/",e),i=(e,l)=>t.A.patch(`/trip-plans/${e}/`,l),d=e=>t.A.delete(`/trip-plans/${e}/`),r=e=>t.A.post(`/trip-plans/${e}/add_to_tree/`),c=e=>t.A.post(`/trip-plans/${e}/remove_from_tree/`)}}]);
//# sourceMappingURL=692.b858917b.js.map