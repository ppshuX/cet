"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[371],{6371:function(e,s,a){a.r(s),a.d(s,{default:function(){return f}});var r=a(6768),t=a(4232);const o={class:"qq-callback-container"},n={class:"loading-spinner"},c={class:"mt-3"};function l(e,s,a,l,u,i){return(0,r.uX)(),(0,r.CE)("div",o,[(0,r.Lk)("div",n,[s[0]||(s[0]=(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"处理中...")],-1)),(0,r.Lk)("p",c,(0,t.v_)(l.message),1)])])}a(4114);var u=a(144),i=a(8512),d=a(3459),m=a(2636),p={name:"QQCallbackView",setup(){const e=(0,i.rd)(),s=(0,i.lq)(),a=(0,d.k)(),t=(0,u.KR)("正在处理QQ登录...");return(0,r.sV)(async()=>{try{const r=s.query.code,o=s.query.state;if(!r||!o)return t.value="缺少必要的参数，请重新登录",void setTimeout(()=>{e.push("/login/")},2e3);t.value="正在验证QQ登录信息...";const n=await(0,m.UB)({code:r,state:o});n.success&&n.access?(a.token=n.access,a.refreshToken=n.refresh,a.userInfo=n.user,localStorage.setItem("access_token",n.access),localStorage.setItem("refresh_token",n.refresh),localStorage.setItem("user_info",JSON.stringify(n.user)),n.email_optional&&!n.user?.email?t.value="登录成功！建议在个人中心绑定邮箱以便接收重要通知":t.value="登录成功！正在跳转...",setTimeout(()=>{e.push("/")},n.email_optional?2500:1e3)):(t.value=n.error||"QQ登录失败，请重试",setTimeout(()=>{e.push("/login/")},2e3))}catch(r){console.error("QQ登录处理失败:",r),t.value=r.response?.data?.error||r.message||"QQ登录失败，请重试",setTimeout(()=>{e.push("/login/")},2e3)}}),{message:t}}},v=a(1241);const k=(0,v.A)(p,[["render",l],["__scopeId","data-v-3e5d062a"]]);var f=k}}]);
//# sourceMappingURL=371.ea90b657.js.map