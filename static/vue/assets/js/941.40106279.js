"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[941],{432:function(e,a,s){s.d(a,{A:function(){return _}});var n=s(6768),r=s(4232),o=s(5130);const l={class:"navbar navbar-expand-lg navbar-dark bg-primary shadow-sm sticky-top"},t={class:"container-fluid"},i={class:"collapse navbar-collapse",id:"navbarNav",style:{overflow:"visible"}},d={class:"navbar-nav me-auto"},c={class:"nav-item"},u={key:0,class:"nav-item"},b={class:"d-flex align-items-center"},v={key:0,class:"dropdown dropdown-end"},g={href:"#",class:"d-flex align-items-center text-white text-decoration-none dropdown-toggle user-dropdown-btn",id:"dropdownUser","data-bs-toggle":"dropdown","aria-expanded":"false"},p=["src"],k={class:"dropdown-menu dropdown-menu-end text-small","aria-labelledby":"dropdownUser"};function m(e,a,s,m,L,f){const w=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("nav",l,[(0,n.Lk)("div",t,[(0,n.bF)(w,{to:"/",class:"navbar-brand"},{default:(0,n.k6)(()=>[...a[1]||(a[1]=[(0,n.Lk)("span",{class:"brand-text"},"Roamio",-1)])]),_:1}),a[9]||(a[9]=(0,n.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[(0,n.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,n.Lk)("div",i,[(0,n.Lk)("ul",d,[(0,n.Lk)("li",c,[(0,n.bF)(w,{to:"/",class:"nav-link"},{default:(0,n.k6)(()=>[...a[2]||(a[2]=[(0,n.Lk)("i",{class:"bi bi-house-door me-1"},null,-1),(0,n.eW)(" 旅行大厅 ",-1)])]),_:1})]),m.isLoggedIn?((0,n.uX)(),(0,n.CE)("li",u,[(0,n.bF)(w,{to:"/my-trips/",class:"nav-link"},{default:(0,n.k6)(()=>[...a[3]||(a[3]=[(0,n.Lk)("i",{class:"bi bi-folder me-1"},null,-1),(0,n.eW)(" 我的旅行 ",-1)])]),_:1})])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",b,[m.isLoggedIn?((0,n.uX)(),(0,n.CE)("div",v,[(0,n.Lk)("a",g,[(0,n.Lk)("img",{src:m.avatar,alt:"avatar",width:"32",height:"32",class:"rounded-circle me-2"},null,8,p),(0,n.Lk)("span",null,(0,r.v_)(m.username),1)]),(0,n.Lk)("ul",k,[(0,n.Lk)("li",null,[(0,n.bF)(w,{to:"/user/center",class:"dropdown-item"},{default:(0,n.k6)(()=>[...a[4]||(a[4]=[(0,n.Lk)("i",{class:"bi bi-person me-2"},null,-1),(0,n.eW)("个人中心 ",-1)])]),_:1})]),a[6]||(a[6]=(0,n.Lk)("li",null,[(0,n.Lk)("hr",{class:"dropdown-divider"})],-1)),(0,n.Lk)("li",null,[(0,n.Lk)("a",{href:"#",class:"dropdown-item",onClick:a[0]||(a[0]=(0,o.D$)((...e)=>m.handleLogout&&m.handleLogout(...e),["prevent"]))},[...a[5]||(a[5]=[(0,n.Lk)("i",{class:"bi bi-box-arrow-right me-2"},null,-1),(0,n.eW)("退出登录 ",-1)])])])])])):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.bF)(w,{to:"/login",class:"btn btn-outline-light btn-sm me-2"},{default:(0,n.k6)(()=>[...a[7]||(a[7]=[(0,n.eW)(" 登录 ",-1)])]),_:1}),(0,n.bF)(w,{to:"/register",class:"btn btn-light btn-sm"},{default:(0,n.k6)(()=>[...a[8]||(a[8]=[(0,n.eW)(" 注册 ",-1)])]),_:1})],64))])])])])}s(4114);var L=s(8512),f=s(3459),w={name:"NavBar",setup(){const e=(0,L.rd)(),a=(0,f.k)(),s=(0,n.EW)(()=>a.isLoggedIn),r=(0,n.EW)(()=>a.username),o=(0,n.EW)(()=>a.avatar),l=async()=>{if(confirm("确定要退出登录吗？"))try{await a.logout(),e.push("/login")}catch(s){console.error("退出失败:",s)}};return{isLoggedIn:s,username:r,avatar:o,handleLogout:l}}},h=s(1241);const y=(0,h.A)(w,[["render",m],["__scopeId","data-v-a6dd4bee"]]);var _=y},946:function(e,a,s){e.exports=s.p+"assets/img/qq_logo.666e5ea1.png"},5941:function(e,a,s){s.r(a),s.d(a,{default:function(){return I}});var n=s(6768),r=s(5130),o=s(4232),l=s(946);const t={class:"login-container"},i={class:"container"},d={class:"row justify-content-center"},c={class:"col-md-6 col-lg-4"},u={class:"card shadow-lg"},b={class:"card-body p-5"},v={class:"mb-3"},g={class:"mb-3"},p={key:0,class:"alert alert-danger",role:"alert"},k=["disabled"],m={key:0,class:"spinner-border spinner-border-sm me-2"},L={class:"text-end mb-3"},f={class:"text-center mb-3"},w=["disabled"],h={key:0},y={key:1},_={class:"text-center"};function x(e,a,s,x,Q,q){const C=(0,n.g2)("NavBar"),E=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",t,[(0,n.bF)(C),(0,n.Lk)("div",i,[(0,n.Lk)("div",d,[(0,n.Lk)("div",c,[(0,n.Lk)("div",u,[(0,n.Lk)("div",b,[a[11]||(a[11]=(0,n.Lk)("h2",{class:"text-center mb-2"},"用户登录",-1)),a[12]||(a[12]=(0,n.Lk)("p",{class:"login-slogan text-center mb-4"},"Hello Roamioer!",-1)),(0,n.Lk)("form",{onSubmit:a[3]||(a[3]=(0,r.D$)((...e)=>x.handleLogin&&x.handleLogin(...e),["prevent"]))},[(0,n.Lk)("div",v,[a[4]||(a[4]=(0,n.Lk)("label",{for:"username",class:"form-label"},"用户名",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":a[0]||(a[0]=e=>x.form.username=e),required:"",placeholder:"请输入用户名"},null,512),[[r.Jo,x.form.username]])]),(0,n.Lk)("div",g,[a[5]||(a[5]=(0,n.Lk)("label",{for:"password",class:"form-label"},"密码",-1)),(0,n.bo)((0,n.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":a[1]||(a[1]=e=>x.form.password=e),required:"",placeholder:"请输入密码"},null,512),[[r.Jo,x.form.password]])]),x.error?((0,n.uX)(),(0,n.CE)("div",p,(0,o.v_)(x.error),1)):(0,n.Q3)("",!0),(0,n.Lk)("button",{type:"submit",class:"btn btn-primary w-100 mb-2",disabled:x.loading},[x.loading?((0,n.uX)(),(0,n.CE)("span",m)):(0,n.Q3)("",!0),(0,n.eW)(" "+(0,o.v_)(x.loading?"登录中...":"登录"),1)],8,k),(0,n.Lk)("div",L,[(0,n.bF)(E,{to:"/forgot-password/",class:"text-decoration-none small text-primary"},{default:(0,n.k6)(()=>[...a[6]||(a[6]=[(0,n.eW)(" 忘记密码？ ",-1)])]),_:1})]),(0,n.Lk)("div",f,[a[8]||(a[8]=(0,n.Lk)("div",{class:"divider"},[(0,n.Lk)("span",{class:"divider-text"},"或")],-1)),(0,n.Lk)("button",{type:"button",class:"btn btn-outline-secondary w-100 qq-login-btn",disabled:x.qqLoginLoading,onClick:a[2]||(a[2]=(...e)=>x.handleQQLogin&&x.handleQQLogin(...e))},[a[7]||(a[7]=(0,n.Lk)("img",{src:l,alt:"QQ登录",class:"qq-login-icon",width:"20",height:"20"},null,-1)),x.qqLoginLoading?((0,n.uX)(),(0,n.CE)("span",h,"跳转中...")):((0,n.uX)(),(0,n.CE)("span",y,"使用QQ登录"))],8,w)]),(0,n.Lk)("div",_,[a[10]||(a[10]=(0,n.Lk)("span",{class:"text-muted"},"还没有账号？",-1)),(0,n.bF)(E,{to:"/register",class:"text-decoration-none"},{default:(0,n.k6)(()=>[...a[9]||(a[9]=[(0,n.eW)("立即注册",-1)])]),_:1})])],32)])])])])])])}s(4114);var Q=s(144),q=s(8512),C=s(3459),E=s(2636),W=s(432),A={name:"LoginView",components:{NavBar:W.A},setup(){const e=(0,q.rd)(),a=(0,C.k)(),s=(0,Q.KR)({username:"",password:""}),n=(0,Q.KR)(!1),r=(0,Q.KR)(""),o=(0,Q.KR)(!1),l=async()=>{n.value=!0,r.value="";try{await a.login(s.value),e.push("/")}catch(o){if(o.response?.data){const e=o.response.data;e.username&&Array.isArray(e.username)?r.value=e.username[0]:e.password&&Array.isArray(e.password)?r.value=e.password[0]:e.non_field_errors&&Array.isArray(e.non_field_errors)?r.value=e.non_field_errors[0]:"string"===typeof e?r.value=e:e.detail?r.value=e.detail:r.value="登录失败，请检查用户名和密码"}else r.value=o.message||"登录失败，请检查用户名和密码"}finally{n.value=!1}},t=async()=>{o.value=!0;try{const e=await(0,E.jg)();e.authorize_url&&e.state?(sessionStorage.setItem("qq_oauth_state",e.state),window.location.href=e.authorize_url):(r.value="获取QQ登录链接失败，请重试",o.value=!1)}catch(e){r.value=e.response?.data?.error||"QQ登录失败，请重试",o.value=!1}};return{form:s,loading:n,error:r,qqLoginLoading:o,handleLogin:l,handleQQLogin:t}}},F=s(1241);const X=(0,F.A)(A,[["render",x],["__scopeId","data-v-327afe56"]]);var I=X}}]);
//# sourceMappingURL=941.40106279.js.map