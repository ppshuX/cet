"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[958],{485:function(t,e,s){s.d(e,{B:function(){return r},Yf:function(){return n},jw:function(){return i},nN:function(){return l}});var a=s(7277);const n=t=>a.A.get("/trips/",{params:t}),r=async t=>{try{return await a.A.get(`/trip-plans/${t}/`)}catch(e){const s=e.response?.status||e.status,n=404===s||"ERR_BAD_REQUEST"===e.code||e.message?.includes("404")||!e.response;if(n)return await a.A.get(`/trips/${t}/`);throw e}},l=t=>a.A.post(`/trips/${t}/like/`),i=t=>a.A.post(`/trips/${t}/checkin/`)},7682:function(t,e,s){s.d(e,{Au:function(){return o},Ol:function(){return c},Tn:function(){return l},To:function(){return n},Vt:function(){return r},ml:function(){return u},q:function(){return i}});var a=s(7277);const n=t=>a.A.get("/trip-plans/my_trips/",{params:t}),r=t=>a.A.get(`/trip-plans/${t}/`),l=t=>a.A.post("/trip-plans/",t),i=(t,e)=>a.A.patch(`/trip-plans/${t}/`,e),o=t=>a.A.delete(`/trip-plans/${t}/`),c=t=>a.A.post(`/trip-plans/${t}/add_to_tree/`),u=t=>a.A.post(`/trip-plans/${t}/remove_from_tree/`)},9814:function(t,e,s){s.d(e,{A:function(){return C}});var a=s(6768),n=s(4232),r=s(5130);const l={class:"navbar navbar-expand-lg navbar-dark bg-primary shadow-sm sticky-top"},i={class:"container-fluid"},o={class:"collapse navbar-collapse",id:"navbarNav",style:{overflow:"visible"}},c={class:"navbar-nav me-auto"},u={class:"nav-item"},d={key:0,class:"nav-item"},p={class:"d-flex align-items-center"},b={key:0,class:"dropdown dropdown-end"},k={href:"#",class:"d-flex align-items-center text-white text-decoration-none dropdown-toggle user-dropdown-btn",id:"dropdownUser","data-bs-toggle":"dropdown","aria-expanded":"false"},m=["src"],v={class:"dropdown-menu dropdown-menu-end text-small","aria-labelledby":"dropdownUser"};function g(t,e,s,g,L,f){const y=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("nav",l,[(0,a.Lk)("div",i,[(0,a.bF)(y,{to:"/",class:"navbar-brand"},{default:(0,a.k6)(()=>[...e[1]||(e[1]=[(0,a.Lk)("span",{class:"brand-text"},"Roamio",-1)])]),_:1}),e[9]||(e[9]=(0,a.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[(0,a.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,a.Lk)("div",o,[(0,a.Lk)("ul",c,[(0,a.Lk)("li",u,[(0,a.bF)(y,{to:"/",class:"nav-link"},{default:(0,a.k6)(()=>[...e[2]||(e[2]=[(0,a.Lk)("i",{class:"bi bi-house-door me-1"},null,-1),(0,a.eW)(" æ—…è¡Œåˆ—è¡¨ ",-1)])]),_:1})]),g.isLoggedIn?((0,a.uX)(),(0,a.CE)("li",d,[(0,a.bF)(y,{to:"/my-trips/",class:"nav-link"},{default:(0,a.k6)(()=>[...e[3]||(e[3]=[(0,a.Lk)("i",{class:"bi bi-folder me-1"},null,-1),(0,a.eW)(" æˆ‘çš„æ—…è¡Œ ",-1)])]),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",p,[g.isLoggedIn?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("a",k,[(0,a.Lk)("img",{src:g.avatar,alt:"avatar",width:"32",height:"32",class:"rounded-circle me-2"},null,8,m),(0,a.Lk)("span",null,(0,n.v_)(g.username),1)]),(0,a.Lk)("ul",v,[(0,a.Lk)("li",null,[(0,a.bF)(y,{to:"/user/center",class:"dropdown-item"},{default:(0,a.k6)(()=>[...e[4]||(e[4]=[(0,a.Lk)("i",{class:"bi bi-person me-2"},null,-1),(0,a.eW)("ä¸ªäººä¸­å¿ƒ ",-1)])]),_:1})]),e[6]||(e[6]=(0,a.Lk)("li",null,[(0,a.Lk)("hr",{class:"dropdown-divider"})],-1)),(0,a.Lk)("li",null,[(0,a.Lk)("a",{href:"#",class:"dropdown-item",onClick:e[0]||(e[0]=(0,r.D$)((...t)=>g.handleLogout&&g.handleLogout(...t),["prevent"]))},[...e[5]||(e[5]=[(0,a.Lk)("i",{class:"bi bi-box-arrow-right me-2"},null,-1),(0,a.eW)("é€€å‡ºç™»å½• ",-1)])])])])])):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(y,{to:"/login",class:"btn btn-outline-light btn-sm me-2"},{default:(0,a.k6)(()=>[...e[7]||(e[7]=[(0,a.eW)(" ç™»å½• ",-1)])]),_:1}),(0,a.bF)(y,{to:"/register",class:"btn btn-light btn-sm"},{default:(0,a.k6)(()=>[...e[8]||(e[8]=[(0,a.eW)(" æ³¨å†Œ ",-1)])]),_:1})],64))])])])])}s(4114);var L=s(8512),f=s(1516),y={name:"NavBar",setup(){const t=(0,L.rd)(),e=(0,f.k)(),s=(0,a.EW)(()=>e.isLoggedIn),n=(0,a.EW)(()=>e.username),r=(0,a.EW)(()=>e.avatar),l=async()=>{if(confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ"))try{await e.logout(),t.push("/login")}catch(s){console.error("é€€å‡ºå¤±è´¥:",s)}};return{isLoggedIn:s,username:n,avatar:r,handleLogout:l}}},w=s(1241);const h=(0,w.A)(y,[["render",g],["__scopeId","data-v-7d3c81b6"]]);var C=h},9958:function(t,e,s){s.r(e),s.d(e,{default:function(){return R}});var a=s(6768),n=s(4232);const r={class:"my-trips-wrapper"},l={class:"container py-5"},i={class:"d-flex justify-content-between align-items-center mb-4"},o={key:0,class:"text-center py-5"},c={key:1,class:"row"},u={class:"trip-card"},d={class:"trip-icon"},p={class:"trip-meta"},b={class:"trip-body"},k={class:"trip-title"},m={class:"trip-desc text-muted"},v={class:"trip-info"},g={class:"text-muted"},L={class:"text-muted ms-3"},f={class:"trip-actions"},y=["onClick"],w=["onClick"],h=["onClick"],C=["onClick"],_=["onClick"],T={key:2,class:"empty-state text-center py-5"};function A(t,e,s,A,E,x){const W=(0,a.g2)("NavBar");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(W),(0,a.Lk)("div",l,[(0,a.Lk)("div",i,[e[3]||(e[3]=(0,a.Lk)("h2",null,"æˆ‘çš„æ—…è¡Œè®¡åˆ’",-1)),(0,a.Lk)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...t)=>A.createNew&&A.createNew(...t))},[...e[2]||(e[2]=[(0,a.Lk)("i",{class:"bi bi-plus-circle me-2"},null,-1),(0,a.eW)("åˆ›å»ºæ–°æ—…è¡Œ ",-1)])])]),A.loading?((0,a.uX)(),(0,a.CE)("div",o,[...e[4]||(e[4]=[(0,a.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,a.Lk)("span",{class:"visually-hidden"},"åŠ è½½ä¸­...")],-1)])])):A.trips.length>0?((0,a.uX)(),(0,a.CE)("div",c,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(A.trips,t=>((0,a.uX)(),(0,a.CE)("div",{key:t.id,class:"col-md-6 col-lg-4 mb-4"},[(0,a.Lk)("div",u,[(0,a.Lk)("div",{class:"trip-header",style:(0,n.Tr)({background:t.theme_color||"#f0e68c"})},[(0,a.Lk)("div",d,(0,n.v_)(t.icon),1),(0,a.Lk)("div",p,[(0,a.Lk)("span",{class:(0,n.C4)(["badge","published"===t.status?"bg-success":"bg-secondary"])},(0,n.v_)("published"===t.status?"å·²å‘å¸ƒ":"è‰ç¨¿"),3),(0,a.Lk)("span",{class:(0,n.C4)(["badge ms-2","public"===t.visibility?"bg-info":"bg-warning"])},(0,n.v_)("public"===t.visibility?"å…¬å¼€":"ç§æœ‰"),3)])],4),(0,a.Lk)("div",b,[(0,a.Lk)("h5",k,(0,n.v_)(t.title),1),(0,a.Lk)("p",m,(0,n.v_)(t.description||"æš‚æ— æè¿°"),1),(0,a.Lk)("div",v,[(0,a.Lk)("small",g,[e[5]||(e[5]=(0,a.Lk)("i",{class:"bi bi-calendar me-1"},null,-1)),(0,a.eW)((0,n.v_)(t.days_count||0)+"å¤© ",1)]),(0,a.Lk)("small",L,[e[6]||(e[6]=(0,a.Lk)("i",{class:"bi bi-clock me-1"},null,-1)),(0,a.eW)((0,n.v_)(A.formatDate(t.updated_at)),1)])])]),(0,a.Lk)("div",f,[(0,a.Lk)("button",{class:"btn btn-sm btn-outline-primary",onClick:e=>A.editTrip(t.slug)},[...e[7]||(e[7]=[(0,a.Lk)("i",{class:"bi bi-pencil me-1"},null,-1),(0,a.eW)("ç¼–è¾‘ ",-1)])],8,y),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e=>A.viewTrip(t.slug)},[...e[8]||(e[8]=[(0,a.Lk)("i",{class:"bi bi-eye me-1"},null,-1),(0,a.eW)("é¢„è§ˆ ",-1)])],8,w),t.isOnTree?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"btn btn-sm btn-danger",onClick:e=>A.removeFromTree(t.slug)},[...e[9]||(e[9]=[(0,a.Lk)("i",{class:"bi bi-x-circle me-1"},null,-1),(0,a.eW)("æ‘˜ä¸‹æžœå®ž ",-1)])],8,h)):((0,a.uX)(),(0,a.CE)("button",{key:1,class:"btn btn-sm btn-success",onClick:e=>A.addToTree(t.slug)},[...e[10]||(e[10]=[(0,a.Lk)("i",{class:"bi bi-tree me-1"},null,-1),(0,a.eW)("è¿ç”¨åˆ°æ—…è¡Œæ ‘ ",-1)])],8,C)),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-danger",onClick:e=>A.deleteTrip(t.slug)},[...e[11]||(e[11]=[(0,a.Lk)("i",{class:"bi bi-trash"},null,-1)])],8,_)])])]))),128))])):((0,a.uX)(),(0,a.CE)("div",T,[e[13]||(e[13]=(0,a.Lk)("div",{class:"empty-icon mb-3"},"ðŸ“",-1)),e[14]||(e[14]=(0,a.Lk)("h4",null,"è¿˜æ²¡æœ‰æ—…è¡Œè®¡åˆ’",-1)),e[15]||(e[15]=(0,a.Lk)("p",{class:"text-muted mb-4"},"å¼€å§‹åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªæ—…è¡Œè®¡åˆ’å§ï¼",-1)),(0,a.Lk)("button",{class:"btn btn-primary btn-lg",onClick:e[1]||(e[1]=(...t)=>A.createNew&&A.createNew(...t))},[...e[12]||(e[12]=[(0,a.Lk)("i",{class:"bi bi-plus-circle me-2"},null,-1),(0,a.eW)("åˆ›å»ºæ–°æ—…è¡Œ ",-1)])])]))])])}s(4114),s(8111),s(7588),s(1701),s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);var E=s(144),x=s(8512),W=s(1516),N=s(7682),X=s(485),$=s(9814),F={name:"MyTripsView",components:{NavBar:$.A},setup(){const t=(0,x.rd)(),e=(0,W.k)(),s=(0,E.KR)([]),n=(0,E.KR)(!0),r=async()=>{n.value=!0;try{const t=await(0,N.To)();s.value=t.results||t||[],await p()}catch(t){console.error("èŽ·å–æ—…è¡Œåˆ—è¡¨å¤±è´¥:",t),alert("åŠ è½½å¤±è´¥")}finally{n.value=!1}},l=()=>{t.push("/editor/new")},i=e=>{t.push(`/editor/${e}`)},o=e=>{t.push(`/trip/${e}/`)},c=async t=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ—…è¡Œè®¡åˆ’å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚"))try{await(0,N.Au)(t),alert("åˆ é™¤æˆåŠŸ"),await r()}catch(e){console.error("åˆ é™¤å¤±è´¥:",e),alert("åˆ é™¤å¤±è´¥")}},u=async t=>{if(confirm("ç¡®å®šè¦å°†æ­¤æ—…è¡Œè®¡åˆ’æ·»åŠ åˆ°æ—…è¡Œæ ‘å—ï¼Ÿå®ƒå°†æ˜¾ç¤ºåœ¨é¦–é¡µçš„æ—…è¡Œæ ‘ä¸Šã€‚"))try{const e=await(0,N.Ol)(t);alert(e.detail||"æˆåŠŸæ·»åŠ åˆ°æ—…è¡Œæ ‘ï¼"),await r()}catch(e){console.error("æ·»åŠ åˆ°æ—…è¡Œæ ‘å¤±è´¥:",e),alert("æ·»åŠ åˆ°æ—…è¡Œæ ‘å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}},d=async t=>{if(confirm("ç¡®å®šè¦å°†æ­¤æ—…è¡Œè®¡åˆ’ä»Žæ—…è¡Œæ ‘æ‘˜ä¸‹å—ï¼Ÿå®ƒå°†ä¸å†æ˜¾ç¤ºåœ¨é¦–é¡µçš„æ—…è¡Œæ ‘ä¸Šã€‚"))try{const e=await(0,N.ml)(t);alert(e.detail||"æˆåŠŸæ‘˜ä¸‹æžœå®žï¼"),await r()}catch(e){console.error("æ‘˜ä¸‹æžœå®žå¤±è´¥:",e),alert("æ‘˜ä¸‹æžœå®žå¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}},p=async()=>{try{const t=await(0,X.Yf)(),e=new Set((t.results||t||[]).map(t=>t.slug));s.value.forEach(t=>{t.isOnTree=e.has(t.slug)})}catch(t){console.error("èŽ·å–æ—…è¡Œæ ‘çŠ¶æ€å¤±è´¥:",t)}},b=t=>{if(!t)return"æš‚æ— ";const e=new Date(t);return e.toLocaleDateString("zh-CN")};return(0,a.sV)(()=>{if(!e.isLoggedIn)return alert("è¯·å…ˆç™»å½•"),void t.push("/login");r()}),{trips:s,loading:n,createNew:l,editTrip:i,viewTrip:o,deleteTrip:c,addToTree:u,removeFromTree:d,formatDate:b}}},I=s(1241);const D=(0,I.A)(F,[["render",A],["__scopeId","data-v-1414273b"]]);var R=D}}]);
//# sourceMappingURL=958.3bacd701.js.map