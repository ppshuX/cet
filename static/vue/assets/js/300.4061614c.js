"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[300],{8300:function(e,a,s){s.r(a),s.d(a,{default:function(){return Y}});var r=s(6768),o=s(4232),t=s(5130);const l={class:"forgot-password-container"},n={class:"container py-5"},i={class:"row justify-content-center"},d={class:"col-md-6 col-lg-5"},c={class:"card shadow"},u={class:"card-body p-5"},v={key:0,class:"alert alert-danger"},p={key:1,class:"alert alert-success"},m={class:"mb-3"},w={class:"input-group"},b=["disabled"],f=["disabled"],k={key:0,class:"spinner-border spinner-border-sm me-1"},_={key:1},y={key:2},g={key:0,class:"text-danger small mt-1"},L={key:1,class:"text-success small mt-1"},C={class:"text-muted mb-4"},h={class:"mb-3"},x={class:"input-group"},E=["disabled"],X=["disabled"],D={key:0,class:"spinner-border spinner-border-sm me-1"},Q={key:1},R={key:2},K={key:0,class:"text-danger small mt-1"},V={key:1,class:"text-success small mt-1"},A={class:"d-flex gap-2"},S={class:"mb-3"},W=["disabled"],M={key:0,class:"text-danger small mt-1"},F={class:"mb-4"},I=["disabled"],J={key:0,class:"text-danger small mt-1"},T=["disabled"],q={key:0,class:"spinner-border spinner-border-sm me-2"},P=["disabled"],U={key:5,class:"text-center"},$={class:"text-center mt-4"};function j(e,a,s,j,z,H){const B=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",n,[(0,r.Lk)("div",i,[(0,r.Lk)("div",d,[(0,r.Lk)("div",c,[(0,r.Lk)("div",u,[a[26]||(a[26]=(0,r.Lk)("h2",{class:"text-center mb-4"},"ðŸ”‘ æ‰¾å›žå¯†ç ",-1)),j.errorMessage?((0,r.uX)(),(0,r.CE)("div",v,(0,o.v_)(j.errorMessage),1)):(0,r.Q3)("",!0),j.successMessage?((0,r.uX)(),(0,r.CE)("div",p,(0,o.v_)(j.successMessage),1)):(0,r.Q3)("",!0),1===j.step?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[a[13]||(a[13]=(0,r.Lk)("p",{class:"text-muted mb-4"},"è¯·è¾“å…¥æ‚¨çš„æ³¨å†Œé‚®ç®±ï¼Œæˆ‘ä»¬å°†å‘é€éªŒè¯ç åˆ°æ‚¨çš„é‚®ç®±",-1)),(0,r.Lk)("form",{onSubmit:a[2]||(a[2]=(0,t.D$)((...e)=>j.handleSendCode&&j.handleSendCode(...e),["prevent"]))},[(0,r.Lk)("div",m,[a[12]||(a[12]=(0,r.Lk)("label",{for:"email",class:"form-label"},[(0,r.eW)("é‚®ç®±åœ°å€ "),(0,r.Lk)("span",{class:"text-danger"},"*")],-1)),(0,r.Lk)("div",w,[(0,r.bo)((0,r.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":a[0]||(a[0]=e=>j.formData.email=e),required:"",disabled:j.submitting||j.sendingCode,placeholder:"è¯·è¾“å…¥æ³¨å†Œé‚®ç®±"},null,8,b),[[t.Jo,j.formData.email]]),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:!j.formData.email||j.sendingCode||j.countdown>0},[j.sendingCode?((0,r.uX)(),(0,r.CE)("span",k)):j.countdown>0?((0,r.uX)(),(0,r.CE)("span",_,(0,o.v_)(j.countdown)+"s",1)):((0,r.uX)(),(0,r.CE)("span",y,"å‘é€éªŒè¯ç "))],8,f)]),j.errors.email?((0,r.uX)(),(0,r.CE)("div",g,(0,o.v_)(j.errors.email),1)):(0,r.Q3)("",!0),j.codeSent?((0,r.uX)(),(0,r.CE)("div",L," âœ… éªŒè¯ç å·²å‘é€åˆ°æ‚¨çš„é‚®ç®±ï¼Œè¯·æŸ¥æ”¶ ")):(0,r.Q3)("",!0)]),j.codeSent?((0,r.uX)(),(0,r.CE)("button",{key:0,type:"button",class:"btn btn-outline-primary w-100",onClick:a[1]||(a[1]=e=>j.step=2)}," ä¸‹ä¸€æ­¥ï¼šéªŒè¯éªŒè¯ç  ")):(0,r.Q3)("",!0)],32)],64)):(0,r.Q3)("",!0),2===j.step?((0,r.uX)(),(0,r.CE)(r.FK,{key:3},[(0,r.Lk)("p",C,[a[14]||(a[14]=(0,r.eW)("è¯·è¾“å…¥å‘é€åˆ° ",-1)),(0,r.Lk)("strong",null,(0,o.v_)(j.formData.email),1),a[15]||(a[15]=(0,r.eW)(" çš„éªŒè¯ç ",-1))]),(0,r.Lk)("form",{onSubmit:a[6]||(a[6]=(0,t.D$)((...e)=>j.handleVerifyCode&&j.handleVerifyCode(...e),["prevent"]))},[(0,r.Lk)("div",h,[a[16]||(a[16]=(0,r.Lk)("label",{for:"verification_code",class:"form-label"},[(0,r.eW)("éªŒè¯ç  "),(0,r.Lk)("span",{class:"text-danger"},"*")],-1)),(0,r.Lk)("div",x,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"verification_code","onUpdate:modelValue":a[3]||(a[3]=e=>j.formData.verification_code=e),required:"",disabled:j.submitting||j.verifyingCode||j.codeVerified,placeholder:"è¯·è¾“å…¥6ä½éªŒè¯ç ",maxlength:"6"},null,8,E),[[t.Jo,j.formData.verification_code]]),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:!j.formData.verification_code||j.verifyingCode||j.codeVerified},[j.verifyingCode?((0,r.uX)(),(0,r.CE)("span",D)):j.codeVerified?((0,r.uX)(),(0,r.CE)("span",Q,"âœ“ å·²éªŒè¯")):((0,r.uX)(),(0,r.CE)("span",R,"éªŒè¯"))],8,X)]),j.errors.verification_code?((0,r.uX)(),(0,r.CE)("div",K,(0,o.v_)(j.errors.verification_code),1)):(0,r.Q3)("",!0),j.codeVerified?((0,r.uX)(),(0,r.CE)("div",V," âœ… éªŒè¯æˆåŠŸï¼ ")):(0,r.Q3)("",!0)]),(0,r.Lk)("div",A,[(0,r.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:a[4]||(a[4]=e=>j.step=1)}," è¿”å›žä¸Šä¸€æ­¥ "),j.codeVerified?((0,r.uX)(),(0,r.CE)("button",{key:0,type:"button",class:"btn btn-primary flex-grow-1",onClick:a[5]||(a[5]=e=>j.step=3)}," ä¸‹ä¸€æ­¥ï¼šè®¾ç½®æ–°å¯†ç  ")):(0,r.Q3)("",!0)])],32)],64)):(0,r.Q3)("",!0),3===j.step?((0,r.uX)(),(0,r.CE)(r.FK,{key:4},[a[20]||(a[20]=(0,r.Lk)("p",{class:"text-muted mb-4"},"è¯·è®¾ç½®æ‚¨çš„æ–°å¯†ç ",-1)),(0,r.Lk)("form",{onSubmit:a[10]||(a[10]=(0,t.D$)((...e)=>j.handleResetPassword&&j.handleResetPassword(...e),["prevent"]))},[(0,r.Lk)("div",S,[a[17]||(a[17]=(0,r.Lk)("label",{for:"new_password",class:"form-label"},[(0,r.eW)("æ–°å¯†ç  "),(0,r.Lk)("span",{class:"text-danger"},"*")],-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"new_password","onUpdate:modelValue":a[7]||(a[7]=e=>j.formData.new_password=e),required:"",disabled:j.submitting,placeholder:"è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘8ä½ï¼‰",minlength:"8"},null,8,W),[[t.Jo,j.formData.new_password]]),j.errors.new_password?((0,r.uX)(),(0,r.CE)("div",M,(0,o.v_)(j.errors.new_password),1)):(0,r.Q3)("",!0),a[18]||(a[18]=(0,r.Lk)("small",{class:"text-muted"},"å¯†ç è‡³å°‘8ä½ï¼Œå»ºè®®åŒ…å«å­—æ¯å’Œæ•°å­—",-1))]),(0,r.Lk)("div",F,[a[19]||(a[19]=(0,r.Lk)("label",{for:"new_password2",class:"form-label"},[(0,r.eW)("ç¡®è®¤æ–°å¯†ç  "),(0,r.Lk)("span",{class:"text-danger"},"*")],-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"new_password2","onUpdate:modelValue":a[8]||(a[8]=e=>j.formData.new_password2=e),required:"",disabled:j.submitting,placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",minlength:"8"},null,8,I),[[t.Jo,j.formData.new_password2]]),j.errors.new_password2?((0,r.uX)(),(0,r.CE)("div",J,(0,o.v_)(j.errors.new_password2),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary w-100 mb-3",disabled:j.submitting},[j.submitting?((0,r.uX)(),(0,r.CE)("span",q)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,o.v_)(j.submitting?"é‡ç½®ä¸­...":"é‡ç½®å¯†ç "),1)],8,T),(0,r.Lk)("button",{type:"button",class:"btn btn-outline-secondary w-100",onClick:a[9]||(a[9]=e=>j.step=2),disabled:j.submitting}," è¿”å›žä¸Šä¸€æ­¥ ",8,P)],32)],64)):(0,r.Q3)("",!0),4===j.step?((0,r.uX)(),(0,r.CE)("div",U,[a[21]||(a[21]=(0,r.Lk)("div",{class:"mb-4"},[(0,r.Lk)("i",{class:"bi bi-check-circle-fill text-success",style:{"font-size":"4rem"}})],-1)),a[22]||(a[22]=(0,r.Lk)("h3",{class:"mb-3"},"å¯†ç é‡ç½®æˆåŠŸï¼",-1)),a[23]||(a[23]=(0,r.Lk)("p",{class:"text-muted mb-4"},"æ‚¨å¯ä»¥ä½¿ç”¨æ–°å¯†ç ç™»å½•äº†",-1)),(0,r.Lk)("button",{type:"button",class:"btn btn-primary w-100",onClick:a[11]||(a[11]=(...e)=>j.goToLogin&&j.goToLogin(...e))}," å‰å¾€ç™»å½• ")])):(0,r.Q3)("",!0),(0,r.Lk)("div",$,[a[25]||(a[25]=(0,r.Lk)("span",{class:"text-muted"},"æƒ³èµ·å¯†ç äº†ï¼Ÿ",-1)),(0,r.bF)(B,{to:"/login/",class:"text-decoration-none ms-1"},{default:(0,r.k6)(()=>[...a[24]||(a[24]=[(0,r.eW)(" è¿”å›žç™»å½• ",-1)])]),_:1})])])])])])])])}s(4114);var z=s(144),H=s(8512),B=s(2636),G={name:"ForgotPasswordView",setup(){const e=(0,H.rd)(),a=(0,z.KR)(1),s=(0,z.KR)({email:"",verification_code:"",verification_token:"",new_password:"",new_password2:""}),o=(0,z.KR)({}),t=(0,z.KR)(""),l=(0,z.KR)(""),n=(0,z.KR)(!1),i=(0,z.KR)(!1),d=(0,z.KR)(!1),c=(0,z.KR)(!1),u=(0,z.KR)(!1),v=(0,z.KR)(0);let p=null;const m=async()=>{if(o.value={},t.value="",!s.value.email)return void(o.value.email="è¯·å…ˆè¾“å…¥é‚®ç®±");const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(e.test(s.value.email)){i.value=!0;try{await(0,B.J2)({email:s.value.email,type:"reset_password"}),c.value=!0,v.value=60,f(),l.value="éªŒè¯ç å·²å‘é€åˆ°æ‚¨çš„é‚®ç®±",setTimeout(()=>{l.value=""},3e3)}catch(a){if(console.error("å‘é€éªŒè¯ç å¤±è´¥:",a),a.response?.data){const e=a.response.data;e.error?t.value=e.error:e.email?o.value.email=Array.isArray(e.email)?e.email[0]:e.email:t.value="å‘é€éªŒè¯ç å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•"}else t.value="ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥"}finally{i.value=!1}}else o.value.email="è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€"},w=async()=>{if(o.value={},t.value="",s.value.verification_code)if(6===s.value.verification_code.length){d.value=!0;try{const e=await(0,B.HR)({email:s.value.email,code:s.value.verification_code,type:"reset_password"});e.success&&e.verification_token?(s.value.verification_token=e.verification_token,u.value=!0,l.value="éªŒè¯æˆåŠŸï¼",setTimeout(()=>{a.value=3},1e3)):o.value.verification_code="éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥éªŒè¯ç "}catch(e){if(console.error("éªŒè¯ç éªŒè¯å¤±è´¥:",e),e.response?.data){const a=e.response.data;a.error?o.value.verification_code=a.error:a.code?o.value.verification_code=Array.isArray(a.code)?a.code[0]:a.code:o.value.verification_code="éªŒè¯ç æ— æ•ˆæˆ–å·²è¿‡æœŸ"}else o.value.verification_code="éªŒè¯å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•"}finally{d.value=!1}}else o.value.verification_code="éªŒè¯ç ä¸º6ä½æ•°å­—";else o.value.verification_code="è¯·è¾“å…¥éªŒè¯ç "},b=async()=>{if(o.value={},t.value="",s.value.new_password)if(s.value.new_password.length<8)o.value.new_password="å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä½";else if(s.value.new_password===s.value.new_password2){n.value=!0;try{await(0,B.xw)({email:s.value.email,verification_token:s.value.verification_token,new_password:s.value.new_password,new_password2:s.value.new_password2}),a.value=4}catch(e){if(console.error("é‡ç½®å¯†ç å¤±è´¥:",e),e.response?.data){const a=e.response.data;a.new_password&&(o.value.new_password=Array.isArray(a.new_password)?a.new_password[0]:a.new_password),a.new_password2&&(o.value.new_password2=Array.isArray(a.new_password2)?a.new_password2[0]:a.new_password2),a.verification_token&&(t.value="éªŒè¯tokenæ— æ•ˆï¼Œè¯·é‡æ–°éªŒè¯é‚®ç®±"),a.error&&(t.value=a.error),t.value||o.value.new_password||o.value.new_password2||(t.value="é‡ç½®å¯†ç å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}else t.value="ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥"}finally{n.value=!1}}else o.value.new_password2="ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´";else o.value.new_password="è¯·è¾“å…¥æ–°å¯†ç "},f=()=>{p&&clearInterval(p),p=setInterval(()=>{v.value>0?v.value--:(clearInterval(p),p=null)},1e3)},k=()=>{e.push("/login/")};return(0,r.hi)(()=>{p&&clearInterval(p)}),{step:a,formData:s,errors:o,errorMessage:t,successMessage:l,submitting:n,sendingCode:i,verifyingCode:d,codeSent:c,codeVerified:u,countdown:v,handleSendCode:m,handleVerifyCode:w,handleResetPassword:b,goToLogin:k}}},N=s(1241);const O=(0,N.A)(G,[["render",j],["__scopeId","data-v-df6b74f0"]]);var Y=O}}]);
//# sourceMappingURL=300.4061614c.js.map