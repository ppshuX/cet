"use strict";(self["webpackChunkroamio_web"]=self["webpackChunkroamio_web"]||[]).push([[600],{946:function(e,a,s){e.exports=s.p+"assets/img/qq_logo.666e5ea1.png"},7600:function(e,a,s){s.r(a),s.d(a,{default:function(){return K}});var r=s(6768),n=s(5130),o=s(4232),l=s(946);const t={class:"login-container"},i={class:"container"},d={class:"row justify-content-center"},u={class:"col-md-6 col-lg-4"},c={class:"card shadow-lg"},p={class:"card-body p-5"},m={class:"mb-3"},v={class:"mb-3"},g={key:0,class:"alert alert-danger",role:"alert"},L=["disabled"],b={key:0,class:"spinner-border spinner-border-sm me-2"},k={class:"text-center mb-3"},f=["disabled"],y={key:0},h={key:1},w={class:"text-center"};function _(e,a,s,_,q,Q){const x=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",t,[(0,r.Lk)("div",i,[(0,r.Lk)("div",d,[(0,r.Lk)("div",u,[(0,r.Lk)("div",c,[(0,r.Lk)("div",p,[a[10]||(a[10]=(0,r.Lk)("h2",{class:"text-center mb-4"},"用户登录",-1)),(0,r.Lk)("form",{onSubmit:a[3]||(a[3]=(0,n.D$)((...e)=>_.handleLogin&&_.handleLogin(...e),["prevent"]))},[(0,r.Lk)("div",m,[a[4]||(a[4]=(0,r.Lk)("label",{for:"username",class:"form-label"},"用户名",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":a[0]||(a[0]=e=>_.form.username=e),required:"",placeholder:"请输入用户名"},null,512),[[n.Jo,_.form.username]])]),(0,r.Lk)("div",v,[a[5]||(a[5]=(0,r.Lk)("label",{for:"password",class:"form-label"},"密码",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":a[1]||(a[1]=e=>_.form.password=e),required:"",placeholder:"请输入密码"},null,512),[[n.Jo,_.form.password]])]),_.error?((0,r.uX)(),(0,r.CE)("div",g,(0,o.v_)(_.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary w-100 mb-3",disabled:_.loading},[_.loading?((0,r.uX)(),(0,r.CE)("span",b)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,o.v_)(_.loading?"登录中...":"登录"),1)],8,L),(0,r.Lk)("div",k,[a[7]||(a[7]=(0,r.Lk)("div",{class:"divider"},[(0,r.Lk)("span",{class:"divider-text"},"或")],-1)),(0,r.Lk)("button",{type:"button",class:"btn btn-outline-secondary w-100 qq-login-btn",disabled:_.qqLoginLoading,onClick:a[2]||(a[2]=(...e)=>_.handleQQLogin&&_.handleQQLogin(...e))},[a[6]||(a[6]=(0,r.Lk)("img",{src:l,alt:"QQ登录",class:"qq-login-icon",width:"20",height:"20"},null,-1)),_.qqLoginLoading?((0,r.uX)(),(0,r.CE)("span",y,"跳转中...")):((0,r.uX)(),(0,r.CE)("span",h,"使用QQ登录"))],8,f)]),(0,r.Lk)("div",w,[a[9]||(a[9]=(0,r.Lk)("span",{class:"text-muted"},"还没有账号？",-1)),(0,r.bF)(x,{to:"/register",class:"text-decoration-none"},{default:(0,r.k6)(()=>[...a[8]||(a[8]=[(0,r.eW)("立即注册",-1)])]),_:1})])],32)])])])])])])}s(4114);var q=s(144),Q=s(8512),x=s(3459),C=s(2636),A={name:"LoginView",setup(){const e=(0,Q.rd)(),a=(0,x.k)(),s=(0,q.KR)({username:"",password:""}),r=(0,q.KR)(!1),n=(0,q.KR)(""),o=(0,q.KR)(!1),l=async()=>{r.value=!0,n.value="";try{await a.login(s.value),e.push("/")}catch(o){if(o.response?.data){const e=o.response.data;e.username&&Array.isArray(e.username)?n.value=e.username[0]:e.password&&Array.isArray(e.password)?n.value=e.password[0]:e.non_field_errors&&Array.isArray(e.non_field_errors)?n.value=e.non_field_errors[0]:"string"===typeof e?n.value=e:e.detail?n.value=e.detail:n.value="登录失败，请检查用户名和密码"}else n.value=o.message||"登录失败，请检查用户名和密码"}finally{r.value=!1}},t=async()=>{o.value=!0;try{const e=await(0,C.jg)();e.authorize_url&&e.state?(sessionStorage.setItem("qq_oauth_state",e.state),window.location.href=e.authorize_url):(n.value="获取QQ登录链接失败，请重试",o.value=!1)}catch(e){n.value=e.response?.data?.error||"QQ登录失败，请重试",o.value=!1}};return{form:s,loading:r,error:n,qqLoginLoading:o,handleLogin:l,handleQQLogin:t}}},E=s(1241);const X=(0,E.A)(A,[["render",_],["__scopeId","data-v-05c38a58"]]);var K=X}}]);
//# sourceMappingURL=600.4b5078ca.js.map